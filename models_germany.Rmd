## Germany

Visualizing Germany again -> looks like volatility really increased during covid, and now going back down. Need to be careful with forecast putting weight on much recent data because it seems heavily influenced by covid...


```{r}
data_elec %>% autoplot(Germany) + 
  ggtitle("Exports from Switzerland to Germany") +
  ylab("GWt") + xlab("Month")
```
```{r}
# Investigating Germany closely since 2015
Germany_since_2015 <- data_elec %>% 
  select(Date,Germany) %>% 
  filter(Date >= as.Date("2015-01-01"))

autoplot(Germany_since_2015)
```


### S-Naive Model

```{r}
# Modelling snaive automatically
snaive_germany <- data_elec %>% 
  select(Germany) %>%
  model(snaive = SNAIVE(Germany))

# Getting the accuracy scores for models
report(snaive_germany)

# Forecasting using the models
forecast_snaive_germany <- snaive_germany %>% forecast(h = 13)

#Checking the residuals before forecasting
snaive_germany %>% gg_tsresiduals(lag_max = 36) + labs(title = "ETS Germany residuals analysis")


# Graphing the forecast
snaive_germany %>% forecast(h = 13) %>% autoplot(Germany_since_2015) +
  labs(title = "Seasonal Naive Forecast for Germany")

# Extracting the forecasted values
forecast_table_germany <- data.frame(Model = c("Seasonal Naive"),
                                     Forecast_Values = c(forecast_snaive_germany))

forecast_table_germany <- forecast_table_germany %>% select(Forecast_Values..mean)

colnames(forecast_table_germany)[1] <- "Germany_snaive"

forecast_table_germany


```


### ETS Model 

```{r}

#Modelling ets automatically
ets_germany <- data_elec %>%
  select(Germany) %>%
  model(ETS(Germany))

#Getting the Accuracy scores for models
report(ets_germany)

#Forecasting using the models
forecast_ets_germany<- ets_germany %>% forecast(h = 13)

#Checking the residuals before forecasting
ets_germany %>% gg_tsresiduals(lag_max = 36) + labs(title = "ETS Germany residuals analysis")

#Graphing the forecast
ets_germany %>% forecast(h = 13) %>% autoplot(Germany_since_2015)+
  labs(title = "ETS MAdM Forecast for Germany")

#Extracting the forecasted values

forecast_table_germany_ets <- data.frame(Model = c("ETS (MAdM)"),
                              Forecast_Values = c(forecast_ets_germany))

forecast_table_germany_ets <- forecast_table_germany_ets %>% select(Forecast_Values..mean)

colnames(forecast_table_germany_ets)[1] <- "Germany_ets_MAdM"

forecast_table_germany_ets

#components(ets_germany) %>% autoplot()
```









### ARIMA

```{r}
# Modelling ARIMA automatically
arima_germany <- data_elec %>%
  select(Germany) %>%
  model(arima = ARIMA(Germany))

# Getting the Accuracy scores for models
report(arima_germany)

# Forecasting using the models
forecast_arima_germany <- arima_germany %>% forecast(h = 13)

#Checking the residuals before forecasting
arima_germany %>% gg_tsresiduals(lag_max = 36) + labs(title = "SARIMA Germany residuals analysis")

# Graphing the forecast
arima_germany %>% forecast(h = 13) %>% autoplot(Germany_since_2015) +
  labs(title = "ARIMA Forecast for Germany")

#Extracting the forecasted values
forecast_table_germany_a <- data.frame(Model = c("ARIMA"),
                              Forecast_Values = c(forecast_arima_germany))

forecast_table_germany_a <- forecast_table_germany_a %>% select(Forecast_Values..mean)

colnames(forecast_table_germany_a)[1] <- "Germany_arima"

forecast_table_germany_a

```


## Model Comparison

The ARIMA model has an AIC of 3382.65, AICc of 3382.88, and BIC of 3400.51, while the ETS model has an AIC of 4123.569, AICc of 4126.241, and BIC of 4188.671. Lower values of these information criteria indicate a better model fit, so we can conclude that the ARIMA model is better than the ETS model.

The time series residuals plot also shows that the ARIMA model best fits the data. The residuals don't follow any pattern and are random and stationary. Autocorrelation indicates that residuals in the ARIMA model are not correlated with their past and future values. We can't observe the same pattern in SNAIVE and ETS models. These models captured all the information in data not that well, as ARIMA did. 



