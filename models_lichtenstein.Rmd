## Lichtenstein

- ETS creates a negative value forecast, I will just set the negative forecast values to 0.
- Maybe should find a better way to use ETS (by not allowing it to drop below 0) or just use other models

### S-Naive Model










### ETS Model 

Visualizing Lichtenstein again -> clearly need to use piecewise around 2019


```{r}
data_elec %>% autoplot(Lichtenstein) + 
  ggtitle("Exports from Switzerland to Lichtenstein") +
  ylab("GWt") + xlab("Month")
```

As a remember: remember: Lichtenstein: Big drop in level of exports during 2008-2009. used to have a high export and drop to a certain level approximately 0-10 (exception 2015): 
- Lichtenstein: This country shows the opposite trend, with a very smooth peak in the coldest winter months (Jan,Feb), and the lowest energy exports during the summer months. 

```{r}
#Investigating Lichtenstein closely since 2010, because it seems like something changed -> perhaps should use Piecewise!!!
Lichtenstein_since_2010 <- data_elec %>% select(Date,Lichtenstein) %>% filter(Date >= as.Date("2010-01-01"))
autoplot(Lichtenstein_since_2010)

#Modelling ets automatically
ets_lichtenstein <- data_elec %>%
  select(Lichtenstein) %>%
  model(ETS(Lichtenstein))

#Getting the Accuracy scores for models
report(ets_lichtenstein)

#Forecasting using the models
forecast_ets_lichtenstein<- ets_lichtenstein %>% forecast(h = 13)

#Graphing the forecast
ets_lichtenstein %>% forecast(h = 13) %>% autoplot(Lichtenstein_since_2010)+
  labs(title = "ETS ANA Forecast for Lichtenstein")

#Extracting the forecasted values

forecast_table_lichtenstein <- data.frame(Model = c("ETS (ANA)"),
                              Forecast_Values = c(forecast_ets_lichtenstein))

forecast_table_lichtenstein <- forecast_table_lichtenstein %>% select(Forecast_Values..mean)

colnames(forecast_table_lichtenstein)[1] <- "Lichtenstein_ets_ANA"

# replace negative values with 0
forecast_table_lichtenstein[forecast_table_lichtenstein < 0] <- 0


#components(ets_lichtenstein) %>% autoplot()
```

Since we can't have negative values, I decided to just set the negative ones to 0. 

This forecast actually doesn't look great. I would expect the next upward bounce to be of similar amplitude as the previous ones, but it seems like the forecast of the next bounce is only half the amplitude of the previous ones. 



### S-ARIMA

```{r}
# Modelling S-ARIMA 
sarima_Lichtenstein <- data_elec %>%
  select(Date, Lichtenstein) %>%
  as.data.frame() %>%
  { auto.arima(ts(.$Lichtenstein, frequency = 12), seasonal = TRUE) }

# Forecasting using the models
forecast_sarima_Lichtenstein<- forecast(sarima_Lichtenstein, h = 13)


# Graphing the forecast
autoplot(forecast_sarima_Lichtenstein, include = 50) +
  labs(title = "SARIMA Forecast for Lichtenstein") +
  xlab("Year") + ylab("Electricity Consumption") 
  

# Extracting the forecasted values
forecast_table_Lichtenstein_sa <- data.frame(Model = c("SARIMA"),
                                     France_sarima = forecast_sarima_Lichtenstein$mean)


# Get the accuracy scores
accuracy_sarima_Lich<- accuracy(sarima_Lichtenstein)
```


```{r}
forecast_table_Lichtenstein_sa
```


```{r}
accuracy_sarima_Lich
````
