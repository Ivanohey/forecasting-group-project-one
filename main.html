<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
        <meta name="date" content="2023-05-17" />
    
    <title>Forecasting Project 1 - Group 7</title>

        <script src="main_files/header-attrs-2.21/header-attrs.js"></script>
        <script src="main_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="main_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="main_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="main_files/navigation-1.1/tabsets.js"></script>
        <script src="main_files/navigation-1.1/codefolding.js"></script>
        <link href="main_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="main_files/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="main_files/readthedown-0.1/readthedown.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #2a211c;
          color: #bdae9d;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #bdae9d;  padding-left: 4px; }
      div.sourceCode
        { color: #bdae9d; background-color: #2a211c; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ffff00; } /* Alert */
      code span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { } /* Attribute */
      code span.bn { color: #44aa43; } /* BaseN */
      code span.bu { } /* BuiltIn */
      code span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #049b0a; } /* Char */
      code span.cn { } /* Constant */
      code span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
      code span.do { color: #0066ff; font-style: italic; } /* Documentation */
      code span.dt { text-decoration: underline; } /* DataType */
      code span.dv { color: #44aa43; } /* DecVal */
      code span.er { color: #ffff00; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #44aa43; } /* Float */
      code span.fu { color: #ff9358; font-weight: bold; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
      code span.op { } /* Operator */
      code span.pp { font-weight: bold; } /* Preprocessor */
      code span.sc { color: #049b0a; } /* SpecialChar */
      code span.ss { color: #049b0a; } /* SpecialString */
      code span.st { color: #049b0a; } /* String */
      code span.va { } /* Variable */
      code span.vs { color: #049b0a; } /* VerbatimString */
      code span.wa { color: #ffff00; font-weight: bold; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
        <script>
      $(document).ready(function () {
	  	  	  window.initializeCodeFolding("hide" === "show");
	        });
    </script>
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
      <div class="btn-group pull-right">
     <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
     <ul class="dropdown-menu" style="min-width: 50px;">
	    	    <li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
	    <li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
	    	    	         </ul>
   </div>
   
        
      <h1 class="title">Forecasting Project 1 - Group 7</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Forecasting Project 1 - Group 7</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#data-cleaning" id="toc-data-cleaning">Data
      cleaning</a>
      <ul>
      <li><a href="#data-import" id="toc-data-import">Data
      import</a></li>
      <li><a href="#data-cleaning-1" id="toc-data-cleaning-1">Data
      cleaning</a></li>
      </ul></li>
      <li><a href="#exploratory-data-analysis"
      id="toc-exploratory-data-analysis">Exploratory Data
      Analysis</a></li>
      <li><a href="#autocorrelation"
      id="toc-autocorrelation">Autocorrelation</a>
      <ul>
      <li><a href="#lets-first-look-at-a-specific-country-germany"
      id="toc-lets-first-look-at-a-specific-country-germany">Let’s first
      look at a specific country: Germany</a></li>
      <li><a href="#total-exports-autocorrelation"
      id="toc-total-exports-autocorrelation">Total exports
      autocorrelation</a></li>
      </ul></li>
      <li><a href="#decomposition"
      id="toc-decomposition">Decomposition</a>
      <ul>
      <li><a href="#stl-decomposition-for-all-countries"
      id="toc-stl-decomposition-for-all-countries">STL Decomposition for
      all countries</a></li>
      <li><a href="#models" id="toc-models">Models</a></li>
      </ul></li>
      <li><a href="#model-selection" id="toc-model-selection">Model
      Selection</a>
      <ul>
      <li><a href="#methodology"
      id="toc-methodology">Methodology</a></li>
      <li><a href="#germany-1" id="toc-germany-1">Germany</a></li>
      <li><a href="#italy-1" id="toc-italy-1">Italy</a></li>
      <li><a href="#austria-1" id="toc-austria-1">Austria</a></li>
      <li><a href="#france-1" id="toc-france-1">France</a></li>
      <li><a href="#total-1" id="toc-total-1">Total</a></li>
      <li><a href="#result" id="toc-result">Result</a></li>
      </ul></li>
      <li><a href="#forecast" id="toc-forecast">Forecast</a>
      <ul>
      <li><a href="#germany-2" id="toc-germany-2">Germany</a></li>
      <li><a href="#italy-2" id="toc-italy-2">Italy</a></li>
      <li><a href="#austria-2" id="toc-austria-2">Austria</a></li>
      <li><a href="#france-2" id="toc-france-2">France</a></li>
      <li><a href="#total-2" id="toc-total-2">Total</a></li>
      </ul></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> K
K A I
		      </p>
                        <p class="date"><span class="glyphicon glyphicon-calendar"></span> 2023-05-17</p>
          </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div id="data-cleaning" class="section level1">
<h1>Data cleaning</h1>
<p>We import data and we clean it from <i>NA</i> and from blank rows. We
also name the columns. Here is a sample of our data:</p>
<pre><code>##            date germany france italy austria lichtenstein total
## 1  January 2000     421    313  1760       3           24  2521
## 2 February 2000     412    141  1757       4           23  2337
## 3    March 2000     459    148  1962       4           23  2596
## 4    April 2000     474    114  1767       3           17  2375
## 5      May 2000     935    116  1927      42           14  3034
## 6     June 2000     910    101  1895      31           13  2950</code></pre>
<div id="data-import" class="section level2">
<h2>Data import</h2>
<p>We directly import the data from the excel file, selecting only the
range that contains the data, and then setting the column names
accordingly.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#importing data directly from excel</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_elec <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/Electricity export Switzerland.xlsx&quot;</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">range =</span> <span class="st">&quot;A6:G280&quot;</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## New names:
## • `` -&gt; `...1`
## • `` -&gt; `...2`
## • `` -&gt; `...3`
## • `` -&gt; `...4`
## • `` -&gt; `...5`
## • `` -&gt; `...6`
## • `` -&gt; `...7`</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting column names</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_elec) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;Date&#39;</span>,<span class="st">&#39;Germany&#39;</span>,<span class="st">&#39;France&#39;</span>,<span class="st">&#39;Italy&#39;</span>,<span class="st">&#39;Austria&#39;</span>,<span class="st">&#39;Lichtenstein&#39;</span>,<span class="st">&#39;Total&#39;</span>)</span></code></pre></div>
</div>
<div id="data-cleaning-1" class="section level2">
<h2>Data cleaning</h2>
<p>Looking at the data we see that October is written with a “k”, so we
change that in the Date column. Then we check for missing values, before
proceeding.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace &quot;Oktober&quot; with &quot;October&quot; in the Date column</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data_elec<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(data_elec<span class="sc">$</span>Date, <span class="st">&quot;Oktober&quot;</span>, <span class="st">&quot;October&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#This uses the &quot;DataExplorer&quot; package</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_intro</span>(data_elec)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
<div
id="converting-to-tsibble-so-that-we-can-use-the-fpp3-and-tsibble-package-functions"
class="section level3">
<h3>Converting to tsibble so that we can use the fpp3 and tsibble
package functions</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert to tsibble </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>data_elec <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">yearmonth</span>(Date)) <span class="sc">%&gt;%</span> <span class="co">#need to do this before converting to get proper format</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> Date)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#check that it&#39;s a tsibble now, and we can see it recognized the data is monthly because of the [1M] </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">is_tsibble</span>(data_elec)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data_elec</span></code></pre></div>
<pre><code>## # A tsibble: 275 x 7 [1M]
##        Date Germany France Italy Austria Lichtenstein Total
##       &lt;mth&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;
##  1 2000 Jan     421    313  1760       3           24  2521
##  2 2000 Feb     412    141  1757       4           23  2337
##  3 2000 Mar     459    148  1962       4           23  2596
##  4 2000 Apr     474    114  1767       3           17  2375
##  5 2000 May     935    116  1927      42           14  3034
##  6 2000 Jun     910    101  1895      31           13  2950
##  7 2000 Jul     510    105  1950      16           14  2595
##  8 2000 Aug     612    152  1275      39           14  2092
##  9 2000 Sep     354    320  1849      18           17  2558
## 10 2000 Oct     439    291  2295      28           20  3073
## # ℹ 265 more rows</code></pre>
</div>
</div>
</div>
<div id="exploratory-data-analysis" class="section level1">
<h1>Exploratory Data Analysis</h1>
<div id="questions" class="section level3">
<h3>Questions</h3>
<ul>
<li>Explain why the peak electricity exports happen in the summer months
instead of the winter months.</li>
</ul>
<p><img src="main_files/figure-html/EDA-1.png" width="768" /><img src="main_files/figure-html/EDA-2.png" width="768" /><img src="main_files/figure-html/EDA-3.png" width="768" /><img src="main_files/figure-html/EDA-4.png" width="768" /><img src="main_files/figure-html/EDA-5.png" width="768" /><img src="main_files/figure-html/EDA-6.png" width="768" /></p>
<p>Some observations:</p>
<ul>
<li>Germany: Energy exports seem to be varying in variance over time,
being a lot more volatile since 2012. This suggests multiplicative
errors?</li>
<li>France: Similarly to Germany, exports become more volatile over
time. Big peak in 2011?</li>
<li>Italy: Less variability in the variance over time compared to the
precious two.</li>
<li>Austria: Big peak in 2002ish, could be an outliar. Exports
oscillating close to 0 until 2014, since then much more volatile and
higher in volume.</li>
<li>Lichtenstein: Big drop in level of exports during 2008-2009. Why did
that happen? Should probably only use more recent data for predictions,
because older data is very different.</li>
<li>Total: Data oscillating around the same level, no signs of
seasonality which indicates white noise data. This is good for making
the models.</li>
</ul>
<p>To further analyze the data, we created monthly historical graphs
(Seasonal Subseries plots)</p>
<p>Before looking at the following graphs, we would expect that more
energy is needed in the winter months compared to the winter months,
because in winter there are less hours of sunlight (people need to light
up their houses for longer) and people also need to warm up their homes
more because it’s colder outside compared to the summer months.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Seasonal Subseries Plots</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(Germany) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to Germany&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(France) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to France&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-5-2.png" width="768" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(Italy) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to Italy&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-5-3.png" width="768" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(Austria) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to Austria&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-5-4.png" width="768" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(Lichtenstein) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to Lichtenstein&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-5-5.png" width="768" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(Total) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to All countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-5-6.png" width="768" /></p>
<p>Some observations:</p>
<ul>
<li>Germany: It looks like Germany consistently receives more
electricity during the summer months (May, June, July, August). Why is
that? Is it because German electricity production is lower during the
summer months and they decide to import from Switzerland? Or that
Germany has a higher energy need in the summer?</li>
<li>France: It looks like there are two peaks in energy exported to
France during the year, one in July, and one in December.<br />
</li>
<li>Italy: Another peak for energy in July. Why are all countries
importing the most electricity in the summer months?</li>
<li>Austria: Same trend, with a single peak in the summer months, and
then relatively constant energy for the other months.</li>
<li>Lichtenstein: This country shows the opposite trend, with a very
smooth peak in the coldest winter months (Jan,Feb), and the lowest
energy exports during the summer months.<br />
</li>
<li>Total: Clearly seeing the peak in energy exports to countries in the
summer, and specifically in July. The other months are at similar level
for the total electricity exports.</li>
</ul>
<p>Conclusion on monthly subplots:</p>
<ul>
<li>We can’t think of why Lichtenstein experiences a different peak in
energy imports from Switzerland</li>
<li>It is clear that all the other countries peak in electricity imports
in the summer months, and specifically in July.</li>
</ul>
<p>This goes against our initial hypothesis about energy consumption
over the months of the year, so let’s try to explain why. - One
explanation could be that heating in the winter is powered by gas/oil
which does not require electricity directly. However, in the warm summer
months, people tend to use air-conditioning to cool their
houses/buildings down, which can only be powered directly by
electricity. This would explain why we don’t see a peak of electricity
exports in the winter months, but instead see it in the summer.</p>
</div>
</div>
<div id="autocorrelation" class="section level1">
<h1>Autocorrelation</h1>
<p>Before moving on with the models and in order to be able to use them,
we must check for autocorrelation in the time series.</p>
<div id="lets-first-look-at-a-specific-country-germany"
class="section level2">
<h2>Let’s first look at a specific country: Germany</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Let&#39;s look at Germany first</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Getting the acf for 12 lagged months</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ACF</span>(Germany, <span class="at">lag_max =</span> <span class="dv">12</span>)</span></code></pre></div>
<pre><code>## # A tsibble: 12 x 2 [1M]
##         lag    acf
##    &lt;cf_lag&gt;  &lt;dbl&gt;
##  1       1M  0.724
##  2       2M  0.434
##  3       3M  0.150
##  4       4M -0.103
##  5       5M -0.261
##  6       6M -0.325
##  7       7M -0.273
##  8       8M -0.120
##  9       9M  0.107
## 10      10M  0.334
## 11      11M  0.498
## 12      12M  0.610</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Graph of 12 lagged months</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_lag</span>(Germany, <span class="at">lags =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>) <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Germany 12-period lag graph&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
<p>From the first table produced, we can see that the autocorrelation is
highest with a lag of 1 month, and then it again goes up as we approach
the 12-month lag. This shows that our data is highly correlated on a
monthly basis (every month’s exports heavily depend on the previous
month’s exports) and we can also see a slight “seasonality” of 12
months, because every 12 months the data is highly correlated (January
of this year is very similar to January of last year)</p>
<p>From the first graph produced, we can again see the same thing, but
visualized. Here it’s a lot cleared that the autocorrelation is the
highest for the 1-month lag, and the 12-month lag. We can see this
because the points in the scatterplots approach the 45-degree line,
indicating the similarity in magnitude of two observations.</p>
<p>To visualize auto correlation differently, we can plot the acf for
each lagged period:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Still looking at Germany</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Another graphical view of Acf</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">ACF</span>(Germany) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>() </span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
<p>On this chart the autocorrelation coefficients are plotted by bars,
along with a 95% confidence interval. To interpret this graph, it’s
important to know that whenever a line exceeds the 95% confidence
interval, we can say that there is statistically significant
autocorrelation for a given period. Based on this, we see that:</p>
<ul>
<li>The highest autocorrelation is at a 1-month lag.</li>
<li>Every 6 months, we see that the data is strongly inversely auto
correlated. This means that every 6 months, the data is consistently
moving in opposite directions (If exports are high in July, we expect
them to be consistently lower 6 months later). This is something that we
only explored now, and was not so easy to see from the previous
graph/table.</li>
<li>Every 12 months, the data is strongly positively auto
correlated.</li>
</ul>
</div>
<div id="total-exports-autocorrelation" class="section level2">
<h2>Total exports autocorrelation</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Getting the acf for 12 lagged months</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ACF</span>(Total, <span class="at">lag_max =</span> <span class="dv">12</span>)</span></code></pre></div>
<pre><code>## # A tsibble: 12 x 2 [1M]
##         lag     acf
##    &lt;cf_lag&gt;   &lt;dbl&gt;
##  1       1M  0.407 
##  2       2M  0.235 
##  3       3M  0.152 
##  4       4M  0.137 
##  5       5M  0.0956
##  6       6M  0.101 
##  7       7M  0.0580
##  8       8M  0.0174
##  9       9M -0.0530
## 10      10M -0.117 
## 11      11M -0.0891
## 12      12M  0.242</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Graph of 12 lagged months</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_lag</span>(Total, <span class="at">lags =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>) <span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Total exports 12-period lag graph&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-8-1.png" width="768" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Another graphical view of Acf</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">ACF</span>(Total) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>() </span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-8-2.png" width="768" /></p>
<p>From the graphical analysis above, we can see that when aggregating
the electricity exports to the 5 countries, we there is still a
significant autocorrelation with a lag of 1-month (each month’s exports
depend on the previous month’s exports). However, now this auto
correlation is much smaller compared to that of Germany alone (which is
a good sign for us in order to make models). Furthermore, we see a
strong auto correlation every 12 months.</p>
</div>
</div>
<div id="decomposition" class="section level1">
<h1>Decomposition</h1>
<p>As time series data often consists of different patterns, it is
helpful to split time series into components, each representing a
pattern category. As a result, we can understand how each element
behaves over time and model each separately for greater forecasting
accuracy results. It will also help to decide on the type of forecasting
model.</p>
<p>For this purpose, we considered different types of decomposition
techniques: * Classical Decomposition assumes seasonal component repeats
from year to year, which usually is not the case in reality, over
smoothes rapid rises (is not recommended to use, but still…). * STL
Decomposition is a versatile and robust method that handles any
seasonality; seasonal components can change, and smoothness can be
controlled. * X-11 method originated in the US Census Bureau and was
further developed by Statistics Canada, based on classical
decomposition, a slightly improved version of classical decomposition;
the seasonal component varies slowly over time, highly robust to
outliers and level shifts in the time series. We decided to continue
with STL Decomposition.</p>
<p>We observe strong seasonality and trend patterns in each country and
all countries together. The data is non-stationary.</p>
<div id="stl-decomposition-for-all-countries"
class="section level2 tabset">
<h2 class="tabset">STL Decomposition for all countries</h2>
<div id="germany" class="section level3">
<h3><strong>Germany</strong></h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Germany <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
</div>
<div id="france" class="section level3">
<h3><strong>France</strong></h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#STL Decomposition_France</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(France <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-10-1.png" width="768" /></p>
</div>
<div id="italy" class="section level3">
<h3><strong>Italy</strong></h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Italy <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-11-1.png" width="768" /></p>
</div>
<div id="austria" class="section level3">
<h3><strong>Austria</strong></h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Austria <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-12-1.png" width="768" /></p>
</div>
<div id="lichtenstein" class="section level3">
<h3><strong>Lichtenstein</strong></h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Lichtenstein <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-13-1.png" width="768" /></p>
</div>
<div id="total" class="section level3">
<h3><strong>Total</strong></h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Total <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-14-1.png" width="768" /></p>
</div>
</div>
<div id="models" class="section level2">
<h2>Models</h2>
<div id="questions-1" class="section level3">
<h3>Questions</h3>
<ul>
<li>Naive model forecast is not showing me historical data, only the
forecast</li>
<li>Should we even bother doing a SES model (Simple exponential
smoothing)? It’s basically the same as the naive and don’t think adds
any value</li>
<li>I don’t get it: we don’t want our data to have a trend/seasonality,
but then when we select the parameters for ETS, we set them to Additive,
Multiplicative etc. In the end do we want there to be a
trend/seasonality or not?</li>
</ul>
<p>IMPORTANT - What I am basically doing, is first trying to find the
best forecasting method, and THEN I will apply it to the total + all
countries individually.</p>
</div>
<div id="todo-next" class="section level3">
<h3>Todo next:</h3>
<ul>
<li>More models (Better ETS, models introduced later in the course)</li>
<li>Decomposition (haven’t done anything on this yet)</li>
</ul>
</div>
<div id="building-models---only-looking-at-total-exports-for-now"
class="section level3">
<h3>Building models - Only looking at Total exports for now</h3>
<p>In the world of forecasting, we can’t get a perfect forecast no
matter how hard we try. Also, making a model more complicated won’t
necessarily make it more accurate. Finally, when trying to forecast it’s
important to take into consideration how much time is spent on a
forecast, versus how much valuable information we get out of it. It is
therefore important to consider simpler, more “naive” models to try and
make predictions about the future, before moving on to more complicated
ones.</p>
</div>
<div id="naive-model" class="section level3">
<h3>Naive model</h3>
<p>The naive model we are going to use is simply a forecast that is
equal to the latest observation.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating and Plotting the naive model</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>naive_fit <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">model</span>(<span class="fu">NAIVE</span>(Total))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(naive_fit) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date)) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Total, <span class="at">colour =</span> <span class="st">&quot;Data&quot;</span>)) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">colour =</span> <span class="st">&quot;Fitted&quot;</span>)) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">Data =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">Fitted =</span> <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Series&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 1 row containing missing values (`geom_line()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-15-1.png" width="768" /></p>
<p>This plot is basically shows the original data, and then a copy of it
which is moved one period in the future.</p>
<p>Now let’s look at the residuals of the naive forecasting model, and
search for autocorrelation. It is important to do so, because if there
is autocorrelation in a the residuals of a forecasting model, this means
that the model is not capturing some of the important features of the
data, and might be leading to an inaccurate forecast. We will use the
Portmanteau (Ljung-box) test:</p>
<p>This test checks for the presence of autocorrelation in the
residuals, by testing the following null hypothesis: <span
class="math inline">\(H_0:\)</span> The residuals are independently and
identically distributed (IID) with a normal distribution. If the p-value
of the test is less than the chosen significance level (example <span
class="math inline">\(\alpha= 0.05\)</span>), then we reject the null
hypothesis and conclude that there is evidence of autocorrelation in the
residuals.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting the residuals of the naive method</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>aug <span class="ot">&lt;-</span> naive_fit <span class="sc">%&gt;%</span> <span class="fu">augment</span>()</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(aug, .resid) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Month&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Residual&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Residuals from naïve method&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 1 row containing missing values (`geom_line()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-16-1.png" width="768" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Box-pierce test</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>aug <span class="sc">%&gt;%</span> <span class="fu">features</span>(.resid, box_pierce, <span class="at">lag =</span> <span class="dv">10</span>, <span class="at">dof =</span> <span class="dv">0</span>) <span class="co">#The degrees of freedom (dof) are 0 for the naive method</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .model       bp_stat bp_pvalue
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
## 1 NAIVE(Total)    40.4 0.0000143</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ljung test</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>aug <span class="sc">%&gt;%</span> <span class="fu">features</span>(.resid, ljung_box, <span class="at">lag =</span> <span class="dv">10</span>, <span class="at">dof =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .model       lb_stat lb_pvalue
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
## 1 NAIVE(Total)    41.0 0.0000115</code></pre>
<p>From both the Box-pierce and Ljung tests, we can see that the p-value
is very small (very close to 0) which indicates the presence of
autocorrelation in the residuals. This means that the residuals are not
white noise, which is not good and we will have to work around it.</p>
</div>
<div id="forecast-for-the-next-6-months-using-the-naive-model"
class="section level3">
<h3>Forecast for the next 6 months using the Naive model:</h3>
<p>Now that we have built the naive model, and explained that it might
be inaccurate due to the presence of autocorrelation, let’s create a
forecast using it:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>naive_fc <span class="ot">&lt;-</span> fabletools<span class="sc">::</span><span class="fu">forecast</span>(naive_fit, <span class="at">h =</span> <span class="dv">6</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(naive_fc) <span class="sc">+</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Date&quot;</span>) <span class="sc">+</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Electricity Exports&quot;</span>) <span class="sc">+</span> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Naive Forecast for 6 months - Total Electricity Exports&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-17-1.png" width="768" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the forecast object to a tibble to be able to use it with the kable function</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>forecast_tbl_naive <span class="ot">&lt;-</span> naive_fc <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, .mean)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the kable function to display the table</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(forecast_tbl_naive, <span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Date&quot;</span>, <span class="st">&quot;Forecast&quot;</span>), </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">&quot;cccc&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">Date</th>
<th align="center">Forecast</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2022 Dec</td>
<td align="center">2410</td>
</tr>
<tr class="even">
<td align="center">2023 Jan</td>
<td align="center">2410</td>
</tr>
<tr class="odd">
<td align="center">2023 Feb</td>
<td align="center">2410</td>
</tr>
<tr class="even">
<td align="center">2023 Mar</td>
<td align="center">2410</td>
</tr>
<tr class="odd">
<td align="center">2023 Apr</td>
<td align="center">2410</td>
</tr>
<tr class="even">
<td align="center">2023 May</td>
<td align="center">2410</td>
</tr>
</tbody>
</table>
<p>As expected, the output of the Naive forecast is a flat line. This is
because in this model, each forecast is equal to the value in the
previous period. This isn’t very useful and accurate, so we have to use
more complicated and sophisticated models for the rest of this
analysis.</p>
</div>
<div id="ets-model---exponential-smoothing" class="section level3">
<h3>ETS model - Exponential Smoothing</h3>
<p>ETS stands for Error-Trend-Seasonality, and is one of the most robust
and commonly used forecasting methods in the industry.</p>
<p>ETS is based on the idea that more recent observations should be
given more importance when creating a forecast. It’s a method that
allocates weights to each observation, and the weights are bigger, the
more recent the data is. As we go back in time, the weights become
exponentially smaller, giving less and less weight/importance on older
data.</p>
<p>In our case, the most recent data (2020-2022) were probably heavily
impacted by Covid-19 and the war between Russia and Ukraine. This means
that an ETS model, will put more weight on more recent data, hence will
give us a biased forecast based on those two big events. We have to be
careful when selecting the weights of the ETS model, so that not too
much weight is put on the most recent data.</p>
</div>
<div id="simple-exponential-smoothing" class="section level3">
<h3>Simple Exponential Smoothing</h3>
<p>This version of Exponential smoothing, assumes that the data has no
Trend and no Seasonality:</p>
</div>
<div id="exponential-smoothing-with-different-alpha-parameters"
class="section level3">
<h3>Exponential smoothing with different alpha parameters</h3>
<p>The classical exponential smoothing function, will require a variable
alpha (<span class="math inline">\(\alpha\)</span>) which determines the
weight on different observations over time. The higher the value of
alpha, the more weight is given on more recent observations. Let’s look
at the forecast of an ETS model which gives a lot of weight on recent
observations, and much less on those further back in time.</p>
<div
id="big-weight-on-more-recent-data-in-order-to-create-a-forecast-alpha-0.8"
class="section level4">
<h4>Big weight on more recent data in order to create a forecast (Alpha
= 0.8)</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The following is an ANN model with an alpha of 0.8, to show that a lot of weight is put on more recent observations</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>ets_fit1 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Total <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;N&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>ets_fit1 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(data_elec, <span class="at">level =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ETS ANN forecast with alpha = 0.8&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-19-1.png" width="768" /></p>
</div>
<div
id="less-weight-on-more-recent-data-in-order-to-create-a-forecast-alpha-0.2"
class="section level4">
<h4>Less weight on more recent data in order to create a forecast (Alpha
= 0.2)</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The following is an ANN model with an alpha of 0.2, to show that less weight is put on more recent observations</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>ets_fit2 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Total <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;N&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>)))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>ets_fit2 <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(data_elec, <span class="at">level =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ETS ANN forecast with alpha = 0.2&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-20-1.png" width="768" /></p>
<p>From both of these ETS forecast graphs, you can see that the forecast
is flat. This is because to make these two, we assumed no Trend and no
Seasonality in the data.</p>
<p>Also, what’s important to notice is that the forecast when alpha is
large (0.8) is much closer to the last observation, but the forecast
with a smaller alpha (0.2) is further away from the last observation.
This is because the higher the value of alpha, the more weight is put to
more recent data, as explained above.</p>
<p>There is an automated way to select the optimal alpha:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ets_fitopt <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Total <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&quot;A&quot;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&quot;N&quot;</span>), <span class="at">opt_crit =</span> <span class="st">&quot;mse&quot;</span>))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(ets_fitopt)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .model                                                          term  estimate
##   &lt;chr&gt;                                                           &lt;chr&gt;    &lt;dbl&gt;
## 1 &quot;ETS(Total ~ error(\&quot;A\&quot;) + trend(\&quot;N\&quot;) + season(\&quot;N\&quot;), opt_… alpha    0.310
## 2 &quot;ETS(Total ~ error(\&quot;A\&quot;) + trend(\&quot;N\&quot;) + season(\&quot;N\&quot;), opt_… l[0]  2538.</code></pre>
<p>The alpha that minimizes the mean squared error, is an alpha with
value 0.310. Here’s how that forecast looks:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ets_fitopt <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(data_elec) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">colour =</span> <span class="st">&quot;Fitted&quot;</span>),  <span class="at">data=</span><span class="fu">augment</span>(ets_fitopt)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Total&quot;</span>) <span class="sc">+</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ETS ANN forecast with optimal alpha = 0.31&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-22-1.png" width="768" /></p>
<p>In the graph above, you can see in black the actual data, and in red
the smoothed values of the data, based on the optimal alpha that was
calculated. On the right side of the graph, you can see the forecast for
the next 12 period, as well as a 95% and 80% confidence interval. The
confidence intervals are huge, which is not good. We can no accurately
forecast this time series using this model.</p>
<p>This forecast is also very simple, so we will have to make things a
bit more complicated. Let’s now try playing with the parameters for
Error, Trend and Seasonality, because until now we have assumed that the
errors Additive, and that there is not trend and no seasonality in the
data.</p>
</div>
</div>
</div>
</div>
<div id="model-selection" class="section level1">
<h1>Model Selection</h1>
<div id="methodology" class="section level2">
<h2>Methodology</h2>
<p>To evaluate the forecast accuracy, we will test how a model performs
on new data not used during the fitting phase. So, we split our data
into training and test set. The first one we will use to estimate any
parameters of the forecasting method, and the second - is to define the
model’s accuracy. We fit the training data to models selected (ARIMA,
ETS, SNAIVE) to forecast 60 following periods (in our case, months). We
refit our models with test data and calculate the accuracy of the
forecast. We select the model with the lowest accuracy metrics for
further forecast. Low metric values indicate the better predictive
performance of the model, with a value of 0 indicating a perfect fit
between the predicted and actual values. Residuals analysis is also will
be plotted to see how well the model captures the dynamics in data. Good
models’ residuals should be stationary (white noise) and have no
patterns.</p>
<p>We can see strong seasonality and trend in data from decomposition
analysis, so we tested ARIMA, ETS, and Seasonal NAIVE models as we
assume these models can handle these types of data the best.</p>
<p>Lichtenstei Analysis will be described separately.</p>
</div>
<div id="germany-1" class="section level2 tabset">
<h2 class="tabset">Germany</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>Germany_since_2015 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date,Germany) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(<span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>)))</span></code></pre></div>
<div id="testing-models" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>training_ge <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Germany) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &lt; as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&lt;.vctrs_vctr&quot;, &quot;&lt;.Date&quot;) for &quot;&lt;&quot;</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>test_ge <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Germany) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>data_fit_ge_a <span class="ot">&lt;-</span> training_ge <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Germany))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>forecasts_ge_a <span class="ot">&lt;-</span> data_fit_ge_a <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>data_fit_ge_e <span class="ot">&lt;-</span> training_ge <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Germany))</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>forecasts_ge_e <span class="ot">&lt;-</span> data_fit_ge_e <span class="sc">%&gt;%</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>data_fit_ge_n <span class="ot">&lt;-</span> training_ge <span class="sc">%&gt;%</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Germany))</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>forecasts_ge_n <span class="ot">&lt;-</span> data_fit_ge_n <span class="sc">%&gt;%</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>all_forecasts_ge <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_ge_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_ge_a<span class="sc">$</span>.mean),</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_ge_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_ge_e<span class="sc">$</span>.mean),</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_ge_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_ge_n<span class="sc">$</span>.mean))</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Germany)  <span class="sc">+</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_ge, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Consumption in Germany&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-25-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table RMSE, MAE and other indicators, ARIMA
has the lowest values on the test data. The ARIMA model has an AIC of
2422.94, AICc of 2423.39, and BIC of 2442.49. On the other hand, the ETS
model has an AIC of 2975.557, AICc of 2978.110, and BIC of 3025.329.
These information criteria are used to assess the goodness of fit of a
model, with lower values indicating a better fit. Therefore, based on
these criteria, we can conclude that the ARIMA model fits the data
better than the ETS model.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>germany_accuracy_a <span class="ot">&lt;-</span>data_fit_ge_a <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_ge) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>germany_accuracy_e <span class="ot">&lt;-</span>data_fit_ge_e <span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_ge) <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>germany_accuracy_n <span class="ot">&lt;-</span>data_fit_ge_n <span class="sc">%&gt;%</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_ge) <span class="sc">%&gt;%</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>germany_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(germany_accuracy_a),</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(germany_accuracy_e),</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(germany_accuracy_n))</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>germany_accuracy_table</span></code></pre></div>
<pre><code>##            .model    .type          ME     RMSE      MAE        MPE     MAPE
## 1  ARIMA(Germany) Training   9.0270898 191.3758 120.9560  -6.177920 30.32461
## 2    ETS(Germany) Training -34.0600578 210.3173 130.9707  -9.946267 32.28047
## 3 SNAIVE(Germany) Training   0.5211268 329.2936 218.9718 -12.958205 52.08664
##        MASE     RMSSE      ACF1
## 1 0.5523815 0.5811706 0.4239149
## 2 0.5981166 0.6386924 0.5151985
## 3 1.0000000 1.0000000 0.6538549</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_ge_a)</span></code></pre></div>
<pre><code>## Series: Germany 
## Model: ARIMA(1,0,1)(2,1,1)[12] 
## 
## Coefficients:
##          ar1      ma1     sar1     sar2    sma1
##       0.7853  -0.2946  -0.8231  -0.4046  0.0965
## s.e.  0.0731   0.1106   0.1925   0.1247  0.2054
## 
## sigma^2 estimated as 15296:  log likelihood=-1124.06
## AIC=2260.11   AICc=2260.6   BIC=2279.27</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_ge_e)</span></code></pre></div>
<pre><code>## Series: Germany 
## Model: ETS(M,N,M) 
##   Smoothing parameters:
##     alpha = 0.3739358 
##     gamma = 0.3451097 
## 
##   Initial states:
##      l[0]      s[0]     s[-1]     s[-2]    s[-3]    s[-4]    s[-5]    s[-6]
##  653.4368 0.6246774 0.7255761 0.7347587 1.011001 1.387123 1.493534 1.469065
##     s[-7]     s[-8]    s[-9]    s[-10]    s[-11]
##  1.560156 0.7932617 0.864902 0.6433645 0.6925801
## 
##   sigma^2:  0.094
## 
##      AIC     AICc      BIC 
## 2797.057 2799.784 2845.919</code></pre>
</div>
<div id="residuals" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_ge_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Germany residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-27-1.png" width="768" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_ge_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Germany residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-27-2.png" width="768" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_ge_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Germany residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-27-3.png" width="768" /></p>
</div>
</div>
<div id="italy-1" class="section level2 tabset">
<h2 class="tabset">Italy</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Selecting Italy only since 2018 to better display the forecast. 2018 will both show the trend BEFORE covid + improve display </span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>Italy_since_2018 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Italy) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2018-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2018-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div id="testing-models-1" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>training_it <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Italy) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &lt; as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&lt;.vctrs_vctr&quot;, &quot;&lt;.Date&quot;) for &quot;&lt;&quot;</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>test_it <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Italy) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>data_fit_it_a <span class="ot">&lt;-</span> training_it <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Italy)) </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>forecasts_it_a <span class="ot">&lt;-</span> data_fit_it_a <span class="sc">%&gt;%</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>forecasts_it_a <span class="ot">&lt;-</span> data_fit_it_a <span class="sc">%&gt;%</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>data_fit_it_e <span class="ot">&lt;-</span> training_it <span class="sc">%&gt;%</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Italy))</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>forecasts_it_e <span class="ot">&lt;-</span> data_fit_it_e <span class="sc">%&gt;%</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>data_fit_it_n <span class="ot">&lt;-</span> training_it <span class="sc">%&gt;%</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Italy))</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>forecasts_it_n <span class="ot">&lt;-</span> data_fit_it_n <span class="sc">%&gt;%</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>all_forecasts_it <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_it_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_it_a<span class="sc">$</span>.mean),</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_it_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_it_e<span class="sc">$</span>.mean),</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_it_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_it_n<span class="sc">$</span>.mean))</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Italy) <span class="sc">+</span></span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_it, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand in Italy&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-29-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-1" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table below, RMSE, MAE, and other
indicators, ETS has the lowest values on the test data. However, ARIMA
has lower values of AIC=2708.77, AICc=2709.1, and BIC=2725.06 than the
ETS model.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>italy_accuracy_a <span class="ot">&lt;-</span>data_fit_it_a <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_it) <span class="sc">%&gt;%</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>italy_accuracy_e <span class="ot">&lt;-</span>data_fit_it_e <span class="sc">%&gt;%</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_it) <span class="sc">%&gt;%</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>italy_accuracy_n <span class="ot">&lt;-</span>data_fit_it_n <span class="sc">%&gt;%</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_it) <span class="sc">%&gt;%</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>italy_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(italy_accuracy_a),</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(italy_accuracy_e),</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(italy_accuracy_n))</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_it_a)</span></code></pre></div>
<pre><code>## Series: Italy 
## Model: ARIMA(1,0,0)(2,0,0)[12] w/ mean 
## 
## Coefficients:
##          ar1    sar1    sar2  constant
##       0.6369  0.3471  0.3479  227.4524
## s.e.  0.0565  0.0673  0.0717   16.0636
## 
## sigma^2 estimated as 73103:  log likelihood=-1349.39
## AIC=2708.77   AICc=2709.1   BIC=2725.06</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_it_e)</span></code></pre></div>
<pre><code>## Series: Italy 
## Model: ETS(A,N,A) 
##   Smoothing parameters:
##     alpha = 0.7893584 
##     gamma = 0.0001000066 
## 
##   Initial states:
##      l[0]     s[0]    s[-1]    s[-2]     s[-3]    s[-4]    s[-5]    s[-6]
##  2001.551 15.17983 90.59285 210.0609 -95.62885 -503.615 165.2749 -103.177
##      s[-7]     s[-8]    s[-9]   s[-10]   s[-11]
##  -101.2201 -20.17958 171.0857 59.06312 112.5631
## 
##   sigma^2:  71693.32
## 
##      AIC     AICc      BIC 
## 3171.492 3174.219 3220.354</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>italy_accuracy_table</span></code></pre></div>
<pre><code>##          .model    .type         ME     RMSE      MAE       MPE     MAPE
## 1  ARIMA(Italy) Training -48.053328 349.3088 284.5911 -7.772352 19.11066
## 2    ETS(Italy) Training  -2.494859 311.7141 241.4607 -2.802543 14.91659
## 3 SNAIVE(Italy) Training -12.436620 554.0566 432.4366 -7.043190 28.78426
##        MASE     RMSSE        ACF1
## 1 0.6581105 0.6304568 -0.03999788
## 2 0.5583725 0.5626034  0.03031226
## 3 1.0000000 1.0000000  0.53072915</code></pre>
</div>
<div id="residuals-1" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_it_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Italy residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-31-1.png" width="768" /></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_it_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Italy residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-31-2.png" width="768" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_it_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Italy residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-31-3.png" width="768" /></p>
</div>
</div>
<div id="austria-1" class="section level2 tabset">
<h2 class="tabset">Austria</h2>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Investigating Austria closely since 2018, because it seems like something changed -&gt; perhaps should use Piecewise!!!</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>Austria_since_2015 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Austria) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2015-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>Austria_since_2018 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Austria) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2018-02-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2018-02-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div id="testing-models-2" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>training_au <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Austria) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &lt; as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&lt;.vctrs_vctr&quot;, &quot;&lt;.Date&quot;) for &quot;&lt;&quot;</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>test_au <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Austria) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>data_fit_au_a <span class="ot">&lt;-</span> training_au <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Austria, <span class="at">stepwise =</span> <span class="cn">FALSE</span>))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>forecasts_au_a <span class="ot">&lt;-</span> data_fit_au_a <span class="sc">%&gt;%</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>data_fit_au_e <span class="ot">&lt;-</span> training_au <span class="sc">%&gt;%</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Austria))</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>forecasts_au_e <span class="ot">&lt;-</span> data_fit_au_e <span class="sc">%&gt;%</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>data_fit_au_n <span class="ot">&lt;-</span> training_au <span class="sc">%&gt;%</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Austria))</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>forecasts_au_n <span class="ot">&lt;-</span> data_fit_au_n <span class="sc">%&gt;%</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>all_forecasts_au <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_au_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_au_a<span class="sc">$</span>.mean),</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_au_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_au_e<span class="sc">$</span>.mean),</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_au_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_au_n<span class="sc">$</span>.mean))</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Austria) <span class="sc">+</span></span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_au, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand in Austria&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-33-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-2" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table below, RMSE, MAE, and other
indicators, ETS has the lowest values on the test data. However, ARIMA
has lower values of AIC=1839.24, AICc=1840.03, and BIC=1865.3 than the
ETS model.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>austria_accuracy_a <span class="ot">&lt;-</span>data_fit_au_a <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_au) <span class="sc">%&gt;%</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>austria_accuracy_e <span class="ot">&lt;-</span>data_fit_au_e <span class="sc">%&gt;%</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_au) <span class="sc">%&gt;%</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>austria_accuracy_n <span class="ot">&lt;-</span>data_fit_au_n <span class="sc">%&gt;%</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_au) <span class="sc">%&gt;%</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>austria_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(austria_accuracy_a),</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(austria_accuracy_e),</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(austria_accuracy_n))</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_au_a)</span></code></pre></div>
<pre><code>## Series: Austria 
## Model: ARIMA(0,0,3)(2,0,1)[12] w/ mean 
## 
## Coefficients:
##          ma1     ma2     ma3    sar1    sar2     sma1  constant
##       0.5991  0.1591  0.1055  0.6072  0.0853  -0.3699    6.3202
## s.e.  0.0742  0.0814  0.0731  0.2940  0.1561   0.2850    2.1449
## 
## sigma^2 estimated as 796.7:  log likelihood=-911.62
## AIC=1839.24   AICc=1840.03   BIC=1865.3</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_au_e)</span></code></pre></div>
<pre><code>## Series: Austria 
## Model: ETS(A,N,A) 
##   Smoothing parameters:
##     alpha = 0.5246043 
##     gamma = 0.0001000228 
## 
##   Initial states:
##      l[0]      s[0]     s[-1]     s[-2]      s[-3]    s[-4]   s[-5]    s[-6]
##  39.20052 -12.84024 -7.616428 -8.086183 -0.9683645 43.50499 39.8389 2.189109
##      s[-7]     s[-8]     s[-9]    s[-10]    s[-11]
##  0.7038562 -11.55768 -14.38028 -16.43484 -14.35283
## 
##   sigma^2:  895.6703
## 
##      AIC     AICc      BIC 
## 2330.036 2332.764 2378.899</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>austria_accuracy_table</span></code></pre></div>
<pre><code>##                             .model    .type        ME     RMSE      MAE
## 1 ARIMA(Austria, stepwise = FALSE) Training 23.712075 58.28096 41.41573
## 2                     ETS(Austria) Training  1.957058 49.14910 35.08150
## 3                  SNAIVE(Austria) Training 10.760563 88.47408 67.54930
##         MPE      MAPE      MASE     RMSSE        ACF1
## 1 -18.68018  72.22767 0.6131186 0.6587349 -0.05024102
## 2 -66.98305 101.49245 0.5193467 0.5555198  0.04964282
## 3 -57.48300 118.72629 1.0000000 1.0000000  0.50380298</code></pre>
</div>
<div id="residuals-2" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_au_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Austria residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-35-1.png" width="768" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_au_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Austria residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-35-2.png" width="768" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_au_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Austria residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-35-3.png" width="768" /></p>
</div>
</div>
<div id="france-1" class="section level2 tabset">
<h2 class="tabset">France</h2>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>France_since_2015 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,France) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2015-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div id="testing-models-3" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb105"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>training_fr <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, France) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &lt; as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&lt;.vctrs_vctr&quot;, &quot;&lt;.Date&quot;) for &quot;&lt;&quot;</code></pre>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>test_fr <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, France) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>data_fit_fr_a <span class="ot">&lt;-</span> training_fr <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(France))</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>forecasts_fr_a <span class="ot">&lt;-</span> data_fit_fr_a <span class="sc">%&gt;%</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>data_fit_fr_e <span class="ot">&lt;-</span> training_fr <span class="sc">%&gt;%</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(France))</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>forecasts_fr_e <span class="ot">&lt;-</span> data_fit_fr_e <span class="sc">%&gt;%</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>data_fit_fr_n <span class="ot">&lt;-</span> training_fr <span class="sc">%&gt;%</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(France))</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>forecasts_fr_n <span class="ot">&lt;-</span> data_fit_fr_n <span class="sc">%&gt;%</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>all_forecasts_fr <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_fr_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_fr_a<span class="sc">$</span>.mean),</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_fr_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_fr_e<span class="sc">$</span>.mean),</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_fr_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_fr_n<span class="sc">$</span>.mean))</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(France) <span class="sc">+</span></span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_fr, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand in France&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-37-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-3" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table below, RMSE, MAE, and other
indicators, ETS has the lowest values on the test data. However, ARIMA
has lower values of AIC = 2558.88, AICc = 2559.46, and BIC=2582.07 than
the ETS model.</p>
<div class="sourceCode" id="cb110"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>france_accuracy_a <span class="ot">&lt;-</span>data_fit_fr_a <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_fr) <span class="sc">%&gt;%</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>france_accuracy_e <span class="ot">&lt;-</span>data_fit_fr_e <span class="sc">%&gt;%</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_fr) <span class="sc">%&gt;%</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>france_accuracy_n <span class="ot">&lt;-</span>data_fit_fr_n <span class="sc">%&gt;%</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_fr) <span class="sc">%&gt;%</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>france_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(france_accuracy_a),</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(france_accuracy_e),</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(france_accuracy_n))</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_fr_a)</span></code></pre></div>
<pre><code>## Series: France 
## Model: ARIMA(1,1,4)(0,0,1)[12] 
## 
## Coefficients:
##          ar1      ma1      ma2      ma3      ma4    sma1
##       0.0186  -0.4859  -0.1850  -0.0946  -0.1620  0.1771
## s.e.  0.4208   0.4161   0.2162   0.1137   0.1172  0.0764
## 
## sigma^2 estimated as 15135:  log likelihood=-1188.05
## AIC=2390.09   AICc=2390.7   BIC=2412.86</code></pre>
<div class="sourceCode" id="cb112"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>france_accuracy_table</span></code></pre></div>
<pre><code>##           .model    .type         ME     RMSE      MAE       MPE     MAPE
## 1  ARIMA(France) Training  0.4465108 208.4824 169.0814 -30.99631 59.28774
## 2    ETS(France) Training -7.7226182 181.6390 146.1496 -30.05412 53.91812
## 3 SNAIVE(France) Training -7.8450704 273.8479 216.0141 -35.68783 76.53401
##        MASE     RMSSE        ACF1
## 1 0.7827331 0.7613072 -0.07489327
## 2 0.6765742 0.6632845  0.14238978
## 3 1.0000000 1.0000000  0.14446626</code></pre>
<div class="sourceCode" id="cb114"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_fr_e)</span></code></pre></div>
<pre><code>## Series: France 
## Model: ETS(M,N,M) 
##   Smoothing parameters:
##     alpha = 0.1672851 
##     gamma = 0.0001002813 
## 
##   Initial states:
##     l[0]     s[0]     s[-1]    s[-2]   s[-3]   s[-4]    s[-5]     s[-6]
##  170.609 1.250038 0.9416617 1.095887 1.04379 1.14645 1.291704 0.9937027
##      s[-7]     s[-8]     s[-9]  s[-10]   s[-11]
##  0.6362197 0.6065504 0.7543347 1.13727 1.102391
## 
##   sigma^2:  0.2439
## 
##      AIC     AICc      BIC 
## 2844.032 2846.759 2892.894</code></pre>
</div>
<div id="residuals-3" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb116"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_fr_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA France residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-39-1.png" width="768" /></p>
<div class="sourceCode" id="cb117"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_fr_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS France residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-39-2.png" width="768" /></p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_fr_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE France residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-39-3.png" width="768" /></p>
</div>
</div>
<div id="total-1" class="section level2 tabset">
<h2 class="tabset">Total</h2>
<div class="sourceCode" id="cb122"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>Total_since_2015 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Total) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2015-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div id="testing-models-4" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb124"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>training_tot <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Total) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &lt; as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&lt;.vctrs_vctr&quot;, &quot;&lt;.Date&quot;) for &quot;&lt;&quot;</code></pre>
<div class="sourceCode" id="cb126"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>test_tot <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Total) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb128"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>data_fit_tot_a <span class="ot">&lt;-</span> training_tot <span class="sc">%&gt;%</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Total))</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>forecasts_tot_a <span class="ot">&lt;-</span> data_fit_tot_a <span class="sc">%&gt;%</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>data_fit_tot_e <span class="ot">&lt;-</span> training_tot <span class="sc">%&gt;%</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Total))</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>forecasts_tot_e <span class="ot">&lt;-</span> data_fit_tot_e <span class="sc">%&gt;%</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>data_fit_tot_n <span class="ot">&lt;-</span> training_tot <span class="sc">%&gt;%</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Total))</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>forecasts_tot_n <span class="ot">&lt;-</span> data_fit_tot_n <span class="sc">%&gt;%</span></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>all_forecasts_tot <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_tot_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_tot_a<span class="sc">$</span>.mean),</span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_tot_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_tot_e<span class="sc">$</span>.mean),</span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_tot_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_tot_n<span class="sc">$</span>.mean))</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Total) <span class="sc">+</span></span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_tot, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand to all countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-41-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-4" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table below, RMSE, MAE, and other
indicators, ETS has the lowest values on the test data. However, ARIMA
has lower values of AIC=2683.45, AICc=2683.9, and BIC=2702.99 than the
ETS model.</p>
<div class="sourceCode" id="cb129"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>total_accuracy_a <span class="ot">&lt;-</span>data_fit_tot_a <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_tot) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>total_accuracy_e <span class="ot">&lt;-</span>data_fit_tot_e <span class="sc">%&gt;%</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_tot) <span class="sc">%&gt;%</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>total_accuracy_n <span class="ot">&lt;-</span>data_fit_tot_n <span class="sc">%&gt;%</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_tot) <span class="sc">%&gt;%</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>total_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(total_accuracy_a),</span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(total_accuracy_e),</span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(total_accuracy_n))</span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_tot_a)</span></code></pre></div>
<pre><code>## Series: Total 
## Model: ARIMA(1,0,1)(2,0,0)[12] w/ mean 
## 
## Coefficients:
##          ar1      ma1    sar1    sar2  constant
##       0.7159  -0.2076  0.3750  0.3755  195.5746
## s.e.  0.0912   0.1344  0.0685  0.0708   11.2588
## 
## sigma^2 estimated as 63131:  log likelihood=-1335.72
## AIC=2683.45   AICc=2683.9   BIC=2702.99</code></pre>
<div class="sourceCode" id="cb131"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>total_accuracy_table</span></code></pre></div>
<pre><code>##          .model    .type         ME     RMSE      MAE       MPE      MAPE
## 1  ARIMA(Total) Training -24.755873 330.0999 265.2221 -2.475478 10.561219
## 2    ETS(Total) Training  -4.567152 284.6104 226.3630 -1.089216  8.842026
## 3 SNAIVE(Total) Training  -9.154930 538.1098 433.9155 -2.272180 16.742385
##        MASE     RMSSE         ACF1
## 1 0.6112298 0.6134435 -0.032412752
## 2 0.5216754 0.5289076  0.009325172
## 3 1.0000000 1.0000000  0.555685440</code></pre>
<div class="sourceCode" id="cb133"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_tot_e)</span></code></pre></div>
<pre><code>## Series: Total 
## Model: ETS(A,N,A) 
##   Smoothing parameters:
##     alpha = 0.5690082 
##     gamma = 0.0002217215 
## 
##   Initial states:
##      l[0]     s[0]     s[-1]    s[-2]     s[-3]     s[-4]    s[-5]    s[-6]
##  2735.222 -30.5261 -39.40677 146.1547 -77.94267 -290.9088 509.1663 81.12738
##     s[-7]     s[-8]     s[-9]   s[-10]    s[-11]
##  83.81698 -205.6554 -47.17994 -126.659 -1.986777
## 
##   sigma^2:  60986.36
## 
##      AIC     AICc      BIC 
## 3140.436 3143.164 3189.299</code></pre>
</div>
<div id="residuals-4" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb135"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_tot_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Total residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-43-1.png" width="768" /></p>
<div class="sourceCode" id="cb136"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_tot_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Total residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-43-2.png" width="768" /></p>
<div class="sourceCode" id="cb137"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_tot_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Total residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-43-3.png" width="768" /></p>
</div>
</div>
<div id="result" class="section level2">
<h2>Result</h2>
<p>All of these metrics are important for evaluating forecast accuracy.
Still, we decided to give more weight to AIC, as this indicator
considers both the complexity and the model’s fit. As a result, the
ARIMA model is selected to forecast the electricity demand in Germany,
Italy, Austria, France, and for all countries together.</p>
</div>
</div>
<div id="forecast" class="section level1">
<h1>Forecast</h1>
<div id="germany-2" class="section level2 tabset">
<h2 class="tabset">Germany</h2>
<div class="sourceCode" id="cb141"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling ARIMA automatically</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>arima_germany <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Germany) <span class="sc">%&gt;%</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">arima =</span> <span class="fu">ARIMA</span>(Germany))</span></code></pre></div>
<pre><code>## Warning in sqrt(diag(best$var.coef)): NaNs produced</code></pre>
<div class="sourceCode" id="cb143"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>forecast_arima_germany <span class="ot">&lt;-</span> arima_germany <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>)</span></code></pre></div>
<div id="checking-residuals" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<div class="sourceCode" id="cb144"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>arima_germany <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SARIMA Germany residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-45-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<div class="sourceCode" id="cb145"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>arima_germany <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Germany_since_2015) <span class="sc">+</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Forecast for Germany&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-46-1.png" width="768" /></p>
<div class="sourceCode" id="cb146"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>forecast_table_germany_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ARIMA&quot;</span>),</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_arima_germany))</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>forecast_table_germany_a <span class="ot">&lt;-</span> forecast_table_germany_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values..mean)</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_germany_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Germany_arima&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<div class="sourceCode" id="cb147"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>forecast_table_germany_a</span></code></pre></div>
<pre><code>##    Germany_arima
## 1       147.2149
## 2       163.1294
## 3       141.2789
## 4       187.9230
## 5       427.7421
## 6       712.0248
## 7       667.7915
## 8       602.9667
## 9       674.8981
## 10      370.6873
## 11      255.5486
## 12      194.3009
## 13      179.9529</code></pre>
</div>
</div>
<div id="italy-2" class="section level2 tabset">
<h2 class="tabset">Italy</h2>
<div class="sourceCode" id="cb149"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling ARIMA automatically</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>arima_italy <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Italy) <span class="sc">%&gt;%</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">arima =</span> <span class="fu">ARIMA</span>(Italy))</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>forecast_arima_italy <span class="ot">&lt;-</span> arima_italy <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>)</span></code></pre></div>
<div id="checking-residuals-1" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<div class="sourceCode" id="cb150"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>arima_italy <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SARIMA Italy residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-49-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-1" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<div class="sourceCode" id="cb151"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>arima_italy <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Italy_since_2018) <span class="sc">+</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Forecast for Italy&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-50-1.png" width="768" /></p>
<div class="sourceCode" id="cb152"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>forecast_table_italy_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ARIMA&quot;</span>),</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_arima_italy))</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>forecast_table_italy_a <span class="ot">&lt;-</span> forecast_table_italy_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values..mean)</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_italy_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Italy_arima&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-1" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<div class="sourceCode" id="cb153"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>forecast_table_italy_a</span></code></pre></div>
<pre><code>##    Italy_arima
## 1     1826.559
## 2     1830.641
## 3     2084.348
## 4     2064.941
## 5     1763.042
## 6     1826.055
## 7     1930.824
## 8     2272.030
## 9     1978.937
## 10    1936.262
## 11    1939.172
## 12    1906.992
## 13    1816.285</code></pre>
</div>
</div>
<div id="austria-2" class="section level2 tabset">
<h2 class="tabset">Austria</h2>
<div class="sourceCode" id="cb155"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling ARIMA automatically</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>arima_austria <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Austria) <span class="sc">%&gt;%</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">arima =</span> <span class="fu">ARIMA</span>(Austria))</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>forecast_arima_austria <span class="ot">&lt;-</span> arima_austria <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>)</span></code></pre></div>
<div id="checking-residuals-2" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<div class="sourceCode" id="cb156"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>arima_austria <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SARIMA Austria residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-53-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-2" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<div class="sourceCode" id="cb157"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>arima_austria <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Austria_since_2015) <span class="sc">+</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Forecast for Austria&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-54-1.png" width="768" /></p>
<div class="sourceCode" id="cb158"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>forecast_table_austria_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ARIMA&quot;</span>),</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_arima_austria))</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>forecast_table_austria_a <span class="ot">&lt;-</span> forecast_table_austria_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values..mean)</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_austria_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Austria_arima&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-2" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<div class="sourceCode" id="cb159"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>forecast_table_austria_a</span></code></pre></div>
<pre><code>##    Austria_arima
## 1       70.83719
## 2       98.11923
## 3       98.11923
## 4       98.11923
## 5       98.11923
## 6       98.11923
## 7       98.11923
## 8       98.11923
## 9       98.11923
## 10      98.11923
## 11      98.11923
## 12      98.11923
## 13      98.11923</code></pre>
</div>
</div>
<div id="france-2" class="section level2 tabset">
<h2 class="tabset">France</h2>
<div class="sourceCode" id="cb161"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling ARIMA automatically</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>arima_france <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(France) <span class="sc">%&gt;%</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">arima =</span> <span class="fu">ARIMA</span>(France))</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>forecast_arima_france <span class="ot">&lt;-</span> arima_france <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>)</span></code></pre></div>
<div id="checking-residuals-3" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<div class="sourceCode" id="cb162"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>arima_france <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SARIMA France residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-57-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-3" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<div class="sourceCode" id="cb163"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphing the forecast</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>arima_france <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(France_since_2015) <span class="sc">+</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Forecast for France&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-58-1.png" width="768" /></p>
<div class="sourceCode" id="cb164"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>forecast_table_france_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ARIMA&quot;</span>),</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_arima_france))</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>forecast_table_france_a <span class="ot">&lt;-</span> forecast_table_france_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values..mean)</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_france_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;France_arima&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-3" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<div class="sourceCode" id="cb165"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>forecast_table_france_a</span></code></pre></div>
<pre><code>##    France_arima
## 1      263.9312
## 2      383.6005
## 3      320.5275
## 4      351.3831
## 5      353.5785
## 6      350.5107
## 7      345.8482
## 8      358.7890
## 9      345.7798
## 10     329.4261
## 11     294.9338
## 12     342.4077
## 13     376.1259</code></pre>
</div>
</div>
<div id="total-2" class="section level2 tabset">
<h2 class="tabset">Total</h2>
<div class="sourceCode" id="cb167"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling ARIMA automatically</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>arima_total <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Total) <span class="sc">%&gt;%</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">arima =</span> <span class="fu">ARIMA</span>(Total))</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>forecast_arima_total <span class="ot">&lt;-</span> arima_total <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>)</span></code></pre></div>
<div id="checking-residuals-4" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<div class="sourceCode" id="cb168"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>arima_total <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SARIMA residuals analysis for all countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-61-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-4" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<div class="sourceCode" id="cb169"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphing the forecast</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>arima_total <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Total_since_2015) <span class="sc">+</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Forecast for all countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-62-1.png" width="768" /></p>
<div class="sourceCode" id="cb170"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>forecast_table_total_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ARIMA&quot;</span>),</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_arima_total))</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>forecast_table_total_a <span class="ot">&lt;-</span> forecast_table_total_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values..mean)</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_total_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Total_arima&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-4" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<div class="sourceCode" id="cb171"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>forecast_table_total_a</span></code></pre></div>
<pre><code>##    Total_arima
## 1     2336.515
## 2     2507.818
## 3     2489.217
## 4     2580.353
## 5     2302.442
## 6     2411.328
## 7     2591.927
## 8     3070.838
## 9     2798.490
## 10    2469.884
## 11    2412.024
## 12    2300.391
## 13    2299.457</code></pre>
</div>
</div>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
