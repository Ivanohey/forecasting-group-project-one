<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
        <meta name="date" content="2023-05-18" />
    
    <title>Forecasting Project 1 - Group 7</title>

        <script src="main_files/header-attrs-2.19/header-attrs.js"></script>
        <script src="main_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="main_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="main_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="main_files/navigation-1.1/tabsets.js"></script>
        <script src="main_files/navigation-1.1/codefolding.js"></script>
        <link href="main_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="main_files/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="main_files/readthedown-0.1/readthedown.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #2a211c;
          color: #bdae9d;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #bdae9d;  padding-left: 4px; }
      div.sourceCode
        { color: #bdae9d; background-color: #2a211c; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ffff00; } /* Alert */
      code span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { } /* Attribute */
      code span.bn { color: #44aa43; } /* BaseN */
      code span.bu { } /* BuiltIn */
      code span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #049b0a; } /* Char */
      code span.cn { } /* Constant */
      code span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
      code span.do { color: #0066ff; font-style: italic; } /* Documentation */
      code span.dt { text-decoration: underline; } /* DataType */
      code span.dv { color: #44aa43; } /* DecVal */
      code span.er { color: #ffff00; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #44aa43; } /* Float */
      code span.fu { color: #ff9358; font-weight: bold; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
      code span.op { } /* Operator */
      code span.pp { font-weight: bold; } /* Preprocessor */
      code span.sc { color: #049b0a; } /* SpecialChar */
      code span.ss { color: #049b0a; } /* SpecialString */
      code span.st { color: #049b0a; } /* String */
      code span.va { } /* Variable */
      code span.vs { color: #049b0a; } /* VerbatimString */
      code span.wa { color: #ffff00; font-weight: bold; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
        <script>
      $(document).ready(function () {
	  	  	  window.initializeCodeFolding("hide" === "show");
	        });
    </script>
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
      <div class="btn-group pull-right">
     <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
     <ul class="dropdown-menu" style="min-width: 50px;">
	    	    <li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
	    <li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
	    	    	         </ul>
   </div>
   
        
      <h1 class="title">Forecasting Project 1 - Group 7</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Forecasting Project 1 - Group 7</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#data-cleaning" id="toc-data-cleaning">Data
      cleaning</a>
      <ul>
      <li><a href="#data-import" id="toc-data-import">Data
      import</a></li>
      <li><a href="#data-cleaning-1" id="toc-data-cleaning-1">Data
      cleaning</a></li>
      </ul></li>
      <li><a href="#things-that-need-to-be-done"
      id="toc-things-that-need-to-be-done">THINGS THAT NEED TO BE
      DONE</a></li>
      <li><a href="#introduction" id="toc-introduction">1.
      Introduction</a></li>
      <li><a href="#data-processing" id="toc-data-processing">2. Data
      Processing</a></li>
      <li><a href="#exploratory-data-analysis"
      id="toc-exploratory-data-analysis">3. Exploratory Data
      Analysis</a>
      <ul>
      <li><a href="#historical-data-plots"
      id="toc-historical-data-plots">3.1 Historical data plots</a></li>
      <li><a href="#seasonal-sub-series-plots"
      id="toc-seasonal-sub-series-plots">3.2 Seasonal Sub-series
      plots</a></li>
      <li><a href="#acf---autocorrelation-analysis"
      id="toc-acf---autocorrelation-analysis">3.3 ACF - Autocorrelation
      analysis</a></li>
      <li><a href="#decomposition" id="toc-decomposition">3.4
      Decomposition</a></li>
      </ul></li>
      <li><a href="#decomposition-1"
      id="toc-decomposition-1">Decomposition</a>
      <ul>
      <li><a href="#stl-decomposition-for-all-countries"
      id="toc-stl-decomposition-for-all-countries">STL Decomposition for
      all countries</a></li>
      </ul></li>
      <li><a href="#model-selection" id="toc-model-selection">Model
      Selection</a>
      <ul>
      <li><a href="#methodology"
      id="toc-methodology">Methodology</a></li>
      <li><a href="#germany-1" id="toc-germany-1">Germany</a></li>
      <li><a href="#italy-1" id="toc-italy-1">Italy</a></li>
      <li><a href="#austria-1" id="toc-austria-1">Austria</a></li>
      <li><a href="#france-1" id="toc-france-1">France</a></li>
      <li><a href="#lichtenstein-1"
      id="toc-lichtenstein-1">Lichtenstein</a></li>
      <li><a href="#total-1" id="toc-total-1">Total</a></li>
      <li><a href="#result" id="toc-result">Result</a></li>
      </ul></li>
      <li><a href="#forecast" id="toc-forecast">Forecast</a>
      <ul>
      <li><a href="#germany-2" id="toc-germany-2">Germany</a></li>
      <li><a href="#italy-2" id="toc-italy-2">Italy</a></li>
      <li><a href="#austria-2" id="toc-austria-2">Austria</a></li>
      <li><a href="#france-2" id="toc-france-2">France</a></li>
      <li><a href="#total-2" id="toc-total-2">Total</a></li>
      <li><a href="#combining-all-forecasts-into-one-table"
      id="toc-combining-all-forecasts-into-one-table">Combining all
      forecasts into one table:</a></li>
      </ul></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> K
K A I
		      </p>
                        <p class="date"><span class="glyphicon glyphicon-calendar"></span> 2023-05-18</p>
          </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div id="data-cleaning" class="section level1">
<h1>Data cleaning</h1>
<p>We import data and we clean it from <i>NA</i> and from blank rows. We
also name the columns. Here is a sample of our data:</p>
<pre><code>##            date germany france italy austria lichtenstein total
## 1  January 2000     421    313  1760       3           24  2521
## 2 February 2000     412    141  1757       4           23  2337
## 3    March 2000     459    148  1962       4           23  2596
## 4    April 2000     474    114  1767       3           17  2375
## 5      May 2000     935    116  1927      42           14  3034
## 6     June 2000     910    101  1895      31           13  2950</code></pre>
<div id="data-import" class="section level2">
<h2>Data import</h2>
<p>We directly import the data from the excel file, selecting only the
range that contains the data, and then setting the column names
accordingly.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#importing data directly from excel</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_elec <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/Electricity export Switzerland.xlsx&quot;</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">range =</span> <span class="st">&quot;A6:G280&quot;</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## New names:
## • `` -&gt; `...1`
## • `` -&gt; `...2`
## • `` -&gt; `...3`
## • `` -&gt; `...4`
## • `` -&gt; `...5`
## • `` -&gt; `...6`
## • `` -&gt; `...7`</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting column names</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_elec) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;Date&#39;</span>,<span class="st">&#39;Germany&#39;</span>,<span class="st">&#39;France&#39;</span>,<span class="st">&#39;Italy&#39;</span>,<span class="st">&#39;Austria&#39;</span>,<span class="st">&#39;Lichtenstein&#39;</span>,<span class="st">&#39;Total&#39;</span>)</span></code></pre></div>
</div>
<div id="data-cleaning-1" class="section level2">
<h2>Data cleaning</h2>
<p>Looking at the data we see that October is written with a “k”, so we
change that in the Date column. Then we check for missing values, before
proceeding.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace &quot;Oktober&quot; with &quot;October&quot; in the Date column</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data_elec<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(data_elec<span class="sc">$</span>Date, <span class="st">&quot;Oktober&quot;</span>, <span class="st">&quot;October&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#This uses the &quot;DataExplorer&quot; package</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_intro</span>(data_elec)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
<div
id="converting-to-tsibble-so-that-we-can-use-the-fpp3-and-tsibble-package-functions"
class="section level3">
<h3>Converting to tsibble so that we can use the fpp3 and tsibble
package functions</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert to tsibble </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>data_elec <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">yearmonth</span>(Date)) <span class="sc">%&gt;%</span> <span class="co">#need to do this before converting to get proper format</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> Date)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#check that it&#39;s a tsibble now, and we can see it recognized the data is monthly because of the [1M] </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">is_tsibble</span>(data_elec)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data_elec</span></code></pre></div>
<pre><code>## # A tsibble: 275 x 7 [1M]
##        Date Germany France Italy Austria Lichtenstein Total
##       &lt;mth&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;
##  1 2000 Jan     421    313  1760       3           24  2521
##  2 2000 Feb     412    141  1757       4           23  2337
##  3 2000 Mar     459    148  1962       4           23  2596
##  4 2000 Apr     474    114  1767       3           17  2375
##  5 2000 May     935    116  1927      42           14  3034
##  6 2000 Jun     910    101  1895      31           13  2950
##  7 2000 Jul     510    105  1950      16           14  2595
##  8 2000 Aug     612    152  1275      39           14  2092
##  9 2000 Sep     354    320  1849      18           17  2558
## 10 2000 Oct     439    291  2295      28           20  3073
## # ℹ 265 more rows</code></pre>
</div>
</div>
</div>
<div id="things-that-need-to-be-done" class="section level1">
<h1>THINGS THAT NEED TO BE DONE</h1>
<p>In general:</p>
<ul>
<li>Select what will go in the final report</li>
<li>Complete the Report</li>
<li>Create table with final forecasts (DONE) + Confidence intervals
(NEED TO DO)</li>
<li>Add lichtenstein forecast table + inside the final_fc</li>
</ul>
<p>Country specific:</p>
<ul>
<li>Explore huge peak in Austria 2002 -&gt; is it an outlier</li>
<li>Explain big drop in Lichtenstein + thought process behind piece-wise
model</li>
</ul>
</div>
<div id="introduction" class="section level1">
<h1>1. Introduction</h1>
<p>This project is a forecasting analysis for the electricity exports
from Switzerland to several European countries. The data used was all
provided by the professor and no additional datasets were used. We have
selected the models that fit each country the best (based on some
performance metrics) and have created forecasts and CI’s for each
country as well as the total. In the final report you are now reading,
only the most important information is included, and whatever was deemed
unnecessary for the report you can find in our code files.</p>
<p>The forecasting models used in this project are S-Naive, S-ARIMA, ETS
and a variant of TSLM (piece-wise) for a specific country.</p>
</div>
<div id="data-processing" class="section level1">
<h1>2. Data Processing</h1>
<p>The data we were given was already cleaned, without any missing
values. The only noteworthy cleaning we did, was to format the names of
all columns and all rows, and to then convert the final table to a
tsibble in order to be able to use functions from the tsibble and fpp3
package. All details on how this was done can be found in the code
files.</p>
</div>
<div id="exploratory-data-analysis" class="section level1">
<h1>3. Exploratory Data Analysis</h1>
<div id="historical-data-plots" class="section level2">
<h2>3.1 Historical data plots</h2>
<p>In this section you can find an example of the exploratory analysis
we did to identify outliers and behaviors in our data. We created
historical plots of all the data for each country, but this is not
presented here and can instead be found in our code files (eda.rmd). The
anomalies and outliers in the behaviors of exports for each country,
helped guide the rest of our analysis.</p>
<p>For example, we noticed irregularities in the amplitudes of
seasonality over time. For countries like Germany and France, the
amplitude of the seasonality seems to increase towards the most recent
years. Based on this, we decided to do a seasonal/trend decomposition
for each country to further analyze this.</p>
<p>Furthermore, for Lichtenstein, we noticed a huge drop in exports
after 2008-2009, which indicated that we should try different models
like the piece-wise model to seperate the differences in trend over
time.</p>
</div>
<div id="seasonal-sub-series-plots" class="section level2">
<h2>3.2 Seasonal Sub-series plots</h2>
<p>We also created seasonal sub-series plots to explore specific months
in more detail, for each country. Below you can see the one for the
total exports:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(Total) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to All countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<p>Here are some observations based on these plots for each country
(which you can find in eda.rmd):</p>
<ul>
<li>Germany: It looks like Germany consistently receives more
electricity during the summer months (May, June, July, August).
Seasonality seems to vary over time, increasing towards the most recent
years.</li>
<li>France: It looks like there are two peaks in energy exported to
France during the year, one in July, and one in December.<br />
</li>
<li>Italy: Similar energy peak in July.</li>
<li>Austria: Same trend, with a single peak in the summer months, and
then relatively constant energy for the other months.</li>
<li>Lichtenstein: This country shows the opposite trend, with a very
smooth peak in the coldest winter months (Jan,Feb), and the lowest
energy exports during the summer months.<br />
</li>
<li>Total: Clearly seeing the peak in energy exports to countries in the
summer, and specifically in July. The other months are at similar levels
for the total electricity exports.</li>
</ul>
<p>In summary, the main observation we got from these historical plots,
was that all countries (except Lichtenstein) experience peaks in the
electricity they receive from Switzerland in the summer months.</p>
<p>Before this monthly analysis, we expected that energy exports to
these countries, would be higher in the winter months, as that’s when
people tend to consumer more energy to heat up their homes (we assumed
this to be one of the biggest drivers in energy consumption). However,
in reality it seems like electricity exports are peaking in the summer
and not in the winter months. Our explanation for this is that the ways
to heat up a home in the winter are mainly based on oil/gas rather than
electricity which is why there is no peak for electricity exports in the
winter. On the contrary, during the summer months, people tend to cool
down their homes using Air-conditioning which primarily uses
electricity, hence the peak in the summer months. This does not explain
why Lichtenstein does not follow the same pattern, despite being
geographically right next to all of these countries (hence having
similar climate).</p>
</div>
<div id="acf---autocorrelation-analysis" class="section level2">
<h2>3.3 ACF - Autocorrelation analysis</h2>
<p>Before moving on with the models and in order to be able to use them,
we wanted to check for autocorrelation in the time series. Here is data
on Germany which is lagged by 12 periods:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Graph of 12 lagged months for Germany</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg_lag</span>(Germany, <span class="at">lags =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Germany 12-period lag graph&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
<p>From this graph, we can visualize autocorrelation. It’s clear that
the autocorrelation is the highest for the 1-month lag, and the 12-month
lag. We can see this because the points in the scatterplots (Current
month vs Lagged period x) approach the 45-degree line, indicating the
similarity in magnitude of two the observations.</p>
<p>Based on the strong and clear presence of autocorrelation, we expect
that a model like ARIMA/SARIMA will do a good job to capture this
auto-correlation component, and will most likely have the best
performance compared to other models. On the contrary, auto-correlation
tends to impact the performance of SNAIVE models, as they rely on the
assumption that the future values are solely determined by past values
without considering any auto-correlation patterns. This suggests that
our SNAIVE model will not be fitting the data as well.</p>
</div>
<div id="decomposition" class="section level2">
<h2>3.4 Decomposition</h2>
<p>In the final part of our EDA, we decided to perform an STL
decomposition, as it can provide valuable insights and help explore and
understand any strange patterns in our data. Overall, we observed strong
seasonality and trend patterns in each country and all countries
together which suggested our models should have a way to capture their
presence.</p>
<p>Here’s the STL decomposition for Germany:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Germany <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
</div>
</div>
<div id="decomposition-1" class="section level1">
<h1>Decomposition</h1>
<p>As time series data often consists of different patterns, it is
helpful to split time series into components, each representing a
pattern category. As a result, we can understand how each element
behaves over time and model each separately for greater forecasting
accuracy results. It will also help to decide on the type of forecasting
model.</p>
<p>For this purpose, we considered different types of decomposition
techniques: * Classical Decomposition assumes seasonal component repeats
from year to year, which usually is not the case in reality, over
smoothes rapid rises (is not recommended to use, but still…). * STL
Decomposition is a versatile and robust method that handles any
seasonality; seasonal components can change, and smoothness can be
controlled. * X-11 method originated in the US Census Bureau and was
further developed by Statistics Canada, based on classical
decomposition, a slightly improved version of classical decomposition;
the seasonal component varies slowly over time, highly robust to
outliers and level shifts in the time series. We decided to continue
with STL Decomposition.</p>
<p>We observe strong seasonality and trend patterns in each country and
all countries together. The data is non-stationary.</p>
<div id="stl-decomposition-for-all-countries"
class="section level2 tabset">
<h2 class="tabset">STL Decomposition for all countries</h2>
<div id="germany" class="section level3">
<h3><strong>Germany</strong></h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Germany <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-8-1.png" width="768" /></p>
</div>
<div id="france" class="section level3">
<h3><strong>France</strong></h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#STL Decomposition_France</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(France <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
</div>
<div id="italy" class="section level3">
<h3><strong>Italy</strong></h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Italy <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-10-1.png" width="768" /></p>
</div>
<div id="austria" class="section level3">
<h3><strong>Austria</strong></h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Austria <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-11-1.png" width="768" /></p>
</div>
<div id="lichtenstein" class="section level3">
<h3><strong>Lichtenstein</strong></h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Lichtenstein <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-12-1.png" width="768" /></p>
</div>
<div id="total" class="section level3">
<h3><strong>Total</strong></h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Total <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-13-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="model-selection" class="section level1">
<h1>Model Selection</h1>
<div id="methodology" class="section level2">
<h2>Methodology</h2>
<p>To evaluate the forecast accuracy, we will test how a model performs
on new data not used during the fitting phase. So, we split our data
into training and test set. The first one we will use to estimate any
parameters of the forecasting method, and the second - is to define the
model’s accuracy. We fit the training data to models selected (ARIMA,
ETS, SNAIVE) to forecast 60 following periods (in our case, months). We
refit our models with test data and calculate the accuracy of the
forecast. We select the model with the lowest accuracy metrics for
further forecast. Low metric values indicate the better predictive
performance of the model, with a value of 0 indicating a perfect fit
between the predicted and actual values. Residuals analysis is also
going to be plotted to see how well the model captures the dynamics of
the data. Good models’ residuals should be stationary (white noise) and
have no patterns.</p>
<p>We can see strong seasonality and trend in data from our
decomposition analysis, so we tested ARIMA, ETS, and Seasonal NAIVE
models as we assume these models can handle these types of data the
best.</p>
<p>Lichtenstein Analysis will be described separately.</p>
</div>
<div id="germany-1" class="section level2 tabset">
<h2 class="tabset">Germany</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Germany_since_2015 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date,Germany) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(<span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>)))</span></code></pre></div>
<div id="testing-models" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>training_ge <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Germany) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &lt; as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&lt;.vctrs_vctr&quot;, &quot;&lt;.Date&quot;) for &quot;&lt;&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>test_ge <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Germany) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>data_fit_ge_a <span class="ot">&lt;-</span> training_ge <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Germany))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>forecasts_ge_a <span class="ot">&lt;-</span> data_fit_ge_a <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>data_fit_ge_e <span class="ot">&lt;-</span> training_ge <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Germany))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>forecasts_ge_e <span class="ot">&lt;-</span> data_fit_ge_e <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>data_fit_ge_n <span class="ot">&lt;-</span> training_ge <span class="sc">%&gt;%</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Germany))</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>forecasts_ge_n <span class="ot">&lt;-</span> data_fit_ge_n <span class="sc">%&gt;%</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>all_forecasts_ge <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_ge_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_ge_a<span class="sc">$</span>.mean),</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_ge_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_ge_e<span class="sc">$</span>.mean),</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_ge_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_ge_n<span class="sc">$</span>.mean))</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Germany)  <span class="sc">+</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_ge, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Consumption in Germany&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-16-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table RMSE, MAE and other indicators, ARIMA
has the lowest values on the test data. The ARIMA model has an AIC of
2422.94, AICc of 2423.39, and BIC of 2442.49. On the other hand, the ETS
model has an AIC of 2975.557, AICc of 2978.110, and BIC of 3025.329.
These information criteria are used to assess the goodness of fit of a
model, with lower values indicating a better fit. Therefore, based on
these criteria, we can conclude that the ARIMA model fits the data
better than the ETS model.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>germany_accuracy_a <span class="ot">&lt;-</span>data_fit_ge_a <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_ge) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>germany_accuracy_e <span class="ot">&lt;-</span>data_fit_ge_e <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_ge) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>germany_accuracy_n <span class="ot">&lt;-</span>data_fit_ge_n <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_ge) <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>germany_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(germany_accuracy_a),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(germany_accuracy_e),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(germany_accuracy_n))</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>germany_accuracy_table</span></code></pre></div>
<pre><code>##            .model    .type          ME     RMSE      MAE        MPE     MAPE
## 1  ARIMA(Germany) Training   9.0270898 191.3758 120.9560  -6.177920 30.32461
## 2    ETS(Germany) Training -34.0600578 210.3173 130.9707  -9.946267 32.28047
## 3 SNAIVE(Germany) Training   0.5211268 329.2936 218.9718 -12.958205 52.08664
##        MASE     RMSSE      ACF1
## 1 0.5523815 0.5811706 0.4239149
## 2 0.5981166 0.6386924 0.5151985
## 3 1.0000000 1.0000000 0.6538549</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_ge_a)</span></code></pre></div>
<pre><code>## Series: Germany 
## Model: ARIMA(1,0,1)(2,1,1)[12] 
## 
## Coefficients:
##          ar1      ma1     sar1     sar2    sma1
##       0.7853  -0.2946  -0.8231  -0.4046  0.0965
## s.e.  0.0731   0.1106   0.1925   0.1247  0.2054
## 
## sigma^2 estimated as 15296:  log likelihood=-1124.06
## AIC=2260.11   AICc=2260.6   BIC=2279.27</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_ge_e)</span></code></pre></div>
<pre><code>## Series: Germany 
## Model: ETS(M,N,M) 
##   Smoothing parameters:
##     alpha = 0.3739358 
##     gamma = 0.3451097 
## 
##   Initial states:
##      l[0]      s[0]     s[-1]     s[-2]    s[-3]    s[-4]    s[-5]    s[-6]
##  653.4368 0.6246774 0.7255761 0.7347587 1.011001 1.387123 1.493534 1.469065
##     s[-7]     s[-8]    s[-9]    s[-10]    s[-11]
##  1.560156 0.7932617 0.864902 0.6433645 0.6925801
## 
##   sigma^2:  0.094
## 
##      AIC     AICc      BIC 
## 2797.057 2799.784 2845.919</code></pre>
</div>
<div id="residuals" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_ge_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Germany residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-18-1.png" width="768" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_ge_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Germany residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-18-2.png" width="768" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_ge_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Germany residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-18-3.png" width="768" /></p>
</div>
</div>
<div id="italy-1" class="section level2 tabset">
<h2 class="tabset">Italy</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Selecting Italy only since 2018 to better display the forecast. 2018 will both show the trend BEFORE covid + improve display </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>Italy_since_2018 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Italy) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2018-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2018-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div id="testing-models-1" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>training_it <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Italy) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &lt; as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&lt;.vctrs_vctr&quot;, &quot;&lt;.Date&quot;) for &quot;&lt;&quot;</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>test_it <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Italy) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>data_fit_it_a <span class="ot">&lt;-</span> training_it <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Italy)) </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>forecasts_it_a <span class="ot">&lt;-</span> data_fit_it_a <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>forecasts_it_a <span class="ot">&lt;-</span> data_fit_it_a <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>data_fit_it_e <span class="ot">&lt;-</span> training_it <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Italy))</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>forecasts_it_e <span class="ot">&lt;-</span> data_fit_it_e <span class="sc">%&gt;%</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>data_fit_it_n <span class="ot">&lt;-</span> training_it <span class="sc">%&gt;%</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Italy))</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>forecasts_it_n <span class="ot">&lt;-</span> data_fit_it_n <span class="sc">%&gt;%</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>all_forecasts_it <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_it_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_it_a<span class="sc">$</span>.mean),</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_it_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_it_e<span class="sc">$</span>.mean),</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_it_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_it_n<span class="sc">$</span>.mean))</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Italy) <span class="sc">+</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_it, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand in Italy&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-20-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-1" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table below, RMSE, MAE, and other
indicators, ETS has the lowest values on the test data. However, ARIMA
has lower values of AIC=2708.77, AICc=2709.1, and BIC=2725.06 than the
ETS model.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>italy_accuracy_a <span class="ot">&lt;-</span>data_fit_it_a <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_it) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>italy_accuracy_e <span class="ot">&lt;-</span>data_fit_it_e <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_it) <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>italy_accuracy_n <span class="ot">&lt;-</span>data_fit_it_n <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_it) <span class="sc">%&gt;%</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>italy_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(italy_accuracy_a),</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(italy_accuracy_e),</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(italy_accuracy_n))</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_it_a)</span></code></pre></div>
<pre><code>## Series: Italy 
## Model: ARIMA(1,0,0)(2,0,0)[12] w/ mean 
## 
## Coefficients:
##          ar1    sar1    sar2  constant
##       0.6369  0.3471  0.3479  227.4524
## s.e.  0.0565  0.0673  0.0717   16.0636
## 
## sigma^2 estimated as 73103:  log likelihood=-1349.39
## AIC=2708.77   AICc=2709.1   BIC=2725.06</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_it_e)</span></code></pre></div>
<pre><code>## Series: Italy 
## Model: ETS(A,N,A) 
##   Smoothing parameters:
##     alpha = 0.7893584 
##     gamma = 0.0001000066 
## 
##   Initial states:
##      l[0]     s[0]    s[-1]    s[-2]     s[-3]    s[-4]    s[-5]    s[-6]
##  2001.551 15.17983 90.59285 210.0609 -95.62885 -503.615 165.2749 -103.177
##      s[-7]     s[-8]    s[-9]   s[-10]   s[-11]
##  -101.2201 -20.17958 171.0857 59.06312 112.5631
## 
##   sigma^2:  71693.32
## 
##      AIC     AICc      BIC 
## 3171.492 3174.219 3220.354</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>italy_accuracy_table</span></code></pre></div>
<pre><code>##          .model    .type         ME     RMSE      MAE       MPE     MAPE
## 1  ARIMA(Italy) Training -48.053328 349.3088 284.5911 -7.772352 19.11066
## 2    ETS(Italy) Training  -2.494859 311.7141 241.4607 -2.802543 14.91659
## 3 SNAIVE(Italy) Training -12.436620 554.0566 432.4366 -7.043190 28.78426
##        MASE     RMSSE        ACF1
## 1 0.6581105 0.6304568 -0.03999788
## 2 0.5583725 0.5626034  0.03031226
## 3 1.0000000 1.0000000  0.53072915</code></pre>
</div>
<div id="residuals-1" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_it_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Italy residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-22-1.png" width="768" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_it_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Italy residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-22-2.png" width="768" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_it_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Italy residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-22-3.png" width="768" /></p>
</div>
</div>
<div id="austria-1" class="section level2 tabset">
<h2 class="tabset">Austria</h2>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Investigating Austria closely since 2018, because it seems like something changed -&gt; perhaps should use Piecewise!!!</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>Austria_since_2015 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Austria) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2015-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>Austria_since_2018 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Austria) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2018-02-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2018-02-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div id="testing-models-2" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>training_au <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Austria) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &lt; as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&lt;.vctrs_vctr&quot;, &quot;&lt;.Date&quot;) for &quot;&lt;&quot;</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>test_au <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Austria) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>data_fit_au_a <span class="ot">&lt;-</span> training_au <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Austria, <span class="at">stepwise =</span> <span class="cn">FALSE</span>))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>forecasts_au_a <span class="ot">&lt;-</span> data_fit_au_a <span class="sc">%&gt;%</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>data_fit_au_e <span class="ot">&lt;-</span> training_au <span class="sc">%&gt;%</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Austria))</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>forecasts_au_e <span class="ot">&lt;-</span> data_fit_au_e <span class="sc">%&gt;%</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>data_fit_au_n <span class="ot">&lt;-</span> training_au <span class="sc">%&gt;%</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Austria))</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>forecasts_au_n <span class="ot">&lt;-</span> data_fit_au_n <span class="sc">%&gt;%</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>all_forecasts_au <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_au_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_au_a<span class="sc">$</span>.mean),</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_au_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_au_e<span class="sc">$</span>.mean),</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_au_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_au_n<span class="sc">$</span>.mean))</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Austria) <span class="sc">+</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_au, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand in Austria&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-24-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-2" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table below, RMSE, MAE, and other
indicators, ETS has the lowest values on the test data. However, ARIMA
has lower values of AIC=1839.24, AICc=1840.03, and BIC=1865.3 than the
ETS model.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>austria_accuracy_a <span class="ot">&lt;-</span>data_fit_au_a <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_au) <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>austria_accuracy_e <span class="ot">&lt;-</span>data_fit_au_e <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_au) <span class="sc">%&gt;%</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>austria_accuracy_n <span class="ot">&lt;-</span>data_fit_au_n <span class="sc">%&gt;%</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_au) <span class="sc">%&gt;%</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>austria_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(austria_accuracy_a),</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(austria_accuracy_e),</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(austria_accuracy_n))</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_au_a)</span></code></pre></div>
<pre><code>## Series: Austria 
## Model: ARIMA(0,0,3)(2,0,1)[12] w/ mean 
## 
## Coefficients:
##          ma1     ma2     ma3    sar1    sar2     sma1  constant
##       0.5991  0.1591  0.1055  0.6072  0.0853  -0.3699    6.3202
## s.e.  0.0742  0.0814  0.0731  0.2940  0.1561   0.2850    2.1449
## 
## sigma^2 estimated as 796.7:  log likelihood=-911.62
## AIC=1839.24   AICc=1840.03   BIC=1865.3</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_au_e)</span></code></pre></div>
<pre><code>## Series: Austria 
## Model: ETS(A,N,A) 
##   Smoothing parameters:
##     alpha = 0.5246043 
##     gamma = 0.0001000228 
## 
##   Initial states:
##      l[0]      s[0]     s[-1]     s[-2]      s[-3]    s[-4]   s[-5]    s[-6]
##  39.20052 -12.84024 -7.616428 -8.086183 -0.9683645 43.50499 39.8389 2.189109
##      s[-7]     s[-8]     s[-9]    s[-10]    s[-11]
##  0.7038562 -11.55768 -14.38028 -16.43484 -14.35283
## 
##   sigma^2:  895.6703
## 
##      AIC     AICc      BIC 
## 2330.036 2332.764 2378.899</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>austria_accuracy_table</span></code></pre></div>
<pre><code>##                             .model    .type        ME     RMSE      MAE
## 1 ARIMA(Austria, stepwise = FALSE) Training 23.712075 58.28096 41.41573
## 2                     ETS(Austria) Training  1.957058 49.14910 35.08150
## 3                  SNAIVE(Austria) Training 10.760563 88.47408 67.54930
##         MPE      MAPE      MASE     RMSSE        ACF1
## 1 -18.68018  72.22767 0.6131186 0.6587349 -0.05024102
## 2 -66.98305 101.49245 0.5193467 0.5555198  0.04964282
## 3 -57.48300 118.72629 1.0000000 1.0000000  0.50380298</code></pre>
</div>
<div id="residuals-2" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_au_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Austria residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-26-1.png" width="768" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_au_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Austria residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-26-2.png" width="768" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_au_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Austria residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-26-3.png" width="768" /></p>
</div>
</div>
<div id="france-1" class="section level2 tabset">
<h2 class="tabset">France</h2>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>France_since_2015 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,France) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2015-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div id="testing-models-3" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>training_fr <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, France) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &lt; as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&lt;.vctrs_vctr&quot;, &quot;&lt;.Date&quot;) for &quot;&lt;&quot;</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>test_fr <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, France) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>data_fit_fr_a <span class="ot">&lt;-</span> training_fr <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(France))</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>forecasts_fr_a <span class="ot">&lt;-</span> data_fit_fr_a <span class="sc">%&gt;%</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>data_fit_fr_e <span class="ot">&lt;-</span> training_fr <span class="sc">%&gt;%</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(France))</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>forecasts_fr_e <span class="ot">&lt;-</span> data_fit_fr_e <span class="sc">%&gt;%</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>data_fit_fr_n <span class="ot">&lt;-</span> training_fr <span class="sc">%&gt;%</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(France))</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>forecasts_fr_n <span class="ot">&lt;-</span> data_fit_fr_n <span class="sc">%&gt;%</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>all_forecasts_fr <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_fr_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_fr_a<span class="sc">$</span>.mean),</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_fr_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_fr_e<span class="sc">$</span>.mean),</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_fr_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_fr_n<span class="sc">$</span>.mean))</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(France) <span class="sc">+</span></span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_fr, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand in France&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-28-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-3" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table below, RMSE, MAE, and other
indicators, ETS has the lowest values on the test data. However, ARIMA
has lower values of AIC = 2558.88, AICc = 2559.46, and BIC=2582.07 than
the ETS model.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>france_accuracy_a <span class="ot">&lt;-</span>data_fit_fr_a <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_fr) <span class="sc">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>france_accuracy_e <span class="ot">&lt;-</span>data_fit_fr_e <span class="sc">%&gt;%</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_fr) <span class="sc">%&gt;%</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>france_accuracy_n <span class="ot">&lt;-</span>data_fit_fr_n <span class="sc">%&gt;%</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_fr) <span class="sc">%&gt;%</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>france_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(france_accuracy_a),</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(france_accuracy_e),</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(france_accuracy_n))</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_fr_a)</span></code></pre></div>
<pre><code>## Series: France 
## Model: ARIMA(1,1,4)(0,0,1)[12] 
## 
## Coefficients:
##          ar1      ma1      ma2      ma3      ma4    sma1
##       0.0186  -0.4859  -0.1850  -0.0946  -0.1620  0.1771
## s.e.  0.4208   0.4161   0.2162   0.1137   0.1172  0.0764
## 
## sigma^2 estimated as 15135:  log likelihood=-1188.05
## AIC=2390.09   AICc=2390.7   BIC=2412.86</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>france_accuracy_table</span></code></pre></div>
<pre><code>##           .model    .type         ME     RMSE      MAE       MPE     MAPE
## 1  ARIMA(France) Training  0.4465108 208.4824 169.0814 -30.99631 59.28774
## 2    ETS(France) Training -7.7226182 181.6390 146.1496 -30.05412 53.91812
## 3 SNAIVE(France) Training -7.8450704 273.8479 216.0141 -35.68783 76.53401
##        MASE     RMSSE        ACF1
## 1 0.7827331 0.7613072 -0.07489327
## 2 0.6765742 0.6632845  0.14238978
## 3 1.0000000 1.0000000  0.14446626</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_fr_e)</span></code></pre></div>
<pre><code>## Series: France 
## Model: ETS(M,N,M) 
##   Smoothing parameters:
##     alpha = 0.1672851 
##     gamma = 0.0001002813 
## 
##   Initial states:
##     l[0]     s[0]     s[-1]    s[-2]   s[-3]   s[-4]    s[-5]     s[-6]
##  170.609 1.250038 0.9416617 1.095887 1.04379 1.14645 1.291704 0.9937027
##      s[-7]     s[-8]     s[-9]  s[-10]   s[-11]
##  0.6362197 0.6065504 0.7543347 1.13727 1.102391
## 
##   sigma^2:  0.2439
## 
##      AIC     AICc      BIC 
## 2844.032 2846.759 2892.894</code></pre>
</div>
<div id="residuals-3" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_fr_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA France residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-30-1.png" width="768" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_fr_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS France residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-30-2.png" width="768" /></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_fr_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE France residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-30-3.png" width="768" /></p>
</div>
</div>
<div id="lichtenstein-1" class="section level2">
<h2>Lichtenstein</h2>
<ul>
<li>ETS creates a negative value forecast, I will just set the negative
forecast values to 0.</li>
<li>Maybe should find a better way to use ETS (by not allowing it to
drop below 0) or just use other models</li>
</ul>
<p>We have selected S-naive,S-ARIMA In general, S-ARIMA is more suitable
for complex time series with trends, seasonality, and other patterns,
while S-naive is simpler and more appropriate for time series with
stable and predictable seasonal patterns.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Lichtenstein) <span class="sc">+</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Exports from Switzerland to Lichtenstein&quot;</span>) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-31-1.png" width="768" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Investigating Lichtenstein closely before 2008</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>Lichtenstein_before_2008 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date,Lichtenstein) <span class="sc">%&gt;%</span> </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2008-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &lt;= as.Date(&quot;2008-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&lt;=.vctrs_vctr&quot;, &quot;&lt;=.Date&quot;) for &quot;&lt;=&quot;</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(Lichtenstein_before_2008)</span></code></pre></div>
<pre><code>## Plot variable not specified, automatically selected `.vars = Lichtenstein`</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-32-1.png" width="768" /></p>
<div class="sourceCode" id="cb101"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Investigating Lichtenstein closely after 2008</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>Lichtenstein_after_2008 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date,Lichtenstein) <span class="sc">%&gt;%</span> </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2008-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2008-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(Lichtenstein_after_2008)</span></code></pre></div>
<pre><code>## Plot variable not specified, automatically selected `.vars = Lichtenstein`</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-32-2.png" width="768" />
<strong>Comment</strong></p>
<div id="check-the-stationarity-by-using-unit-root-test"
class="section level3">
<h3>Check the Stationarity by using Unit Root Test</h3>
<div class="sourceCode" id="cb105"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the required package</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the data into a time series object</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>Lichtenstein_since_2010 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Lichtenstein) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2010-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2010-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>ts_Lich <span class="ot">&lt;-</span> <span class="fu">ts</span>(Lichtenstein_since_2010<span class="sc">$</span>Lichtenstein, <span class="at">frequency=</span><span class="dv">12</span>, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">2010</span>,<span class="dv">1</span>))</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for linearity using ADF test</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(ts_Lich)</span></code></pre></div>
<pre><code>## Warning in adf.test(ts_Lich): p-value smaller than printed p-value</code></pre>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  ts_Lich
## Dickey-Fuller = -6.5052, Lag order = 5, p-value = 0.01
## alternative hypothesis: stationary</code></pre>
<div class="sourceCode" id="cb112"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>Lichtenstein_since_2010 <span class="sc">%&gt;%</span> <span class="fu">features</span>(Lichtenstein_since_2010, unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   kpss_stat kpss_pvalue
##       &lt;dbl&gt;       &lt;dbl&gt;
## 1      3.20        0.01</code></pre>
<p>In order to observe the stationarity assumption of Lichtenstein time
serie. We have run the Unit Root Test which is a statistical test that
checks for the presence of a unit root in a time series, which is an
indication of non-stationarity.</p>
<p>Unit Root Test has the following hypothesis: <span
class="math display">\[H_0:\]</span> Data is stationary</p>
<p><span class="math display">\[H_a:\]</span> Data is non-stationary</p>
<p>In this case the Unit Root Test was performed on a the data
Lichtenstein, and the test statistic was 3.20. The p-value of the test
was 0.01 which indicates strong evidence to reject the null hypothesis
of stationarity. Thus Lichtenstein time serie is non-stationary.</p>
<p>Based on it, we can use methods that assume non-stationarity, such as
Random Walk Model, Autoregressive Integrated Moving Average (ARIMA),
Exponential smoothing methods, Moving average models, Vector
autoregression(VAR), ARIMA,SARIMA.</p>
</div>
<div id="model-selection-1" class="section level3">
<h3>Model selection</h3>
<p>Based on the previous analysis Lichtenstein data is stationary time
series with high presence of trend and seasonality, thus we can consider
using a simple ARIMA, Piece-Wise and . S-naive.</p>
<div class="sourceCode" id="cb114"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>training_Licht <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Lichtenstein) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &lt; as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&lt;.vctrs_vctr&quot;, &quot;&lt;.Date&quot;) for &quot;&lt;&quot;</code></pre>
<div class="sourceCode" id="cb116"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>test_Licht <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Lichtenstein) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb118"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>data_fit_Licht_a <span class="ot">&lt;-</span> training_Licht <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Lichtenstein))</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>forecasts_Licht_a <span class="ot">&lt;-</span> data_fit_Licht_a <span class="sc">%&gt;%</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>data_fit_Licht_e <span class="ot">&lt;-</span> training_Licht <span class="sc">%&gt;%</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Lichtenstein))</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>forecasts_Licht_e <span class="ot">&lt;-</span> data_fit_Licht_e <span class="sc">%&gt;%</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>data_fit_Licht_n <span class="ot">&lt;-</span> training_Licht <span class="sc">%&gt;%</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Lichtenstein))</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>forecasts_Licht_n <span class="ot">&lt;-</span> data_fit_Licht_n <span class="sc">%&gt;%</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit piece wise model and generate forecasts</span></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>data_fit_Licht_pw <span class="ot">&lt;-</span> training_Licht <span class="sc">%&gt;%</span></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">piecewise =</span> <span class="fu">ARIMA</span>(Lichtenstein <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">knots =</span> <span class="fu">c</span>(<span class="dv">2008</span>, <span class="dv">2009</span>,<span class="dv">2015</span>,<span class="dv">2016</span>))))</span></code></pre></div>
<pre><code>## Warning: Provided exogenous regressors are rank deficient, removing regressors:
## `trend(knots = c(2008, 2009, 2015, 2016))trend_1649`, `trend(knots = c(2008,
## 2009, 2015, 2016))trend_1650`, `trend(knots = c(2008, 2009, 2015,
## 2016))trend_1656`, `trend(knots = c(2008, 2009, 2015, 2016))trend_1657`</code></pre>
<div class="sourceCode" id="cb120"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>forecasts_Licht_pw <span class="ot">&lt;-</span> data_fit_Licht_pw<span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>all_forecasts_Licht <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_Licht_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_Licht_a<span class="sc">$</span>.mean),</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_Licht_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_Licht_e<span class="sc">$</span>.mean),</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_Licht_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_Licht_n<span class="sc">$</span>.mean),</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_Licht_pw<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;PIECE WISE&quot;</span>, <span class="at">Forecast =</span> forecasts_Licht_pw<span class="sc">$</span>.mean))</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Lichtenstein) <span class="sc">+</span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_Licht, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand in Lichtenstein&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-35-1.png" width="768" />
###Observing the accuracy</p>
<div class="sourceCode" id="cb121"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>Licht_accuracy_a <span class="ot">&lt;-</span>data_fit_Licht_a <span class="sc">%&gt;%</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_Licht) <span class="sc">%&gt;%</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>Licht_accuracy_e <span class="ot">&lt;-</span>data_fit_Licht_e <span class="sc">%&gt;%</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_Licht) <span class="sc">%&gt;%</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>Licht_accuracy_n <span class="ot">&lt;-</span>data_fit_Licht_n <span class="sc">%&gt;%</span></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_Licht) <span class="sc">%&gt;%</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>Licht_accuracy_pw <span class="ot">&lt;-</span> data_fit_Licht_pw <span class="sc">%&gt;%</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_Licht) <span class="sc">%&gt;%</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `piecewise = (function (object, ...) ...`.
## Caused by warning:
## ! Provided exogenous regressors are rank deficient, removing regressors: `trend(knots = c(2008, 2009, 2015, 2016))trend_1649`, `trend(knots = c(2008, 2009, 2015, 2016))trend_1650`, `trend(knots = c(2008, 2009, 2015, 2016))trend_1656`, `trend(knots = c(2008, 2009, 2015, 2016))trend_1657`</code></pre>
<div class="sourceCode" id="cb123"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>Licht_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(Licht_accuracy_a),</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(Licht_accuracy_e),</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(Licht_accuracy_n),</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(Licht_accuracy_pw))</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>Licht_accuracy_table</span></code></pre></div>
<pre><code>##                 .model    .type          ME     RMSE      MAE  MPE MAPE
## 1  ARIMA(Lichtenstein) Training -0.11762505 3.344647 2.033608  NaN  Inf
## 2    ETS(Lichtenstein) Training -0.02173764 2.888300 1.755176  NaN  Inf
## 3 SNAIVE(Lichtenstein) Training -0.15492958 4.613208 2.014085 -Inf  Inf
## 4            piecewise Training  0.41939646 3.334844 2.043512  NaN  Inf
##        MASE     RMSSE      ACF1
## 1 1.0096936 0.7250153 0.1688491
## 2 0.8714512 0.6260936 0.2283578
## 3 1.0000000 1.0000000 0.4554619
## 4 1.0146109 0.7228904 0.1917471</code></pre>
<div class="sourceCode" id="cb125"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_Licht_a)</span></code></pre></div>
<pre><code>## Series: Lichtenstein 
## Model: ARIMA(1,1,2)(0,0,2)[12] 
## 
## Coefficients:
##          ar1      ma1     ma2    sma1    sma2
##       0.7733  -1.0998  0.1674  0.2296  0.2115
## s.e.  0.1341   0.1552  0.1085  0.0746  0.0752
## 
## sigma^2 estimated as 13.09:  log likelihood=-514.99
## AIC=1041.98   AICc=1042.44   BIC=1061.5</code></pre>
<div class="sourceCode" id="cb127"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_Licht_e)</span></code></pre></div>
<pre><code>## Series: Lichtenstein 
## Model: ETS(A,N,A) 
##   Smoothing parameters:
##     alpha = 0.4983791 
##     gamma = 0.0001000103 
## 
##   Initial states:
##     l[0]     s[0]    s[-1]    s[-2]     s[-3]     s[-4]     s[-5]     s[-6]
##  19.2404 2.656075 3.881139 1.299069 -1.182925 -2.807692 -3.167366 -4.389907
##      s[-7]     s[-8]    s[-9]   s[-10]  s[-11]
##  -3.179325 -1.468588 2.114574 2.867806 3.37714
## 
##   sigma^2:  11.0411
## 
##      AIC     AICc      BIC 
## 1486.015 1488.742 1534.878</code></pre>
<div class="sourceCode" id="cb129"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_Licht_n)</span></code></pre></div>
<pre><code>## Series: Lichtenstein 
## Model: SNAIVE 
## 
## sigma^2: 38.3321</code></pre>
<div class="sourceCode" id="cb131"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_Licht_pw)</span></code></pre></div>
<pre><code>## Series: Lichtenstein 
## Model: LM w/ ARIMA(1,0,1)(2,0,0)[12] errors 
## 
## Coefficients:
##          ar1      ma1    sar1    sar2
##       0.8984  -0.2993  0.2682  0.2445
## s.e.  0.0370   0.0897  0.0711  0.0801
##       trend(knots = c(2008, 2009, 2015, 2016))trend  intercept
##                                             -0.1089    24.4159
## s.e.                                         0.0444     5.3267
## 
## sigma^2 estimated as 12.37:  log likelihood=-513.02
## AIC=1040.04   AICc=1040.65   BIC=1062.84</code></pre>
<p>A low AIC value is desirable as it indicates a better trade-off
between model fit and complexity. Thus</p>
</div>
<div id="residuals-4" class="section level3">
<h3>Residuals</h3>
<p>Interesting to examine any outliers or extreme values in the
residuals.</p>
<div class="sourceCode" id="cb133"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_Licht_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Lichtenstein residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-37-1.png" width="768" /></p>
<div class="sourceCode" id="cb134"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_Licht_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Lichtenstein residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-37-2.png" width="768" /></p>
<div class="sourceCode" id="cb135"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_Licht_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Lichtenstein residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-37-3.png" width="768" /></p>
<div class="sourceCode" id="cb139"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_Licht_pw) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;PIECE WISE Lichtenstein residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-37-4.png" width="768" /></p>
<p>Although all of these metrics are valuable for evaluating forecast
accuracy, we have chosen to place greater emphasis on the AIC. This
decision is based on the fact that the AIC takes into account both the
model’s fit to the data and its complexity. Consequently, we have
selected the Piecewise model as the preferred choice for forecasting
electricity demand in Lichtenstein</p>
</div>
<div id="piecewise" class="section level3">
<h3>Piecewise</h3>
<div class="sourceCode" id="cb140"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling ARIMA automatically</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>pw_Licht <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Lichtenstein) <span class="sc">%&gt;%</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">piecewise =</span> <span class="fu">ARIMA</span>(Lichtenstein <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">knots =</span> <span class="fu">c</span>(<span class="dv">2008</span>, <span class="dv">2009</span>,<span class="dv">2015</span>,<span class="dv">2016</span>))))</span></code></pre></div>
<pre><code>## Warning: Provided exogenous regressors are rank deficient, removing regressors:
## `trend(knots = c(2008, 2009, 2015, 2016))trend_1649`, `trend(knots = c(2008,
## 2009, 2015, 2016))trend_1650`, `trend(knots = c(2008, 2009, 2015,
## 2016))trend_1656`, `trend(knots = c(2008, 2009, 2015, 2016))trend_1657`</code></pre>
<div class="sourceCode" id="cb142"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the Accuracy scores for models</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(pw_Licht)</span></code></pre></div>
<pre><code>## Series: Lichtenstein 
## Model: LM w/ ARIMA(1,0,2)(2,0,0)[12] errors 
## 
## Coefficients:
##          ar1      ma1      ma2    sar1    sar2
##       0.9166  -0.2686  -0.1848  0.2716  0.2005
## s.e.  0.0377   0.0789   0.0775  0.0593  0.0596
##       trend(knots = c(2008, 2009, 2015, 2016))trend  intercept
##                                             -0.0853    22.8736
## s.e.                                         0.0252     4.2039
## 
## sigma^2 estimated as 11.95:  log likelihood=-729.65
## AIC=1475.3   AICc=1475.84   BIC=1504.23</code></pre>
<div class="sourceCode" id="cb144"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>forecast_pw_Licht <span class="ot">&lt;-</span> pw_Licht <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the residuals before forecasting</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>pw_Licht <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;piecewise Lichtenstein residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-38-1.png" width="768" /></p>
<div class="sourceCode" id="cb145"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphing the forecast</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>pw_Licht <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Lichtenstein_after_2008) <span class="sc">+</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;piecewise Forecast for Lichtenstein&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-38-2.png" width="768" /></p>
<div class="sourceCode" id="cb146"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>forecast_table_Lichtenstein_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;piecewise&quot;</span>),</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_pw_Licht))</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>forecast_table_Lichtenstein_a <span class="ot">&lt;-</span> forecast_table_Lichtenstein_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values..mean)</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_Lichtenstein_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Lichtenstein_piecewise&quot;</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>forecast_table_Lichtenstein_a</span></code></pre></div>
<pre><code>##    Lichtenstein_piecewise
## 1               4.0432363
## 2               3.5136346
## 3               2.9764597
## 4               1.8325656
## 5              -0.3778268
## 6              -0.4930856
## 7              -0.6024843
## 8              -0.7065121
## 9              -0.8056170
## 10             -0.9002097
## 11             -0.5897297
## 12              1.6128127
## 13              1.5413636</code></pre>
<div class="sourceCode" id="cb148"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #install.packages(&quot;forecast&quot;)</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(forecast)</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Fit an ARIMA model to the data</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co"># arima_model &lt;- auto.arima(Lichtenstein)</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Forecast future values</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast_data &lt;- forecast(arima_model, h = 12)  # Forecasting for 12 months ahead</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Apply post-processing to enforce the constraint</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast_values &lt;- forecast_data$mean</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast_values[forecast_values &lt; 0] &lt;- 0</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the forecasted values</span></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a><span class="co"># print(forecast_values)</span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="co"># autoplot(forecast_values)</span></span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">###</span><span class="co"> Piece-wise ARIMA</span></span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(Lichtenstein_after_2008, aes(x = Date, y = Lichtenstein)) + geom_line() + geom_smooth(method = &quot;lm&quot;, se = FALSE)</span></span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a><span class="co"># #TS for Lin</span></span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_trends_lin &lt;- Lichtenstein_after_2008 %&gt;% model(linear = TSLM(Lichtenstein ~ trend())) %&gt;% forecast(h=60)</span></span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_trends_lin_values &lt;- fit_trends_lin$.mean</span></span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_trends_lin_values[fit_trends_lin_values &lt; 0] &lt;- 0</span></span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a><span class="co"># print(fit_trends_lin_values)</span></span>
<span id="cb148-28"><a href="#cb148-28" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-29"><a href="#cb148-29" aria-hidden="true" tabindex="-1"></a><span class="co"># #TS for Expo</span></span>
<span id="cb148-30"><a href="#cb148-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-31"><a href="#cb148-31" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_trends_ex &lt;- Lichtenstein_after_2008 %&gt;% model(exponential = TSLM(log(Lichtenstein) ~ trend())) %&gt;% forecast(h=60)</span></span>
<span id="cb148-32"><a href="#cb148-32" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_trends_ex_values &lt;- fit_trends_ex$.mean</span></span>
<span id="cb148-33"><a href="#cb148-33" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_trends_ex_values[fit_trends_ex_values &lt; 0] &lt;- 0</span></span>
<span id="cb148-34"><a href="#cb148-34" aria-hidden="true" tabindex="-1"></a><span class="co"># print(fit_trends_ex_values)</span></span>
<span id="cb148-35"><a href="#cb148-35" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-36"><a href="#cb148-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-37"><a href="#cb148-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-38"><a href="#cb148-38" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_trends_piecewise &lt;- Lichtenstein_after_2008 %&gt;% model(piecewise = TSLM(Lichtenstein ~ trend(knots = c(2008)))</span></span>
<span id="cb148-39"><a href="#cb148-39" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   )</span></span>
<span id="cb148-40"><a href="#cb148-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-41"><a href="#cb148-41" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-42"><a href="#cb148-42" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_trends &lt;- data_elec %&gt;% model(#linear = TSLM(Lichtenstein ~ trend()), </span></span>
<span id="cb148-43"><a href="#cb148-43" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  # exponential = TSLM(log(Lichtenstein) ~ trend()),</span></span>
<span id="cb148-44"><a href="#cb148-44" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   piecewise = TSLM(Lichtenstein ~ trend(knots = c(2008,2009)))</span></span>
<span id="cb148-45"><a href="#cb148-45" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   )</span></span>
<span id="cb148-46"><a href="#cb148-46" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-47"><a href="#cb148-47" aria-hidden="true" tabindex="-1"></a><span class="co"># fc_trends &lt;- fit_trends %&gt;% forecast(h=13)</span></span>
<span id="cb148-48"><a href="#cb148-48" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-49"><a href="#cb148-49" aria-hidden="true" tabindex="-1"></a><span class="co"># autoplot(fc_trends)</span></span>
<span id="cb148-50"><a href="#cb148-50" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-51"><a href="#cb148-51" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-52"><a href="#cb148-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Lichtenstein_after_2008 %&gt;%</span></span>
<span id="cb148-53"><a href="#cb148-53" aria-hidden="true" tabindex="-1"></a><span class="co"># autoplot(Lichtenstein) + geom_line(aes(y=.fitted, colour=.model), data = fitted(fit_trends)) + autolayer(fc_trends, alpha = 0.5, level = 95) +</span></span>
<span id="cb148-54"><a href="#cb148-54" aria-hidden="true" tabindex="-1"></a><span class="co"># ylab(&quot;Electricity Consumptions&quot;) +</span></span>
<span id="cb148-55"><a href="#cb148-55" aria-hidden="true" tabindex="-1"></a><span class="co"># guides(colour = guide_legend(title = &quot;Model&quot;))</span></span></code></pre></div>
<div class="sourceCode" id="cb149"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co"># #Split the data</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co"># training_lich &lt;- Lichtenstein_after_2008 %&gt;% select(Date,Lichtenstein) %&gt;%  filter(Date &lt; as.Date(&quot;2015-01-01&quot;))</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="co"># test_lich &lt;- Lichtenstein_after_2008 %&gt;% select(Date,Lichtenstein) %&gt;% filter(Date &gt;= as.Date(&quot;2015-01-01&quot;))</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Fit ARIMA model and generate forecasts</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="co"># data_fit_lich_arima &lt;- training_lich %&gt;%</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   model(ARIMA(Lichtenstein))</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="co"># forecasts_lich_arima &lt;- data_fit_lich_arima %&gt;%</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   forecast(h = 140)</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # Fit seasonal naive model and generate forecasts</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a><span class="co"># data_fit_lich_naive &lt;- training_lich %&gt;%</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   model(SNAIVE(Lichtenstein))</span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a><span class="co"># forecasts_Lich_naive &lt;- data_fit_lich_naive %&gt;%</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   forecast(h = 140)</span></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a><span class="co"># # Fit seasonal naive model and generate forecasts</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a><span class="co"># data_fit_lich_TSLM &lt;- training_lich %&gt;%</span></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   model(TSLM(Lichtenstein))</span></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a><span class="co"># forecasts_Lich_TSLM &lt;- data_fit_lich_TSLM %&gt;%</span></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   forecast(h = 140)</span></span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a><span class="co"># # Fit seasonal naive model and generate forecasts</span></span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a><span class="co"># data_fit_lich_ets&lt;- training_lich %&gt;%</span></span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   model(ets(Lichtenstein))</span></span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a><span class="co"># forecasts_Lich_ets &lt;- data_fit_lich_ets %&gt;%</span></span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   forecast(h = 13)</span></span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a><span class="co"># ets_lichtenstein &lt;- data_elec %&gt;%model(ETS(Lichtenstein)) </span></span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a><span class="co"># report(ets_lichtenstein)</span></span>
<span id="cb149-32"><a href="#cb149-32" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast_ets_lichtenstein&lt;- ets_lichtenstein %&gt;% forecast(h = 13)</span></span>
<span id="cb149-33"><a href="#cb149-33" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb149-34"><a href="#cb149-34" aria-hidden="true" tabindex="-1"></a><span class="co"># ets_lichtenstein %&gt;% forecast(h = 13) %&gt;% autoplot(Lichtenstein_since_2010)+</span></span>
<span id="cb149-35"><a href="#cb149-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = &quot;ETS ANA Forecast for Lichtenstein&quot;)</span></span>
<span id="cb149-36"><a href="#cb149-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb149-37"><a href="#cb149-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb149-38"><a href="#cb149-38" aria-hidden="true" tabindex="-1"></a><span class="co"># # Combine forecasts into a single data frame</span></span>
<span id="cb149-39"><a href="#cb149-39" aria-hidden="true" tabindex="-1"></a><span class="co"># all_forecasts_Lich &lt;- bind_rows(</span></span>
<span id="cb149-40"><a href="#cb149-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame(Date = forecasts_lich_arima$Date, Method = &quot;ARIMA&quot;, Forecast = forecasts_lich_arima$.mean),</span></span>
<span id="cb149-41"><a href="#cb149-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame(Date = forecasts_Lich_naive$Date, Method = &quot;SNAIVE&quot;, Forecast = forecasts_Lich_naive$.mean),</span></span>
<span id="cb149-42"><a href="#cb149-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   data.frame(Date = forecasts_Lich_TSLM$Date, Method = &quot;Price wise&quot;, Forecast = forecasts_Lich_TSLM$.mean)</span></span>
<span id="cb149-43"><a href="#cb149-43" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb149-44"><a href="#cb149-44" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb149-45"><a href="#cb149-45" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot all three sets of forecasts together</span></span></code></pre></div>
</div>
<div id="arima-model" class="section level3">
<h3>ARIMA model</h3>
</div>
<div id="ets-model-thank-you-but-not-usefull-anymore"
class="section level3">
<h3>ETS Model (thank you but not usefull anymore)</h3>
<div class="sourceCode" id="cb150"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #Investigating Lichtenstein closely since 2010, because it seems like something changed -&gt; perhaps should use Piecewise!!!</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co"># autoplot(Lichtenstein_since_2010)</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #Modelling ets automatically</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_trends &lt;- data_elec %&gt;% model(linear = TSLM(Lichtenstein ~ trend()), </span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   exponential = TSLM(log(Lichtenstein) ~ trend()),</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   piecewise = TSLM(Lichtenstein ~ trend(knots = c(2005, 2015)))</span></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   )</span></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="co"># linear_lichtenstein &lt;- data_elec %&gt;%</span></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(Lichtenstein) %&gt;%</span></span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   model(TSLM(Lichtenstein))</span></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a><span class="co"># #Getting the Accuracy scores for models</span></span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a><span class="co"># report(linear_lichtenstein)</span></span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a><span class="co"># #Forecasting using the models</span></span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast_linear_lichtenstein&lt;- linear_lichtenstein %&gt;% forecast(h = 13)</span></span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a><span class="co"># #Graphing the forecast</span></span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a><span class="co"># linear_lichtenstein %&gt;% forecast(h = 13) %&gt;% autoplot(Lichtenstein)</span></span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a><span class="co"># #Extracting the forecasted values</span></span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast_table_lichtenstein &lt;- data.frame(Model = c(&quot;ETS (ANA)&quot;),</span></span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a><span class="co">#                               Forecast_Values = c(forecast_ets_lichtenstein))</span></span>
<span id="cb150-29"><a href="#cb150-29" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-30"><a href="#cb150-30" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast_table_lichtenstein &lt;- forecast_table_lichtenstein %&gt;% select(Forecast_Values..mean)</span></span>
<span id="cb150-31"><a href="#cb150-31" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-32"><a href="#cb150-32" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(forecast_table_lichtenstein)[1] &lt;- &quot;Lichtenstein_ets_ANA&quot;</span></span>
<span id="cb150-33"><a href="#cb150-33" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-34"><a href="#cb150-34" aria-hidden="true" tabindex="-1"></a><span class="co"># # replace negative values with 0</span></span>
<span id="cb150-35"><a href="#cb150-35" aria-hidden="true" tabindex="-1"></a><span class="co"># forecast_table_lichtenstein[forecast_table_lichtenstein &lt; 0] &lt;- 0</span></span>
<span id="cb150-36"><a href="#cb150-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-37"><a href="#cb150-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb150-38"><a href="#cb150-38" aria-hidden="true" tabindex="-1"></a><span class="co"># #components(ets_lichtenstein) %&gt;% autoplot()</span></span></code></pre></div>
<p>Since we can’t have negative values, I decided to just set the
negative ones to 0.</p>
<p>This forecast actually doesn’t look great. I would expect the next
upward bounce to be of similar amplitude as the previous ones, but it
seems like the forecast of the next bounce is only half the amplitude of
the previous ones.</p>
</div>
</div>
<div id="total-1" class="section level2 tabset">
<h2 class="tabset">Total</h2>
<div class="sourceCode" id="cb151"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>Total_since_2015 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Total) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2015-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div id="testing-models-4" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb153"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>training_tot <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Total) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &lt; as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&lt;.vctrs_vctr&quot;, &quot;&lt;.Date&quot;) for &quot;&lt;&quot;</code></pre>
<div class="sourceCode" id="cb155"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>test_tot <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Total) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `filter()`.
## ℹ In argument: `Date &gt;= as.Date(&quot;2016-01-01&quot;)`.
## Caused by warning:
## ! Incompatible methods (&quot;&gt;=.vctrs_vctr&quot;, &quot;&gt;=.Date&quot;) for &quot;&gt;=&quot;</code></pre>
<div class="sourceCode" id="cb157"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>data_fit_tot_a <span class="ot">&lt;-</span> training_tot <span class="sc">%&gt;%</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Total))</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>forecasts_tot_a <span class="ot">&lt;-</span> data_fit_tot_a <span class="sc">%&gt;%</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>data_fit_tot_e <span class="ot">&lt;-</span> training_tot <span class="sc">%&gt;%</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Total))</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>forecasts_tot_e <span class="ot">&lt;-</span> data_fit_tot_e <span class="sc">%&gt;%</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a>data_fit_tot_n <span class="ot">&lt;-</span> training_tot <span class="sc">%&gt;%</span></span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Total))</span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a>forecasts_tot_n <span class="ot">&lt;-</span> data_fit_tot_n <span class="sc">%&gt;%</span></span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a>all_forecasts_tot <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_tot_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_tot_a<span class="sc">$</span>.mean),</span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_tot_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_tot_e<span class="sc">$</span>.mean),</span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_tot_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_tot_n<span class="sc">$</span>.mean))</span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-25"><a href="#cb157-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-26"><a href="#cb157-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb157-27"><a href="#cb157-27" aria-hidden="true" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Total) <span class="sc">+</span></span>
<span id="cb157-28"><a href="#cb157-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_tot, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb157-29"><a href="#cb157-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand to all countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-43-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-4" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table below, RMSE, MAE, and other
indicators, ETS has the lowest values on the test data. However, ARIMA
has lower values of AIC=2683.45, AICc=2683.9, and BIC=2702.99 than the
ETS model.</p>
<div class="sourceCode" id="cb158"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>total_accuracy_a <span class="ot">&lt;-</span>data_fit_tot_a <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_tot) <span class="sc">%&gt;%</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>total_accuracy_e <span class="ot">&lt;-</span>data_fit_tot_e <span class="sc">%&gt;%</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_tot) <span class="sc">%&gt;%</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>total_accuracy_n <span class="ot">&lt;-</span>data_fit_tot_n <span class="sc">%&gt;%</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">refit</span>(test_tot) <span class="sc">%&gt;%</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">accuracy</span>()</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>total_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(total_accuracy_a),</span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(total_accuracy_e),</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(total_accuracy_n))</span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_tot_a)</span></code></pre></div>
<pre><code>## Series: Total 
## Model: ARIMA(1,0,1)(2,0,0)[12] w/ mean 
## 
## Coefficients:
##          ar1      ma1    sar1    sar2  constant
##       0.7159  -0.2076  0.3750  0.3755  195.5746
## s.e.  0.0912   0.1344  0.0685  0.0708   11.2588
## 
## sigma^2 estimated as 63131:  log likelihood=-1335.72
## AIC=2683.45   AICc=2683.9   BIC=2702.99</code></pre>
<div class="sourceCode" id="cb160"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>total_accuracy_table</span></code></pre></div>
<pre><code>##          .model    .type         ME     RMSE      MAE       MPE      MAPE
## 1  ARIMA(Total) Training -24.755873 330.0999 265.2221 -2.475478 10.561219
## 2    ETS(Total) Training  -4.567152 284.6104 226.3630 -1.089216  8.842026
## 3 SNAIVE(Total) Training  -9.154930 538.1098 433.9155 -2.272180 16.742385
##        MASE     RMSSE         ACF1
## 1 0.6112298 0.6134435 -0.032412752
## 2 0.5216754 0.5289076  0.009325172
## 3 1.0000000 1.0000000  0.555685440</code></pre>
<div class="sourceCode" id="cb162"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(data_fit_tot_e)</span></code></pre></div>
<pre><code>## Series: Total 
## Model: ETS(A,N,A) 
##   Smoothing parameters:
##     alpha = 0.5690082 
##     gamma = 0.0002217215 
## 
##   Initial states:
##      l[0]     s[0]     s[-1]    s[-2]     s[-3]     s[-4]    s[-5]    s[-6]
##  2735.222 -30.5261 -39.40677 146.1547 -77.94267 -290.9088 509.1663 81.12738
##     s[-7]     s[-8]     s[-9]   s[-10]    s[-11]
##  83.81698 -205.6554 -47.17994 -126.659 -1.986777
## 
##   sigma^2:  60986.36
## 
##      AIC     AICc      BIC 
## 3140.436 3143.164 3189.299</code></pre>
</div>
<div id="residuals-5" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb164"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_tot_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Total residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-45-1.png" width="768" /></p>
<div class="sourceCode" id="cb165"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_tot_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Total residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-45-2.png" width="768" /></p>
<div class="sourceCode" id="cb166"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_tot_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Total residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-45-3.png" width="768" /></p>
</div>
</div>
<div id="result" class="section level2">
<h2>Result</h2>
<p>All of these metrics are important for evaluating forecast accuracy.
Still, we decided to give more weight to AIC, as this indicator
considers both the complexity and the model’s fit. As a result, the
ARIMA model is selected to forecast the electricity demand in Germany,
Italy, Austria, France, and for all countries together.</p>
</div>
</div>
<div id="forecast" class="section level1">
<h1>Forecast</h1>
<div id="germany-2" class="section level2 tabset">
<h2 class="tabset">Germany</h2>
<div class="sourceCode" id="cb170"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling ARIMA automatically</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>arima_germany <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Germany) <span class="sc">%&gt;%</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">arima =</span> <span class="fu">ARIMA</span>(Germany))</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>forecast_arima_germany <span class="ot">&lt;-</span> arima_germany <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>, <span class="at">level =</span> <span class="dv">90</span>)</span></code></pre></div>
<div id="checking-residuals" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<div class="sourceCode" id="cb171"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>arima_germany <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SARIMA Germany residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-47-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<div class="sourceCode" id="cb172"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>arima_germany <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Germany_since_2015) <span class="sc">+</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Forecast for Germany&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-48-1.png" width="768" /></p>
<div class="sourceCode" id="cb173"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>forecast_table_germany_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ARIMA&quot;</span>),</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_arima_germany))</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>forecast_table_germany_a <span class="ot">&lt;-</span> forecast_table_germany_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values.Date,Forecast_Values..mean)</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_germany_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span></span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_germany_a)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Germany ARIMA&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<div class="sourceCode" id="cb174"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>forecast_table_germany_a</span></code></pre></div>
<pre><code>##       Month Germany ARIMA
## 1  2022 Dec      143.2646
## 2  2023 Jan      159.3608
## 3  2023 Feb      135.3621
## 4  2023 Mar      190.7662
## 5  2023 Apr      449.9413
## 6  2023 May      731.5511
## 7  2023 Jun      680.7654
## 8  2023 Jul      596.8109
## 9  2023 Aug      680.9398
## 10 2023 Sep      379.6509
## 11 2023 Oct      262.2746
## 12 2023 Nov      195.0101
## 13 2023 Dec      177.4056</code></pre>
</div>
</div>
<div id="italy-2" class="section level2 tabset">
<h2 class="tabset">Italy</h2>
<div class="sourceCode" id="cb176"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling ARIMA automatically</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>arima_italy <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Italy) <span class="sc">%&gt;%</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">arima =</span> <span class="fu">ARIMA</span>(Italy))</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>forecast_arima_italy <span class="ot">&lt;-</span> arima_italy <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>)</span></code></pre></div>
<div id="checking-residuals-1" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<div class="sourceCode" id="cb177"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>arima_italy <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SARIMA Italy residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-51-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-1" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<div class="sourceCode" id="cb178"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>arima_italy <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Italy_since_2018) <span class="sc">+</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Forecast for Italy&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-52-1.png" width="768" /></p>
<div class="sourceCode" id="cb179"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>forecast_table_italy_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ARIMA&quot;</span>),</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_arima_italy))</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>forecast_table_italy_a <span class="ot">&lt;-</span> forecast_table_italy_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values.Date,Forecast_Values..mean)</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_italy_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_italy_a)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Italy ARIMA&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-1" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<div class="sourceCode" id="cb180"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>forecast_table_italy_a</span></code></pre></div>
<pre><code>##       Month Italy ARIMA
## 1  2022 Dec    1826.559
## 2  2023 Jan    1830.641
## 3  2023 Feb    2084.348
## 4  2023 Mar    2064.941
## 5  2023 Apr    1763.042
## 6  2023 May    1826.055
## 7  2023 Jun    1930.824
## 8  2023 Jul    2272.030
## 9  2023 Aug    1978.937
## 10 2023 Sep    1936.262
## 11 2023 Oct    1939.172
## 12 2023 Nov    1906.992
## 13 2023 Dec    1816.285</code></pre>
</div>
</div>
<div id="austria-2" class="section level2 tabset">
<h2 class="tabset">Austria</h2>
<div class="sourceCode" id="cb182"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling ARIMA automatically</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>arima_austria <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Austria) <span class="sc">%&gt;%</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">arima =</span> <span class="fu">ARIMA</span>(Austria))</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>forecast_arima_austria <span class="ot">&lt;-</span> arima_austria <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>)</span></code></pre></div>
<div id="checking-residuals-2" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<div class="sourceCode" id="cb183"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>arima_austria <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SARIMA Austria residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-55-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-2" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<div class="sourceCode" id="cb184"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>arima_austria <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Austria_since_2015) <span class="sc">+</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Forecast for Austria&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-56-1.png" width="768" /></p>
<div class="sourceCode" id="cb185"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>forecast_table_austria_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ARIMA&quot;</span>),</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_arima_austria))</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>forecast_table_austria_a <span class="ot">&lt;-</span> forecast_table_austria_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values.Date,Forecast_Values..mean)</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_austria_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_austria_a)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Austria ARIMA&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-2" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<div class="sourceCode" id="cb186"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>forecast_table_austria_a</span></code></pre></div>
<pre><code>##       Month Austria ARIMA
## 1  2022 Dec      70.83719
## 2  2023 Jan      98.11923
## 3  2023 Feb      98.11923
## 4  2023 Mar      98.11923
## 5  2023 Apr      98.11923
## 6  2023 May      98.11923
## 7  2023 Jun      98.11923
## 8  2023 Jul      98.11923
## 9  2023 Aug      98.11923
## 10 2023 Sep      98.11923
## 11 2023 Oct      98.11923
## 12 2023 Nov      98.11923
## 13 2023 Dec      98.11923</code></pre>
</div>
</div>
<div id="france-2" class="section level2 tabset">
<h2 class="tabset">France</h2>
<div class="sourceCode" id="cb188"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling ARIMA automatically</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>arima_france <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(France) <span class="sc">%&gt;%</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">arima =</span> <span class="fu">ARIMA</span>(France))</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>forecast_arima_france <span class="ot">&lt;-</span> arima_france <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>)</span></code></pre></div>
<div id="checking-residuals-3" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<div class="sourceCode" id="cb189"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>arima_france <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SARIMA France residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-59-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-3" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<div class="sourceCode" id="cb190"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphing the forecast</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>arima_france <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(France_since_2015) <span class="sc">+</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Forecast for France&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-60-1.png" width="768" /></p>
<div class="sourceCode" id="cb191"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>forecast_table_france_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ARIMA&quot;</span>),</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_arima_france))</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>forecast_table_france_a <span class="ot">&lt;-</span> forecast_table_france_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values.Date,Forecast_Values..mean)</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_france_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_france_a)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;France ARIMA&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-3" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<div class="sourceCode" id="cb192"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>forecast_table_france_a</span></code></pre></div>
<pre><code>##       Month France ARIMA
## 1  2022 Dec     263.9312
## 2  2023 Jan     383.6005
## 3  2023 Feb     320.5275
## 4  2023 Mar     351.3831
## 5  2023 Apr     353.5785
## 6  2023 May     350.5107
## 7  2023 Jun     345.8482
## 8  2023 Jul     358.7890
## 9  2023 Aug     345.7798
## 10 2023 Sep     329.4261
## 11 2023 Oct     294.9338
## 12 2023 Nov     342.4077
## 13 2023 Dec     376.1259</code></pre>
</div>
</div>
<div id="total-2" class="section level2 tabset">
<h2 class="tabset">Total</h2>
<div class="sourceCode" id="cb194"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling ARIMA automatically</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>arima_total <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Total) <span class="sc">%&gt;%</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">arima =</span> <span class="fu">ARIMA</span>(Total))</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>forecast_arima_total <span class="ot">&lt;-</span> arima_total <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>)</span></code></pre></div>
<div id="checking-residuals-4" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<div class="sourceCode" id="cb195"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>arima_total <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SARIMA residuals analysis for all countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-63-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-4" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<div class="sourceCode" id="cb196"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphing the forecast</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>arima_total <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Total_since_2015) <span class="sc">+</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Forecast for all countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-64-1.png" width="768" /></p>
<div class="sourceCode" id="cb197"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>forecast_table_total_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ARIMA&quot;</span>),</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_arima_total))</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>forecast_table_total_a <span class="ot">&lt;-</span> forecast_table_total_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values.Date,Forecast_Values..mean)</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_total_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_total_a)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Total ARIMA&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-4" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<div class="sourceCode" id="cb198"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>forecast_table_total_a</span></code></pre></div>
<pre><code>##       Month Total ARIMA
## 1  2022 Dec    2336.515
## 2  2023 Jan    2507.818
## 3  2023 Feb    2489.217
## 4  2023 Mar    2580.353
## 5  2023 Apr    2302.442
## 6  2023 May    2411.328
## 7  2023 Jun    2591.927
## 8  2023 Jul    3070.838
## 9  2023 Aug    2798.490
## 10 2023 Sep    2469.884
## 11 2023 Oct    2412.024
## 12 2023 Nov    2300.391
## 13 2023 Dec    2299.457</code></pre>
</div>
</div>
<div id="combining-all-forecasts-into-one-table" class="section level2">
<h2>Combining all forecasts into one table:</h2>
<div class="sourceCode" id="cb200"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>final_fc <span class="ot">&lt;-</span> <span class="fu">left_join</span>(forecast_table_total_a,forecast_table_germany_a, <span class="at">by =</span> <span class="st">&quot;Month&quot;</span>)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>final_fc <span class="ot">&lt;-</span> final_fc <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(forecast_table_france_a, <span class="at">by =</span> <span class="st">&quot;Month&quot;</span>)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>final_fc <span class="ot">&lt;-</span> final_fc <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(forecast_table_italy_a, <span class="at">by =</span> <span class="st">&quot;Month&quot;</span>)</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>final_fc <span class="ot">&lt;-</span> final_fc <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(forecast_table_austria_a, <span class="at">by =</span> <span class="st">&quot;Month&quot;</span>)</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="co">#final_fc &lt;- final_fc %&gt;% left_join(forecast_table_Lichtenstein_a, by = &quot;Month&quot;)</span></span></code></pre></div>
</div>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
