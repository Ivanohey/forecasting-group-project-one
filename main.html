<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
        <meta name="date" content="2023-05-23" />
    
    <title>Forecasting Project 1 - Group 7</title>

        <script src="main_files/header-attrs-2.21/header-attrs.js"></script>
        <script src="main_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="main_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="main_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="main_files/navigation-1.1/tabsets.js"></script>
        <script src="main_files/navigation-1.1/codefolding.js"></script>
        <link href="main_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="main_files/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="main_files/readthedown-0.1/readthedown.js"></script>
        <script src="main_files/kePrint-0.0.1/kePrint.js"></script>
        <link href="main_files/lightable-0.0.1/lightable.css" rel="stylesheet" />
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #2a211c;
          color: #bdae9d;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #bdae9d;  padding-left: 4px; }
      div.sourceCode
        { color: #bdae9d; background-color: #2a211c; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ffff00; } /* Alert */
      code span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { } /* Attribute */
      code span.bn { color: #44aa43; } /* BaseN */
      code span.bu { } /* BuiltIn */
      code span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #049b0a; } /* Char */
      code span.cn { } /* Constant */
      code span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
      code span.do { color: #0066ff; font-style: italic; } /* Documentation */
      code span.dt { text-decoration: underline; } /* DataType */
      code span.dv { color: #44aa43; } /* DecVal */
      code span.er { color: #ffff00; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #44aa43; } /* Float */
      code span.fu { color: #ff9358; font-weight: bold; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
      code span.op { } /* Operator */
      code span.pp { font-weight: bold; } /* Preprocessor */
      code span.sc { color: #049b0a; } /* SpecialChar */
      code span.ss { color: #049b0a; } /* SpecialString */
      code span.st { color: #049b0a; } /* String */
      code span.va { } /* Variable */
      code span.vs { color: #049b0a; } /* VerbatimString */
      code span.wa { color: #ffff00; font-weight: bold; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
        <script>
      $(document).ready(function () {
	  	  	  window.initializeCodeFolding("hide" === "show");
	        });
    </script>
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
      <div class="btn-group pull-right">
     <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
     <ul class="dropdown-menu" style="min-width: 50px;">
	    	    <li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
	    <li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
	    	    	         </ul>
   </div>
   
        
      <h1 class="title">Forecasting Project 1 - Group 7</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Forecasting Project 1 - Group 7</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#things-that-need-to-be-done"
      id="toc-things-that-need-to-be-done">THINGS THAT NEED TO BE
      DONE</a></li>
      <li><a href="#introduction" id="toc-introduction">1.
      Introduction</a></li>
      <li><a href="#data-processing" id="toc-data-processing">2. Data
      Processing</a></li>
      <li><a href="#exploratory-data-analysis"
      id="toc-exploratory-data-analysis">3. Exploratory Data
      Analysis</a>
      <ul>
      <li><a href="#historical-data-plots"
      id="toc-historical-data-plots">3.1 Historical data plots</a></li>
      <li><a href="#seasonal-sub-series-plots"
      id="toc-seasonal-sub-series-plots">3.2 Seasonal Sub-series
      plots</a></li>
      <li><a href="#acf---autocorrelation-analysis"
      id="toc-acf---autocorrelation-analysis">3.3 ACF - Autocorrelation
      analysis</a></li>
      <li><a href="#stl-decomposition-for-all-countries"
      id="toc-stl-decomposition-for-all-countries">3.4 STL Decomposition
      for all countries</a></li>
      <li><a href="#unit-root-test-for-stationarity"
      id="toc-unit-root-test-for-stationarity">3.5 Unit Root Test for
      Stationarity</a></li>
      </ul></li>
      <li><a href="#model-selection" id="toc-model-selection">4. Model
      Selection</a>
      <ul>
      <li><a href="#methodology"
      id="toc-methodology">Methodology</a></li>
      <li><a href="#germany-2" id="toc-germany-2">4.1 Germany</a></li>
      <li><a href="#italy-2" id="toc-italy-2">4.2 Italy</a></li>
      <li><a href="#austria-2" id="toc-austria-2">4.3 Austria</a></li>
      <li><a href="#france-2" id="toc-france-2">4.4 France</a></li>
      <li><a href="#lichtenstein-2" id="toc-lichtenstein-2">4.5
      Lichtenstein</a></li>
      <li><a href="#total-2" id="toc-total-2">4.6 Total</a></li>
      <li><a href="#result" id="toc-result">Result</a></li>
      </ul></li>
      <li><a href="#forecast" id="toc-forecast">5. Forecast</a>
      <ul>
      <li><a href="#germany-3" id="toc-germany-3">5.1 Germany</a></li>
      <li><a href="#italy-3" id="toc-italy-3">5.2 Italy</a></li>
      <li><a href="#austria-3" id="toc-austria-3">5.3 Austria</a></li>
      <li><a href="#france-3" id="toc-france-3">5.4 France</a></li>
      <li><a href="#lichtenstein-3" id="toc-lichtenstein-3">5.5
      Lichtenstein</a></li>
      <li><a href="#total-3" id="toc-total-3">5.6 Total</a></li>
      <li><a href="#combining-all-forecasts-into-one-table"
      id="toc-combining-all-forecasts-into-one-table">Combining all
      forecasts into one table:</a></li>
      </ul></li>
      <li><a href="#challenges-and-further-analysis"
      id="toc-challenges-and-further-analysis">6. Challenges and Further
      Analysis</a></li>
      <li><a href="#appendix" id="toc-appendix">Appendix</a>
      <ul>
      <li><a href="#appendix-1.-decomposition-comparison"
      id="toc-appendix-1.-decomposition-comparison"><em>Appendix 1.
      Decomposition Comparison</em></a></li>
      <li><a href="#appendix-2.-accuracy-metrics-comparison"
      id="toc-appendix-2.-accuracy-metrics-comparison"><em>Appendix 2.
      Accuracy metrics comparison</em></a></li>
      <li><a href="#appendix-3.-plots-of-all-countries-historical-data"
      id="toc-appendix-3.-plots-of-all-countries-historical-data"><em>Appendix
      3. Plots of all countries’ historical data</em></a></li>
      <li><a href="#appendix-4.-plots-of-seasonal-subseries"
      id="toc-appendix-4.-plots-of-seasonal-subseries"><em>Appendix 4.
      Plots of Seasonal Subseries</em></a></li>
      </ul></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> Konst
Khryst Amina Ivan
		      </p>
                        <p class="date"><span class="glyphicon glyphicon-calendar"></span> 2023-05-23</p>
          </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div id="things-that-need-to-be-done" class="section level1">
<h1>THINGS THAT NEED TO BE DONE</h1>
<ul>
<li>In the forecast we show only the final model chosen, why show
lichtenstein 5.5.1 + 5.5.2?</li>
</ul>
</div>
<div id="introduction" class="section level1">
<h1>1. Introduction</h1>
<p>This project is a forecasting analysis for the electricity exports
from Switzerland to several European countries. The data used was all
provided by the professor and no additional datasets were used. We have
selected the models that fit each country the best (based on some
performance metrics) and have created forecasts and CI’s for each
country as well as the total. In the final report you are now reading,
only the most important information is included, and whatever was deemed
unnecessary for the report you can find in our code files/appendix.</p>
<p>The forecasting models used in this project are S-Naive, S-ARIMA, ETS
and a variant of ARIMA piece-wise for a specific country.</p>
</div>
<div id="data-processing" class="section level1">
<h1>2. Data Processing</h1>
<p>The data we were given was already cleaned, without any missing
values. The only noteworthy cleaning we did, was to format the names of
all columns and all rows, and to then convert the final table to a
tsibble in order to be able to use functions from the tsibble and fpp3
package. All details on how this was done can be found in the code
files.</p>
</div>
<div id="exploratory-data-analysis" class="section level1">
<h1>3. Exploratory Data Analysis</h1>
<div id="historical-data-plots" class="section level2">
<h2>3.1 Historical data plots</h2>
<p>In this section you can find an example of the exploratory analysis
we did to identify outliers and behaviors in our data. We created
historical plots of all the data for each country, but this is not
presented here and can instead be found in our appendix. The anomalies
and outliers we discovered in that section, were used to guide our
analysis.</p>
<p>For example, we noticed irregularities in the amplitudes of
seasonality over time. For countries like Germany and France, the
amplitude of the seasonality seemed to increase towards the most recent
years. Based on this, we decided to do a seasonal/trend decomposition
for each country to further analyze this.</p>
<p>Furthermore, for Lichtenstein, we noticed a huge drop in exports
after 2008-2009, which indicated that we should try different models
like the piece-wise model to separate the differences in trend over
time.</p>
</div>
<div id="seasonal-sub-series-plots" class="section level2">
<h2>3.2 Seasonal Sub-series plots</h2>
<p>We also created seasonal sub-series plots to explore specific months
in more detail, for each country. Below you can see the one for the
total exports:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(Total) <span class="sc">+</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to All countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
<p>Here are some observations based on these plots for each country
(which you can find in appendix):</p>
<ul>
<li>Germany: It looks like Germany consistently receives more
electricity during the summer months (May, June, July, August).
Seasonality seems to vary over time, increasing towards the most recent
years.</li>
<li>France: It looks like there are two peaks in energy exported to
France during the year, one in July, and one in December.<br />
</li>
<li>Italy: Similar energy peak in July.</li>
<li>Austria: Same trend, with a single peak in the summer months, and
then relatively constant energy for the other months.</li>
<li>Lichtenstein: This country shows the opposite trend, with a very
smooth peak in the coldest winter months (Jan,Feb), and the lowest
energy exports during the summer months.<br />
</li>
<li>Total: Clearly seeing the peak in energy exports to countries in the
summer, and specifically in July. The other months are at similar levels
for the total electricity exports.</li>
</ul>
<p>In summary, the main observation we got from these historical plots,
was that all countries (except Lichtenstein) experience peaks in the
electricity they receive from Switzerland in the summer months.</p>
<p>Before this monthly analysis, we expected that energy exports to
these countries, would be higher in the winter months, as that’s when
people tend to consume more energy to heat up their homes (we assumed
this to be one of the biggest drivers in energy consumption). However,
in reality it seems like electricity exports are peaking in the summer
and not in the winter months. Our explanation for this is that the ways
to heat up a home in the winter are mainly based on oil/gas rather than
electricity which is why there is no peak for electricity exports in the
winter. On the contrary, during the summer months, people tend to cool
down their homes using Air-conditioning which primarily uses
electricity, hence the peak in the summer months. This does not explain
why Lichtenstein does not follow the same pattern, despite being
geographically right next to all of these countries (hence having
similar climate).</p>
</div>
<div id="acf---autocorrelation-analysis" class="section level2">
<h2>3.3 ACF - Autocorrelation analysis</h2>
<p>Before moving on with the models and in order to be able to use them,
we wanted to check for autocorrelation in the time series. Here is data
on Germany which is lagged by 12 periods:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#Graph of 12 lagged months for Germany</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="fu">gg_lag</span>(Germany, <span class="at">lags =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>) <span class="sc">+</span> </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Germany 12-period lag graph&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-4-1.png" width="768" /></p>
<p>From this graph, we can visualize autocorrelation. It’s clear that
the autocorrelation is the highest for the 1-month lag, and the 12-month
lag. We can see this because the points in the first and last
scatterplot (Current month vs Lagged period) approach the 45-degree
line, indicating the similarity in magnitude of two the
observations.</p>
<p>Based on the strong and clear presence of autocorrelation, we expect
that a model like ARIMA/SARIMA will do a good job to capture this
auto-correlation component, and will most likely have the best
performance compared to other models. On the contrary, auto-correlation
tends to impact the performance of SNAIVE models, as they rely on the
assumption that the future values are solely determined by past values
without considering any auto-correlation patterns. This suggests that
our SNAIVE model will not be fitting the data as well.</p>
</div>
<div id="stl-decomposition-for-all-countries"
class="section level2 tabset">
<h2 class="tabset">3.4 STL Decomposition for all countries</h2>
<p>We decided to perform an STL decomposition, as it can provide
valuable insights and help explore and understand any strange patterns
in our data.</p>
<p>Overall as you can see below, we observed strong seasonality and
trend patterns in each country and all countries together which
suggested our models should have a way to capture the presence of
seasonality and trend. This can be seen in the trend + season_year
graphs which show the trend + seasonal component in relation to the
overall variation in the data (this is seen using the grey box on the
left of each graph). Finally, we can also see that the “remainder”
component is quite significant in size (relative to the overall
variation) which makes the time series difficult to predict
accurately.</p>
<div id="germany" class="section level3">
<h3><strong>Germany</strong></h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Germany <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
</div>
<div id="france" class="section level3">
<h3><strong>France</strong></h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#STL Decomposition_France</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(France <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
</div>
<div id="italy" class="section level3">
<h3><strong>Italy</strong></h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Italy <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
</div>
<div id="austria" class="section level3">
<h3><strong>Austria</strong></h3>
<p>Austria trend undergoes a huge increase during the period 2018-2021,
follow by a drastic drop which are not explainable by historical data
and strongly suggest that it is affected by a covariate. Seasonality is
constant and stable over time during the whole period.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Austria <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-8-1.png" width="768" /></p>
</div>
<div id="lichtenstein" class="section level3">
<h3><strong>Lichtenstein</strong></h3>
<p>Lichtenstein trend undergoes a drastical drop during the year of
2008, that is not explainable by historical data and strongly suggest
that it is affected by a covariate. Seasonality is constant and stable
over time during the whole period. Thus we observe that the amplitude
and duration of the seasonal patterns remain unchanged over different
time periods.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Lichtenstein <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
</div>
<div id="total" class="section level3">
<h3><strong>Total</strong></h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Total <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&quot;periodic&quot;</span>),</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-10-1.png" width="768" /></p>
</div>
</div>
<div id="unit-root-test-for-stationarity" class="section level2 tabset">
<h2 class="tabset">3.5 Unit Root Test for Stationarity</h2>
<p>In the final part of our EDA, we wanted to confirm our suspicion of
the presence of non-stationarity (since we found a significant trend and
seasonal component in the STL analysis). To do this, we used the Unit
Root Test to check for the presence of a unit root in the time series,
which is an indication of non-stationarity. Below are the null and
alternative hypotheses for this statistical test:</p>
<p><span class="math display">\[H_0: The\ time\ series\ has\ a\ unit\
root\ (non\ stationary)\\ H_1: The\ time\ series\ is\
stationary\]</span></p>
<p>After doing the test for all countries, we found that all of the time
series (except Lichtenstein) are stationary at a significance level of:
<code>alpha = 0.05</code>. This is against our initial assumption that
the data is non-stationary, which was based on the fact that we saw a
clear trend and seasonality for many of the countries. When the data is
stationary, any model can be used (stationarity in the data is one of
the assumptions for NAIVE and ETS models). However for Lichtenstein,
since the p-value is larger than our significance level of 5%, we have
to difference or log the Lichtenstein data before using some models.</p>
<div id="germany-1" class="section level3">
<h3><strong>Germany</strong></h3>
<p>The test statistic was -6.0768. The p-value of the test was 0.01,
which indicates strong evidence to reject the null hypothesis of
non-stationarity at <code>alpha = 0.05</code>. Thus Germany data is a
stationary time series.</p>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  ts_g
## Dickey-Fuller = -6.3865, Lag order = 6, p-value = 0.01
## alternative hypothesis: stationary</code></pre>
</div>
<div id="france-1" class="section level3">
<h3><strong>France</strong></h3>
<p>The test statistic was -4.6123 The p-value of the test was 0.01,
which indicates strong evidence to reject the null hypothesis of
non-stationarity at <code>alpha = 0.05</code>. Thus France data is a
stationary time series.</p>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  ts_F
## Dickey-Fuller = -5.671, Lag order = 6, p-value = 0.01
## alternative hypothesis: stationary</code></pre>
</div>
<div id="italy-1" class="section level3">
<h3><strong>Italy</strong></h3>
<p>The test statistic was -6.8897 The p-value of the test was 0.01. Thus
Italy data is a stationary time series.</p>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  ts_I
## Dickey-Fuller = -6.1852, Lag order = 6, p-value = 0.01
## alternative hypothesis: stationary</code></pre>
</div>
<div id="austria-1" class="section level3">
<h3><strong>Austria</strong></h3>
<p>The test statistic was -3.7273 The p-value of the test was 0.02443,
which indicates strong evidence to reject the null hypothesis of
non-stationarity at <code>alpha = 0.05</code>. Thus Austria data is a
stationary time series.</p>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  ts_A
## Dickey-Fuller = -3.6792, Lag order = 6, p-value = 0.02595
## alternative hypothesis: stationary</code></pre>
</div>
<div id="lichtenstein-1" class="section level3">
<h3><strong>Lichtenstein</strong></h3>
<p>The test statistic was -6.5052 The p-value of the test was 0.01. Thus
Lichtenstein data is a stationary time series.</p>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  ts_Lich
## Dickey-Fuller = -3.0063, Lag order = 6, p-value = 0.1521
## alternative hypothesis: stationary</code></pre>
</div>
<div id="total-1" class="section level3">
<h3><strong>Total</strong></h3>
<p>Finally, The test statistic was -4.0009 The p-value of the test was
0.01103. Thus Total data is a stationary time series.</p>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  ts_Tot
## Dickey-Fuller = -4.8658, Lag order = 6, p-value = 0.01
## alternative hypothesis: stationary</code></pre>
</div>
</div>
</div>
<div id="model-selection" class="section level1">
<h1>4. Model Selection</h1>
<div id="methodology" class="section level2">
<h2>Methodology</h2>
<p>Before creating forecasts, we wanted to discover which model fits our
data the best. To evaluate this, we have decided to fit different models
for each country, and then pick the best one.</p>
<p>To do this, we split our data into a training and a test set. The
first one we will use to estimate any parameters of the forecasting
model, and the second is to examine each model’s accuracy. The training
set for all countries is basically a long time period, from the
beginning of our data until the end of 2015, and then the rest of the
data is used in the test set.</p>
<p>The different models we decided to explore are S-ARIMA, ETS, S-NAIVE
and TSLM, and we used them to forecast 60 periods (months) and then
compare those with the data in the test set.</p>
<p>For each country, we selected the model with the best accuracy
metrics, as we will explain below. Some of the metrics we will look at
are RMSE and MAE and low metric values indicate a better predictive
performance of the model. A value of 0 indicates a perfect fit between
the predicted and actual values. Residuals analysis is also going to be
plotted to see how well the model captures the dynamics of the data.
Good models’ residuals should be stationary (white noise) and have no
patterns.</p>
<p>We can see strong seasonality and trend in data from our
decomposition analysis, which is why we selected the models mentioned
above. We expect these models can handle these types of data the
best.</p>
<p>As the most accurate forecast is of interest, we will give more
weight to the model with low values of RMSE and MAE, even though another
model has a higher AIC (see Appendix 2.).</p>
</div>
<div id="germany-2" class="section level2 tabset">
<h2 class="tabset">4.1 Germany</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>Germany_since_2015 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="fu">select</span>(Date,Germany) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="fu">suppressWarnings</span>(<span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>)))</span></code></pre></div>
<div id="testing-models" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>training_ge <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Germany) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>test_ge <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Germany) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>data_fit_ge_a <span class="ot">&lt;-</span> training_ge <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Germany))</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>forecasts_ge_a <span class="ot">&lt;-</span> data_fit_ge_a <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>data_fit_ge_e <span class="ot">&lt;-</span> training_ge <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Germany))</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>forecasts_ge_e <span class="ot">&lt;-</span> data_fit_ge_e <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>data_fit_ge_n <span class="ot">&lt;-</span> training_ge <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Germany))</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>forecasts_ge_n <span class="ot">&lt;-</span> data_fit_ge_n <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>all_forecasts_ge <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_ge_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_ge_a<span class="sc">$</span>.mean),</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_ge_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_ge_e<span class="sc">$</span>.mean),</span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_ge_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_ge_n<span class="sc">$</span>.mean))</span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Germany)  <span class="sc">+</span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_ge, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Consumption in Germany&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-19-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table RMSE, MAE and other indicators, ETS
has the lowest values on the test data. The ARIMA model has an AIC of
AIC=2260.11, AICc of AICc=2260.6, and BIC of 2279.27. On the other hand,
the ETS model has an AIC of 2797.057, AICc of 2799.784, and BIC of
2845.919. Therefore, based on these criteria, we can conclude that the
ARIMA model fits the data better than the ETS model.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>germany_accuracy_a <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(forecasts_ge_a, test_ge)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>germany_accuracy_e <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(forecasts_ge_e, test_ge)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>germany_accuracy_n <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(forecasts_ge_n, test_ge)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>germany_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  <span class="fu">data.frame</span>(germany_accuracy_a),</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  <span class="fu">data.frame</span>(germany_accuracy_e),</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>  <span class="fu">data.frame</span>(germany_accuracy_n))</span></code></pre></div>
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.model
</th>
<th style="text-align:left;">
.type
</th>
<th style="text-align:right;">
ME
</th>
<th style="text-align:right;">
RMSE
</th>
<th style="text-align:right;">
MAE
</th>
<th style="text-align:right;">
MPE
</th>
<th style="text-align:right;">
MAPE
</th>
<th style="text-align:right;">
MASE
</th>
<th style="text-align:right;">
RMSSE
</th>
<th style="text-align:right;">
ACF1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ARIMA(Germany)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
22.21212
</td>
<td style="text-align:right;color: white !important;background-color: rgba(63, 72, 137, 1) !important;">
271.7830
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 1) !important;">
191.6002
</td>
<td style="text-align:right;">
-21.98723
</td>
<td style="text-align:right;">
57.15420
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.6419235
</td>
</tr>
<tr>
<td style="text-align:left;">
ETS(Germany)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
20.06976
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;">
263.9592
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;">
183.7753
</td>
<td style="text-align:right;">
-26.84302
</td>
<td style="text-align:right;">
57.48681
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.5797918
</td>
</tr>
<tr>
<td style="text-align:left;">
SNAIVE(Germany)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
92.46667
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 1) !important;">
285.7502
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 151, 139, 1) !important;">
190.6667
</td>
<td style="text-align:right;">
-1.86239
</td>
<td style="text-align:right;">
49.34599
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.6260558
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">report</span>(data_fit_ge_a)</span></code></pre></div>
<pre><code>## Series: Germany 
## Model: ARIMA(1,0,1)(2,1,1)[12] 
## 
## Coefficients:
##          ar1      ma1     sar1     sar2    sma1
##       0.7853  -0.2946  -0.8231  -0.4046  0.0965
## s.e.  0.0731   0.1106   0.1925   0.1247  0.2054
## 
## sigma^2 estimated as 15296:  log likelihood=-1124.06
## AIC=2260.11   AICc=2260.6   BIC=2279.27</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">report</span>(data_fit_ge_e)</span></code></pre></div>
<pre><code>## Series: Germany 
## Model: ETS(M,N,M) 
##   Smoothing parameters:
##     alpha = 0.3739358 
##     gamma = 0.3451097 
## 
##   Initial states:
##      l[0]      s[0]     s[-1]     s[-2]    s[-3]    s[-4]    s[-5]    s[-6]
##  653.4368 0.6246774 0.7255761 0.7347587 1.011001 1.387123 1.493534 1.469065
##     s[-7]     s[-8]    s[-9]    s[-10]    s[-11]
##  1.560156 0.7932617 0.864902 0.6433645 0.6925801
## 
##   sigma^2:  0.094
## 
##      AIC     AICc      BIC 
## 2797.057 2799.784 2845.919</code></pre>
</div>
<div id="residuals" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_ge_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Germany residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-23-1.png" width="768" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_ge_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Germany residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-23-2.png" width="768" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_ge_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Germany residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-23-3.png" width="768" /></p>
</div>
</div>
<div id="italy-2" class="section level2 tabset">
<h2 class="tabset">4.2 Italy</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co">#Selecting Italy only since 2018 to better display the forecast. 2018 will both show the trend BEFORE covid + improve display </span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>Italy_since_2018 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Italy) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2018-01-01&quot;</span>))</span></code></pre></div>
<div id="testing-models-1" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>training_it <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Italy) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>test_it <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Italy) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>data_fit_it_a <span class="ot">&lt;-</span> training_it <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Italy)) </span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>forecasts_it_a <span class="ot">&lt;-</span> data_fit_it_a <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>data_fit_it_e <span class="ot">&lt;-</span> training_it <span class="sc">%&gt;%</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Italy))</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>forecasts_it_e <span class="ot">&lt;-</span> data_fit_it_e <span class="sc">%&gt;%</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>data_fit_it_n <span class="ot">&lt;-</span> training_it <span class="sc">%&gt;%</span></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Italy))</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>forecasts_it_n <span class="ot">&lt;-</span> data_fit_it_n <span class="sc">%&gt;%</span></span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a>all_forecasts_it <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_it_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_it_a<span class="sc">$</span>.mean),</span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_it_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_it_e<span class="sc">$</span>.mean),</span>
<span id="cb31-28"><a href="#cb31-28" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_it_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_it_n<span class="sc">$</span>.mean))</span>
<span id="cb31-29"><a href="#cb31-29" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" tabindex="-1"></a></span>
<span id="cb31-31"><a href="#cb31-31" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb31-32"><a href="#cb31-32" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Italy) <span class="sc">+</span></span>
<span id="cb31-33"><a href="#cb31-33" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_it, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb31-34"><a href="#cb31-34" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand in Italy&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-25-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-1" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table below, RMSE, MAE, as well as AIC,
AICc, and BIC, ARIMA has the lowest values on the test data than the ETS
model.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>italy_accuracy_a <span class="ot">&lt;-</span><span class="fu">accuracy</span>(forecasts_it_a, test_it)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>italy_accuracy_e <span class="ot">&lt;-</span><span class="fu">accuracy</span>(forecasts_it_e, test_it)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>italy_accuracy_n <span class="ot">&lt;-</span><span class="fu">accuracy</span>(forecasts_it_n, test_it)</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>italy_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>  <span class="fu">data.frame</span>(italy_accuracy_a),</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>  <span class="fu">data.frame</span>(italy_accuracy_e),</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>  <span class="fu">data.frame</span>(italy_accuracy_n))</span></code></pre></div>
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.model
</th>
<th style="text-align:left;">
.type
</th>
<th style="text-align:right;">
ME
</th>
<th style="text-align:right;">
RMSE
</th>
<th style="text-align:right;">
MAE
</th>
<th style="text-align:right;">
MPE
</th>
<th style="text-align:right;">
MAPE
</th>
<th style="text-align:right;">
MASE
</th>
<th style="text-align:right;">
RMSSE
</th>
<th style="text-align:right;">
ACF1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ARIMA(Italy)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
-326.2634
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;">
567.8518
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;">
397.3082
</td>
<td style="text-align:right;">
-29.97463
</td>
<td style="text-align:right;">
32.99264
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.5201659
</td>
</tr>
<tr>
<td style="text-align:left;">
ETS(Italy)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
-684.9666
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 1) !important;">
814.8247
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 1) !important;">
688.7554
</td>
<td style="text-align:right;">
-51.88364
</td>
<td style="text-align:right;">
52.02657
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.5512166
</td>
</tr>
<tr>
<td style="text-align:left;">
SNAIVE(Italy)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
-412.1667
</td>
<td style="text-align:right;color: white !important;background-color: rgba(63, 71, 136, 1) !important;">
655.4941
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 58, 131, 1) !important;">
479.4667
</td>
<td style="text-align:right;">
-33.06326
</td>
<td style="text-align:right;">
36.73605
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.4827242
</td>
</tr>
</tbody>
</table>
<pre><code>## Series: Italy 
## Model: ARIMA(1,0,0)(2,0,0)[12] w/ mean 
## 
## Coefficients:
##          ar1    sar1    sar2  constant
##       0.6369  0.3471  0.3479  227.4524
## s.e.  0.0565  0.0673  0.0717   16.0636
## 
## sigma^2 estimated as 73103:  log likelihood=-1349.39
## AIC=2708.77   AICc=2709.1   BIC=2725.06</code></pre>
<pre><code>## Series: Italy 
## Model: ETS(A,N,A) 
##   Smoothing parameters:
##     alpha = 0.7893584 
##     gamma = 0.0001000066 
## 
##   Initial states:
##      l[0]     s[0]    s[-1]    s[-2]     s[-3]    s[-4]    s[-5]    s[-6]
##  2001.551 15.17983 90.59285 210.0609 -95.62885 -503.615 165.2749 -103.177
##      s[-7]     s[-8]    s[-9]   s[-10]   s[-11]
##  -101.2201 -20.17958 171.0857 59.06312 112.5631
## 
##   sigma^2:  71693.32
## 
##      AIC     AICc      BIC 
## 3171.492 3174.219 3220.354</code></pre>
</div>
<div id="residuals-1" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_it_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Italy residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-29-1.png" width="768" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_it_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Italy residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-29-2.png" width="768" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_it_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Italy residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-29-3.png" width="768" /></p>
</div>
</div>
<div id="austria-2" class="section level2 tabset">
<h2 class="tabset">4.3 Austria</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co">#Investigating Austria closely since 2018, because it seems like something changed -&gt; perhaps should use Piecewise!!!</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>Austria_since_2015 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Austria) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>))</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>Austria_since_2018 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Austria) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2018-02-01&quot;</span>))</span></code></pre></div>
<div id="testing-models-2" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>training_au <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Austria) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>test_au <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Austria) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>data_fit_au_a <span class="ot">&lt;-</span> training_au <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Austria, <span class="at">stepwise =</span> <span class="cn">FALSE</span>))</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>forecasts_au_a <span class="ot">&lt;-</span> data_fit_au_a <span class="sc">%&gt;%</span></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>data_fit_au_e <span class="ot">&lt;-</span> training_au <span class="sc">%&gt;%</span></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Austria))</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>forecasts_au_e <span class="ot">&lt;-</span> data_fit_au_e <span class="sc">%&gt;%</span></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a>data_fit_au_n <span class="ot">&lt;-</span> training_au <span class="sc">%&gt;%</span></span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Austria))</span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a>forecasts_au_n <span class="ot">&lt;-</span> data_fit_au_n <span class="sc">%&gt;%</span></span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb39-24"><a href="#cb39-24" tabindex="-1"></a>all_forecasts_au <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb39-25"><a href="#cb39-25" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_au_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_au_a<span class="sc">$</span>.mean),</span>
<span id="cb39-26"><a href="#cb39-26" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_au_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_au_e<span class="sc">$</span>.mean),</span>
<span id="cb39-27"><a href="#cb39-27" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_au_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_au_n<span class="sc">$</span>.mean))</span>
<span id="cb39-28"><a href="#cb39-28" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" tabindex="-1"></a></span>
<span id="cb39-30"><a href="#cb39-30" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb39-31"><a href="#cb39-31" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Austria) <span class="sc">+</span></span>
<span id="cb39-32"><a href="#cb39-32" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_au, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb39-33"><a href="#cb39-33" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand in Austria&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-31-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-2" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table below, RMSE, MAE, and other
indicators, ETS has the lowest values on the test data. However, ARIMA
has lower values of AIC, AICc, and BIC than the ETS model.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>austria_accuracy_a <span class="ot">&lt;-</span><span class="fu">accuracy</span>(forecasts_au_a, test_au)</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>austria_accuracy_e <span class="ot">&lt;-</span><span class="fu">accuracy</span>(forecasts_au_e, test_au)</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>austria_accuracy_n <span class="ot">&lt;-</span><span class="fu">accuracy</span>(forecasts_au_n, test_au)</span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>austria_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a>  <span class="fu">data.frame</span>(austria_accuracy_a),</span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>  <span class="fu">data.frame</span>(austria_accuracy_e),</span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>  <span class="fu">data.frame</span>(austria_accuracy_n))</span></code></pre></div>
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.model
</th>
<th style="text-align:left;">
.type
</th>
<th style="text-align:right;">
ME
</th>
<th style="text-align:right;">
RMSE
</th>
<th style="text-align:right;">
MAE
</th>
<th style="text-align:right;">
MPE
</th>
<th style="text-align:right;">
MAPE
</th>
<th style="text-align:right;">
MASE
</th>
<th style="text-align:right;">
RMSSE
</th>
<th style="text-align:right;">
ACF1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ARIMA(Austria, stepwise = FALSE)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
66.64429
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 151, 139, 1) !important;">
96.87947
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 159, 136, 1) !important;">
72.54087
</td>
<td style="text-align:right;">
4.907234
</td>
<td style="text-align:right;">
115.4226
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.7391642
</td>
</tr>
<tr>
<td style="text-align:left;">
ETS(Austria)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
45.52002
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;">
84.62589
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;">
61.72927
</td>
<td style="text-align:right;">
-72.600292
</td>
<td style="text-align:right;">
154.0206
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.7354246
</td>
</tr>
<tr>
<td style="text-align:left;">
SNAIVE(Austria)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
67.66667
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 1) !important;">
98.50110
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 1) !important;">
73.33333
</td>
<td style="text-align:right;">
14.887570
</td>
<td style="text-align:right;">
112.9874
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.7014929
</td>
</tr>
</tbody>
</table>
<pre><code>## Series: Austria 
## Model: ARIMA(0,0,3)(2,0,1)[12] w/ mean 
## 
## Coefficients:
##          ma1     ma2     ma3    sar1    sar2     sma1  constant
##       0.5991  0.1591  0.1055  0.6072  0.0853  -0.3699    6.3202
## s.e.  0.0742  0.0814  0.0731  0.2940  0.1561   0.2850    2.1449
## 
## sigma^2 estimated as 796.7:  log likelihood=-911.62
## AIC=1839.24   AICc=1840.03   BIC=1865.3</code></pre>
<pre><code>## Series: Austria 
## Model: ETS(A,N,A) 
##   Smoothing parameters:
##     alpha = 0.5246043 
##     gamma = 0.0001000228 
## 
##   Initial states:
##      l[0]      s[0]     s[-1]     s[-2]      s[-3]    s[-4]   s[-5]    s[-6]
##  39.20052 -12.84024 -7.616428 -8.086183 -0.9683645 43.50499 39.8389 2.189109
##      s[-7]     s[-8]     s[-9]    s[-10]    s[-11]
##  0.7038562 -11.55768 -14.38028 -16.43484 -14.35283
## 
##   sigma^2:  895.6703
## 
##      AIC     AICc      BIC 
## 2330.036 2332.764 2378.899</code></pre>
</div>
<div id="residuals-2" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_au_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Austria residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-35-1.png" width="768" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_au_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Austria residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-35-2.png" width="768" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_au_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Austria residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-35-3.png" width="768" /></p>
</div>
</div>
<div id="france-2" class="section level2 tabset">
<h2 class="tabset">4.4 France</h2>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>France_since_2015 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,France) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>))</span></code></pre></div>
<div id="testing-models-3" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>training_fr <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, France) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>test_fr <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, France) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>data_fit_fr_a <span class="ot">&lt;-</span> training_fr <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(France))</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>forecasts_fr_a <span class="ot">&lt;-</span> data_fit_fr_a <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a>data_fit_fr_e <span class="ot">&lt;-</span> training_fr <span class="sc">%&gt;%</span></span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(France))</span>
<span id="cb50-14"><a href="#cb50-14" tabindex="-1"></a>forecasts_fr_e <span class="ot">&lt;-</span> data_fit_fr_e <span class="sc">%&gt;%</span></span>
<span id="cb50-15"><a href="#cb50-15" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb50-16"><a href="#cb50-16" tabindex="-1"></a></span>
<span id="cb50-17"><a href="#cb50-17" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb50-18"><a href="#cb50-18" tabindex="-1"></a>data_fit_fr_n <span class="ot">&lt;-</span> training_fr <span class="sc">%&gt;%</span></span>
<span id="cb50-19"><a href="#cb50-19" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(France))</span>
<span id="cb50-20"><a href="#cb50-20" tabindex="-1"></a>forecasts_fr_n <span class="ot">&lt;-</span> data_fit_fr_n <span class="sc">%&gt;%</span></span>
<span id="cb50-21"><a href="#cb50-21" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb50-22"><a href="#cb50-22" tabindex="-1"></a></span>
<span id="cb50-23"><a href="#cb50-23" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb50-24"><a href="#cb50-24" tabindex="-1"></a>all_forecasts_fr <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb50-25"><a href="#cb50-25" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_fr_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_fr_a<span class="sc">$</span>.mean),</span>
<span id="cb50-26"><a href="#cb50-26" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_fr_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_fr_e<span class="sc">$</span>.mean),</span>
<span id="cb50-27"><a href="#cb50-27" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_fr_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_fr_n<span class="sc">$</span>.mean))</span>
<span id="cb50-28"><a href="#cb50-28" tabindex="-1"></a></span>
<span id="cb50-29"><a href="#cb50-29" tabindex="-1"></a></span>
<span id="cb50-30"><a href="#cb50-30" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb50-31"><a href="#cb50-31" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(France) <span class="sc">+</span></span>
<span id="cb50-32"><a href="#cb50-32" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_fr, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb50-33"><a href="#cb50-33" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand in France&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-37-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-3" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table below, RMSE, MAE, and other
indicators, ETS has the lowest values on the test data. However, ARIMA
has lower values of AIC, AICc, and BIC than the ETS model.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>france_accuracy_a <span class="ot">&lt;-</span><span class="fu">accuracy</span>(forecasts_fr_a, test_fr)</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>france_accuracy_e <span class="ot">&lt;-</span><span class="fu">accuracy</span>(forecasts_fr_e, test_fr)</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>france_accuracy_n <span class="ot">&lt;-</span><span class="fu">accuracy</span>(forecasts_fr_n, test_fr)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>france_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>  <span class="fu">data.frame</span>(france_accuracy_a),</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>  <span class="fu">data.frame</span>(france_accuracy_e),</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>  <span class="fu">data.frame</span>(france_accuracy_n))</span></code></pre></div>
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.model
</th>
<th style="text-align:left;">
.type
</th>
<th style="text-align:right;">
ME
</th>
<th style="text-align:right;">
RMSE
</th>
<th style="text-align:right;">
MAE
</th>
<th style="text-align:right;">
MPE
</th>
<th style="text-align:right;">
MAPE
</th>
<th style="text-align:right;">
MASE
</th>
<th style="text-align:right;">
RMSSE
</th>
<th style="text-align:right;">
ACF1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ARIMA(France)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
75.45265
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 1) !important;">
237.5959
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 1) !important;">
188.5761
</td>
<td style="text-align:right;">
-17.89751
</td>
<td style="text-align:right;">
58.02278
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.3711334
</td>
</tr>
<tr>
<td style="text-align:left;">
ETS(France)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
36.97867
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;">
204.7456
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;">
161.7681
</td>
<td style="text-align:right;">
-22.58217
</td>
<td style="text-align:right;">
52.37757
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.2004276
</td>
</tr>
<tr>
<td style="text-align:left;">
SNAIVE(France)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
29.75000
</td>
<td style="text-align:right;color: white !important;background-color: rgba(36, 135, 142, 1) !important;">
230.1236
</td>
<td style="text-align:right;color: white !important;background-color: rgba(33, 166, 133, 1) !important;">
188.1500
</td>
<td style="text-align:right;">
-30.72793
</td>
<td style="text-align:right;">
63.89382
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.2331056
</td>
</tr>
</tbody>
</table>
<pre><code>## Series: France 
## Model: ARIMA(1,1,4)(0,0,1)[12] 
## 
## Coefficients:
##          ar1      ma1      ma2      ma3      ma4    sma1
##       0.0186  -0.4859  -0.1850  -0.0946  -0.1620  0.1771
## s.e.  0.4208   0.4161   0.2162   0.1137   0.1172  0.0764
## 
## sigma^2 estimated as 15135:  log likelihood=-1188.05
## AIC=2390.09   AICc=2390.7   BIC=2412.86</code></pre>
<pre><code>## Series: France 
## Model: ETS(M,N,M) 
##   Smoothing parameters:
##     alpha = 0.1672851 
##     gamma = 0.0001002813 
## 
##   Initial states:
##     l[0]     s[0]     s[-1]    s[-2]   s[-3]   s[-4]    s[-5]     s[-6]
##  170.609 1.250038 0.9416617 1.095887 1.04379 1.14645 1.291704 0.9937027
##      s[-7]     s[-8]     s[-9]  s[-10]   s[-11]
##  0.6362197 0.6065504 0.7543347 1.13727 1.102391
## 
##   sigma^2:  0.2439
## 
##      AIC     AICc      BIC 
## 2844.032 2846.759 2892.894</code></pre>
</div>
<div id="residuals-3" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_fr_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA France residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-41-1.png" width="768" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_fr_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS France residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-41-2.png" width="768" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_fr_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE France residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-41-3.png" width="768" /></p>
</div>
</div>
<div id="lichtenstein-2" class="section level2 tabset">
<h2 class="tabset">4.5 Lichtenstein</h2>
<div id="testing-models-4" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016. This code fits different models
to the training data, generates forecasts, and then applies a constraint
to the forecasted mean values to ensure they are not negative. Based on
the previous analysis Lichtenstein data is NON stationary time series,
so we had to difference or log the data to make it stationary before
using our models. We tried both, and it seemed like using the log of the
data worked best.</p>
<p>Another thing to mention about Lichtenstein, is that for the ETS,
ARIMA and SNaive models, we decided to train them only after 2010. We
made this decision because before 2010, the data was very different
(upward trending at a much higher level) and thought that if the models
looked at that period, they would probably not produce accurate
results.</p>
<p><img src="main_files/figure-html/unnamed-chunk-43-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-4" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>In our case S-Naive outperform during the model selection and
analysis of accuracy. However S-Naive method may perform well for the
time period that we have train our data, but it is important to note
that it has some limitations. Indeed, it assumes that historical
patterns will repeat exactly in the future, which may not always hold.
The S-Naive method may not account for underlying factors or trends that
could impact future outcomes. Therefore, there is an increased risk of
inaccurate forecasts if the method is blindly applied without
considering other relevant factors. ETS could be great models based on a
trade off between forecasting error and complexity of the model. ETS
model has the third lowest RMSE and second lowest MAE which makes him a
good candidate. In order to select a model, we can analyse residuals of
those models</p>
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.model
</th>
<th style="text-align:left;">
.type
</th>
<th style="text-align:right;">
ME
</th>
<th style="text-align:right;">
RMSE
</th>
<th style="text-align:right;">
MAE
</th>
<th style="text-align:right;">
MPE
</th>
<th style="text-align:right;">
MAPE
</th>
<th style="text-align:right;">
MASE
</th>
<th style="text-align:right;">
RMSSE
</th>
<th style="text-align:right;">
ACF1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ARIMA(Lichtenstein)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
0.4560409
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 1) !important;">
0.7600371
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 1) !important;">
0.5055350
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.3101830
</td>
</tr>
<tr>
<td style="text-align:left;">
ETS(Lichtenstein)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
0.0076093
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 10, 93, 1) !important;">
0.6384691
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 109, 142, 1) !important;">
0.4181878
</td>
<td style="text-align:right;">
-Inf
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.3882763
</td>
</tr>
<tr>
<td style="text-align:left;">
SNAIVE(Lichtenstein)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
0.0878665
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;">
0.6333824
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;">
0.2931107
</td>
<td style="text-align:right;">
-Inf
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.4103591
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="co">#report(data_fit_Licht_e)</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a><span class="co">#report(data_fit_Licht_n)</span></span></code></pre></div>
</div>
<div id="residuals-4" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>It is interesting to examine any outliers or extreme values in the
residuals. The ACF analysis for SNaive shows Positive correlations
between the ts and its lags. In opposite ETS model shows that there’s no
correlation between thoses values. Thus, each observation in the ts can
be considered unrelated to the previous values. Consequently,
Lichtenstein ts might need covariate to forecast and analyse it
adequately. Concerning the residual, it should ideally appear random, in
our case residuals are chinked around zero for both models (SNaive &amp;
ETS), thus those might shows autocorrelation.</p>
<p><img src="main_files/figure-html/unnamed-chunk-47-1.png" width="768" /></p>
</div>
</div>
<div id="total-2" class="section level2 tabset">
<h2 class="tabset">4.6 Total</h2>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>Total_since_2015 <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date,Total) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>))</span></code></pre></div>
<div id="testing-models-5" class="section level3">
<h3><strong>Testing Models</strong></h3>
<p>Below is the plot of how well each model fits the data based on a
60-period prediction starting from 2016.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="co">#Split the data</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>training_tot <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Total) <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>test_tot <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span> <span class="fu">select</span>(Date, Total) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;2016-01-01&quot;</span>))</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a><span class="co"># Fit ARIMA model and generate forecasts</span></span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>data_fit_tot_a <span class="ot">&lt;-</span> training_tot <span class="sc">%&gt;%</span></span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Total))</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>forecasts_tot_a <span class="ot">&lt;-</span> data_fit_tot_a <span class="sc">%&gt;%</span></span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a><span class="co"># Fit ETS model and generate forecasts</span></span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>data_fit_tot_e <span class="ot">&lt;-</span> training_tot <span class="sc">%&gt;%</span></span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Total))</span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a>forecasts_tot_e <span class="ot">&lt;-</span> data_fit_tot_e <span class="sc">%&gt;%</span></span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb62-16"><a href="#cb62-16" tabindex="-1"></a></span>
<span id="cb62-17"><a href="#cb62-17" tabindex="-1"></a><span class="co"># Fit seasonal naive model and generate forecasts</span></span>
<span id="cb62-18"><a href="#cb62-18" tabindex="-1"></a>data_fit_tot_n <span class="ot">&lt;-</span> training_tot <span class="sc">%&gt;%</span></span>
<span id="cb62-19"><a href="#cb62-19" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">SNAIVE</span>(Total))</span>
<span id="cb62-20"><a href="#cb62-20" tabindex="-1"></a>forecasts_tot_n <span class="ot">&lt;-</span> data_fit_tot_n <span class="sc">%&gt;%</span></span>
<span id="cb62-21"><a href="#cb62-21" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">60</span>)</span>
<span id="cb62-22"><a href="#cb62-22" tabindex="-1"></a></span>
<span id="cb62-23"><a href="#cb62-23" tabindex="-1"></a><span class="co"># Combine forecasts into a single data frame</span></span>
<span id="cb62-24"><a href="#cb62-24" tabindex="-1"></a>all_forecasts_tot <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb62-25"><a href="#cb62-25" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_tot_a<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ARIMA&quot;</span>, <span class="at">Forecast =</span> forecasts_tot_a<span class="sc">$</span>.mean),</span>
<span id="cb62-26"><a href="#cb62-26" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_tot_e<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;ETS&quot;</span>, <span class="at">Forecast =</span> forecasts_tot_e<span class="sc">$</span>.mean),</span>
<span id="cb62-27"><a href="#cb62-27" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Date =</span> forecasts_tot_n<span class="sc">$</span>Date, <span class="at">Method =</span> <span class="st">&quot;SNAIVE&quot;</span>, <span class="at">Forecast =</span> forecasts_tot_n<span class="sc">$</span>.mean))</span>
<span id="cb62-28"><a href="#cb62-28" tabindex="-1"></a></span>
<span id="cb62-29"><a href="#cb62-29" tabindex="-1"></a></span>
<span id="cb62-30"><a href="#cb62-30" tabindex="-1"></a><span class="co"># Plot all three sets of forecasts together</span></span>
<span id="cb62-31"><a href="#cb62-31" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Total) <span class="sc">+</span></span>
<span id="cb62-32"><a href="#cb62-32" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> all_forecasts_tot, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Forecast, <span class="at">color =</span> Method)) <span class="sc">+</span></span>
<span id="cb62-33"><a href="#cb62-33" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Electricity Demand to all countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-49-1.png" width="768" /></p>
</div>
<div id="measuring-model-accuracy-5" class="section level3">
<h3><strong>Measuring Model Accuracy</strong></h3>
<p>According to the accuracy table below, RMSE, MAE, as well as AIC,
AICc, and BIC, ARIMA has the lowest values on the test data than the ETS
model.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="co">#Accuracy</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>total_accuracy_a <span class="ot">&lt;-</span><span class="fu">accuracy</span>(forecasts_tot_a, test_tot)</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>total_accuracy_e <span class="ot">&lt;-</span><span class="fu">accuracy</span>(forecasts_tot_e, test_tot)</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>total_accuracy_n <span class="ot">&lt;-</span><span class="fu">accuracy</span>(forecasts_tot_n, test_tot)</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>total_accuracy_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>  <span class="fu">data.frame</span>(total_accuracy_a),</span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>  <span class="fu">data.frame</span>(total_accuracy_e),</span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>  <span class="fu">data.frame</span>(total_accuracy_n))</span></code></pre></div>
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
.model
</th>
<th style="text-align:left;">
.type
</th>
<th style="text-align:right;">
ME
</th>
<th style="text-align:right;">
RMSE
</th>
<th style="text-align:right;">
MAE
</th>
<th style="text-align:right;">
MPE
</th>
<th style="text-align:right;">
MAPE
</th>
<th style="text-align:right;">
MASE
</th>
<th style="text-align:right;">
RMSSE
</th>
<th style="text-align:right;">
ACF1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ARIMA(Total)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
-152.5501
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;">
469.2775
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;">
322.1278
</td>
<td style="text-align:right;">
-8.530677
</td>
<td style="text-align:right;">
13.59182
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.5885794
</td>
</tr>
<tr>
<td style="text-align:left;">
ETS(Total)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
-416.7913
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 1) !important;">
578.6994
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 1) !important;">
472.6052
</td>
<td style="text-align:right;">
-18.311113
</td>
<td style="text-align:right;">
19.85636
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.5109384
</td>
</tr>
<tr>
<td style="text-align:left;">
SNAIVE(Total)
</td>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
-221.6833
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 149, 139, 1) !important;">
564.7462
</td>
<td style="text-align:right;color: white !important;background-color: rgba(44, 113, 142, 1) !important;">
416.0833
</td>
<td style="text-align:right;">
-10.958780
</td>
<td style="text-align:right;">
17.23146
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.5163818
</td>
</tr>
</tbody>
</table>
<pre><code>## Series: Total 
## Model: ARIMA(1,0,1)(2,0,0)[12] w/ mean 
## 
## Coefficients:
##          ar1      ma1    sar1    sar2  constant
##       0.7159  -0.2076  0.3750  0.3755  195.5746
## s.e.  0.0912   0.1344  0.0685  0.0708   11.2588
## 
## sigma^2 estimated as 63131:  log likelihood=-1335.72
## AIC=2683.45   AICc=2683.9   BIC=2702.99</code></pre>
<pre><code>## Series: Total 
## Model: ETS(A,N,A) 
##   Smoothing parameters:
##     alpha = 0.5690082 
##     gamma = 0.0002217215 
## 
##   Initial states:
##      l[0]     s[0]     s[-1]    s[-2]     s[-3]     s[-4]    s[-5]    s[-6]
##  2735.222 -30.5261 -39.40677 146.1547 -77.94267 -290.9088 509.1663 81.12738
##     s[-7]     s[-8]     s[-9]   s[-10]    s[-11]
##  83.81698 -205.6554 -47.17994 -126.659 -1.986777
## 
##   sigma^2:  60986.36
## 
##      AIC     AICc      BIC 
## 3140.436 3143.164 3189.299</code></pre>
</div>
<div id="residuals-5" class="section level3">
<h3><strong>Residuals</strong></h3>
<p>The output below also suggests that the ARIMA model did well in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_tot_a) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Total residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-53-1.png" width="768" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_tot_e) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Total residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-53-2.png" width="768" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">gg_tsresiduals</span>(data_fit_tot_n) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNAIVE Total residuals analysis&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (`geom_point()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite values (`stat_bin()`).</code></pre>
<p><img src="main_files/figure-html/unnamed-chunk-53-3.png" width="768" /></p>
</div>
</div>
<div id="result" class="section level2">
<h2>Result</h2>
<p>All of these metrics are important for evaluating forecast accuracy.
Still, our goal is to obtain the most accurate forecast. Therefore, we
give more weight to RMSE and MAE metrics than AIC. As a result, the
ARIMA model is selected to forecast the electricity demand in Italy and
the Total, and ETS model is selected to forecast in Germany, Austria and
France. Finally, S-Naive is selected to forecast in Lichtenstein.</p>
</div>
</div>
<div id="forecast" class="section level1">
<h1>5. Forecast</h1>
<p>For each of our country forecasts, we have decided to use the model
with the lowest RMSE as shown in the previous section. This is because
we want our models to be as “accurate” as possible, in away that
minimizes the error/distance between our forecast values and the actual
values.</p>
<p>Below, for each country, you can see a residual analysis for every
selected model, a graph of the forecast, and finally the forecast table.
The outcome of the residual analysis is to confirm that the model has
done a good job fitting the data, and more specifically, here’s what we
obtained from it:</p>
<p>A good model fit has the following characteristics in terms of its
residuals:</p>
<ul>
<li>The residuals are distributed symmetrically, in a shape that
resembles a Normal distribution.</li>
<li>Low ACF (autocorrelation) in the first few lags.</li>
<li>No Heteroskedasticity: the variance of the residuals is
constant.</li>
<li>There is no trend in the residuals.</li>
</ul>
<p>In essence, what this all means, is that the residuals are white
noise. Let’s now look at the results for each country, and make some
more specific comments:</p>
<div id="germany-3" class="section level2 tabset">
<h2 class="tabset">5.1 Germany</h2>
<p>We fit Germany electricity demand data using the ETS model.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># Modelling ARIMA automatically</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>ets_germany <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>  <span class="fu">select</span>(Germany) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">ets =</span> <span class="fu">ETS</span>(Germany))</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>forecast_ets_germany <span class="ot">&lt;-</span> ets_germany <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">hilo</span>(<span class="dv">90</span>)</span></code></pre></div>
<div id="checking-residuals" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<p>The output below suggests that the ETS model did a decent job in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<p>However, it seems like this model for Germany is not fitting well.
More specifically, we see that there is more variation in the
distribution of the residuals of Germany’s model. Nevertheless, the
distribution of the errors is symmetric, which is good. Furthermore, we
notice the peaks in some of the lagged periods of the ACF graph,
indicating the presence of autocorrelation between the time periods and
the previous time periods, which is not great in terms of how well the
model fits the data.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>ets_germany <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Germany residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-55-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<p>For better visualization, we plot our forecast results starting from
2015.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>ets_germany <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Germany_since_2015) <span class="sc">+</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Forecast for Germany&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-56-1.png" width="768" /></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>forecast_table_germany_e <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ETS&quot;</span>),</span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>                              <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_ets_germany))</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>forecast_table_germany_e <span class="ot">&lt;-</span> forecast_table_germany_e <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values.Date,Forecast_Values..mean, Forecast_Values.<span class="fl">90.</span>) </span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>forecast_table_germany_e<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="st">&quot;Germany&quot;</span></span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_germany_e)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span></span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_germany_e)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PF&quot;</span></span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_germany_e)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CI&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<p>The resulting forecast table for Germany is shown below.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="co">#forecast_table_germany_e</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="fu">kbl</span>(forecast_table_germany_e) <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">fixed_thead =</span> T)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Month
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
PF
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
CI
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Country
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2022 Dec
</td>
<td style="text-align:right;">
157.1304
</td>
<td style="text-align:left;">
[69.352709, 244.9081]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jan
</td>
<td style="text-align:right;">
134.0659
</td>
<td style="text-align:left;">
[38.462369, 229.6695]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Feb
</td>
<td style="text-align:right;">
104.7389
</td>
<td style="text-align:left;">
[15.969441, 193.5083]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Mar
</td>
<td style="text-align:right;">
133.3176
</td>
<td style="text-align:left;">
[3.902624, 262.7325]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Apr
</td>
<td style="text-align:right;">
272.8334
</td>
<td style="text-align:left;">
[-23.725170, 569.3920]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 May
</td>
<td style="text-align:right;">
489.8151
</td>
<td style="text-align:left;">
[-97.314650, 1076.9448]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jun
</td>
<td style="text-align:right;">
429.4505
</td>
<td style="text-align:left;">
[-132.035138, 990.9361]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jul
</td>
<td style="text-align:right;">
429.2634
</td>
<td style="text-align:left;">
[-177.873964, 1036.4007]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Aug
</td>
<td style="text-align:right;">
398.2749
</td>
<td style="text-align:left;">
[-207.194123, 1003.7439]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Sep
</td>
<td style="text-align:right;">
282.1175
</td>
<td style="text-align:left;">
[-176.503436, 740.7385]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Oct
</td>
<td style="text-align:right;">
218.3380
</td>
<td style="text-align:left;">
[-159.623254, 596.2992]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Nov
</td>
<td style="text-align:right;">
176.7443
</td>
<td style="text-align:left;">
[-147.928838, 501.4175]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Dec
</td>
<td style="text-align:right;">
156.4080
</td>
<td style="text-align:left;">
[-147.602206, 460.4183]90
</td>
<td style="text-align:left;">
Germany
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="italy-3" class="section level2 tabset">
<h2 class="tabset">5.2 Italy</h2>
<p>We fit Italy electricity demand data using the ARIMA model.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="co"># Modelling ETS automatically</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>arima_italy <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>  <span class="fu">select</span>(Italy) <span class="sc">%&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Italy))</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>forecast_arima_italy <span class="ot">&lt;-</span> arima_italy <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">hilo</span>(<span class="dv">90</span>)</span></code></pre></div>
<div id="checking-residuals-1" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<p>The output below suggests that the ARIMA model did well in capturing
all the dynamics in data, as the residuals seem to be white noise.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>arima_italy <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Italy residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-59-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-1" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<p>For better visualization, we plot our forecast results starting from
2018.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>arima_italy <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Italy_since_2018) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Forecast for Italy&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-60-1.png" width="768" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>forecast_table_italy_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ARIMA&quot;</span>),</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>                          <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_arima_italy))</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>forecast_table_italy_a <span class="ot">&lt;-</span> forecast_table_italy_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values.Date,Forecast_Values..mean, Forecast_Values.<span class="fl">90.</span>)</span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>forecast_table_italy_a<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="st">&quot;Italy&quot;</span></span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_italy_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span></span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_italy_a)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PF&quot;</span></span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_italy_a)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CI&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-1" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<p>The resulting forecast table for Italy is shown below.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="co">#forecast_table_italy_a</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a><span class="fu">kbl</span>(forecast_table_italy_a) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">fixed_thead =</span> T)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Month
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
PF
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
CI
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Country
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2022 Dec
</td>
<td style="text-align:right;">
1826.559
</td>
<td style="text-align:left;">
[1289.9394, 2363.178]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jan
</td>
<td style="text-align:right;">
1830.641
</td>
<td style="text-align:left;">
[1164.2666, 2497.015]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Feb
</td>
<td style="text-align:right;">
2084.348
</td>
<td style="text-align:left;">
[1309.6550, 2859.040]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Mar
</td>
<td style="text-align:right;">
2064.941
</td>
<td style="text-align:left;">
[1195.3191, 2934.564]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Apr
</td>
<td style="text-align:right;">
1763.042
</td>
<td style="text-align:left;">
[807.8790, 2718.206]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 May
</td>
<td style="text-align:right;">
1826.055
</td>
<td style="text-align:left;">
[792.4052, 2859.704]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jun
</td>
<td style="text-align:right;">
1930.824
</td>
<td style="text-align:left;">
[824.2409, 3037.406]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jul
</td>
<td style="text-align:right;">
2272.030
</td>
<td style="text-align:left;">
[1097.0320, 3447.028]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Aug
</td>
<td style="text-align:right;">
1978.937
</td>
<td style="text-align:left;">
[739.2947, 3218.580]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Sep
</td>
<td style="text-align:right;">
1936.262
</td>
<td style="text-align:left;">
[635.1825, 3237.342]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Oct
</td>
<td style="text-align:right;">
1939.172
</td>
<td style="text-align:left;">
[579.4288, 3298.916]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Nov
</td>
<td style="text-align:right;">
1906.992
</td>
<td style="text-align:left;">
[491.0130, 3322.971]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Dec
</td>
<td style="text-align:right;">
1816.285
</td>
<td style="text-align:left;">
[288.3433, 3344.226]90
</td>
<td style="text-align:left;">
Italy
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="austria-3" class="section level2 tabset">
<h2 class="tabset">5.3 Austria</h2>
<p>We fit Austria electricity demand data using the ETS model.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="co"># Modelling ETS automatically</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>ets_austria <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>  <span class="fu">select</span>(Austria) <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Austria))</span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a>forecast_ets_austria <span class="ot">&lt;-</span> ets_austria <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">hilo</span>(<span class="dv">90</span>)</span></code></pre></div>
<div id="checking-residuals-2" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<p>The output below suggests that the ETS model did well in capturing
all the dynamics in data, as the residuals seem to be white noise.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>ets_austria <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Austria residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-63-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-2" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<p>For better visualization, we plot our forecast results starting from
2018.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>ets_austria <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Austria_since_2018) <span class="sc">+</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Forecast for Austria&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-64-1.png" width="768" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>forecast_table_austria_e <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ETS&quot;</span>),</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>                          <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_ets_austria))</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a>forecast_table_austria_e <span class="ot">&lt;-</span> forecast_table_austria_e <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values.Date,Forecast_Values..mean, Forecast_Values.<span class="fl">90.</span>)</span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a>forecast_table_austria_e<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="st">&quot;Austria&quot;</span></span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_austria_e)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span></span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_austria_e)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PF&quot;</span></span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_austria_e)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CI&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-2" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<p>The resulting forecast table for Austria is shown below.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co">#forecast_table_austria_e</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a><span class="fu">kbl</span>(forecast_table_austria_e) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">fixed_thead =</span> T)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Month
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
PF
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
CI
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Country
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2022 Dec
</td>
<td style="text-align:right;">
109.2886
</td>
<td style="text-align:left;">
[45.7111685, 172.8659]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jan
</td>
<td style="text-align:right;">
106.3760
</td>
<td style="text-align:left;">
[36.6047883, 176.1473]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Feb
</td>
<td style="text-align:right;">
102.6006
</td>
<td style="text-align:left;">
[27.1422181, 178.0590]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Mar
</td>
<td style="text-align:right;">
102.4725
</td>
<td style="text-align:left;">
[21.7264929, 183.2184]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Apr
</td>
<td style="text-align:right;">
111.9032
</td>
<td style="text-align:left;">
[26.1952715, 197.6112]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 May
</td>
<td style="text-align:right;">
122.5810
</td>
<td style="text-align:left;">
[32.1830104, 212.9790]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jun
</td>
<td style="text-align:right;">
125.5234
</td>
<td style="text-align:left;">
[30.6669550, 220.3798]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jul
</td>
<td style="text-align:right;">
148.0999
</td>
<td style="text-align:left;">
[48.9853517, 247.2144]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Aug
</td>
<td style="text-align:right;">
147.6801
</td>
<td style="text-align:left;">
[44.4830307, 250.8771]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Sep
</td>
<td style="text-align:right;">
112.2665
</td>
<td style="text-align:left;">
[5.1423886, 219.3906]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Oct
</td>
<td style="text-align:right;">
111.3402
</td>
<td style="text-align:left;">
[0.4280154, 222.2524]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Nov
</td>
<td style="text-align:right;">
107.7202
</td>
<td style="text-align:left;">
[-6.8564988, 222.2970]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Dec
</td>
<td style="text-align:right;">
109.2886
</td>
<td style="text-align:left;">
[-8.8375275, 227.4146]90
</td>
<td style="text-align:left;">
Austria
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="france-3" class="section level2 tabset">
<h2 class="tabset">5.4 France</h2>
<p>We fit France electricity demand data using the ETS model.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="co"># Modelling ETS automatically</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>ets_france <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>  <span class="fu">select</span>(France) <span class="sc">%&gt;%</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(France))</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a>forecast_ets_france <span class="ot">&lt;-</span> ets_france <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">hilo</span>(<span class="dv">90</span>)</span></code></pre></div>
<div id="checking-residuals-3" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<p>The output below suggests that the ETS model did a decent job in
capturing all the dynamics in data, as the residuals seem to be white
noise.</p>
<p>However, it seems like this model for France is not fitting as well
as the other models for the previous countries. More specifically, we
see that there is more variation in the distribution of the residuals of
France’s model compared to other countries. Nevertheless, the
distribution of the errors is symmetric, which is good. Furthermore, we
notice a peak in the first lagged period of the ACF graph, indicating
the presence of autocorrelation between a time period and the previous
time period, which is not great in terms of how well the model fits the
data.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a>ets_france <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS France residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-67-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-3" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<p>For better visualization, we plot our forecast results starting from
2015.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>ets_france <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(France_since_2015) <span class="sc">+</span></span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ETS Forecast for France&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-68-1.png" width="768" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>forecast_table_france_e <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ETS&quot;</span>),</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>                          <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_ets_france))</span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a>forecast_table_france_e <span class="ot">&lt;-</span> forecast_table_france_e <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values.Date,Forecast_Values..mean, Forecast_Values.<span class="fl">90.</span>)</span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a>forecast_table_france_e<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="st">&quot;France&quot;</span></span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a></span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_france_e)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span></span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_france_e)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PF&quot;</span></span>
<span id="cb90-10"><a href="#cb90-10" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_france_e)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CI&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-3" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<p>The resulting forecast table for France is shown below.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="co">#forecast_table_france_e</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a><span class="fu">kbl</span>(forecast_table_france_e) <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">fixed_thead =</span> T)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Month
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
PF
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
CI
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Country
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2022 Dec
</td>
<td style="text-align:right;">
452.6419
</td>
<td style="text-align:left;">
[86.27746, 819.0064]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jan
</td>
<td style="text-align:right;">
426.1098
</td>
<td style="text-align:left;">
[77.66769, 774.5518]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Feb
</td>
<td style="text-align:right;">
356.1703
</td>
<td style="text-align:left;">
[61.96845, 650.3721]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Mar
</td>
<td style="text-align:right;">
268.4822
</td>
<td style="text-align:left;">
[44.50058, 492.4638]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Apr
</td>
<td style="text-align:right;">
232.8623
</td>
<td style="text-align:left;">
[36.68973, 429.0349]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 May
</td>
<td style="text-align:right;">
216.6737
</td>
<td style="text-align:left;">
[32.37475, 400.9727]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jun
</td>
<td style="text-align:right;">
336.6541
</td>
<td style="text-align:left;">
[47.57567, 625.7324]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jul
</td>
<td style="text-align:right;">
454.1439
</td>
<td style="text-align:left;">
[60.52136, 847.7665]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Aug
</td>
<td style="text-align:right;">
411.5258
</td>
<td style="text-align:left;">
[51.54458, 771.5071]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Sep
</td>
<td style="text-align:right;">
389.8002
</td>
<td style="text-align:left;">
[45.71607, 733.8843]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Oct
</td>
<td style="text-align:right;">
351.4656
</td>
<td style="text-align:left;">
[38.43236, 664.4988]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Nov
</td>
<td style="text-align:right;">
371.7370
</td>
<td style="text-align:left;">
[37.71470, 705.7594]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Dec
</td>
<td style="text-align:right;">
452.6433
</td>
<td style="text-align:left;">
[42.36154, 862.9251]90
</td>
<td style="text-align:left;">
France
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="lichtenstein-3" class="section level2 tabset">
<h2 class="tabset">5.5 Lichtenstein</h2>
<p>We fit Lichtenstein electricity demand data using the SNaive
model.</p>
<div id="checking-residuals-4" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<p>As expected the SNaive is a relatively simple model, it hardly
capture all the dynamics in data, since the residuals are not white
noise. Also, it is not surprising to observe correlation between ts and
lags, since it is inherent from a Naive models.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="co">#Checking the residuals before forecasting</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>n_Licht <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNaive Lichtenstein residuals analysis&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-71-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-4" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="co"># Graphing the forecast</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>n_Licht <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(lich_log_2010_2022) <span class="sc">+</span></span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SNaive Forecast for Lichtenstein&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-72-1.png" width="768" /></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>forecast_table_Lichtenstein_n <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;SNaive&quot;</span>),</span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a>                              <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_n_Licht))</span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a>forecast_table_Lichtenstein_n <span class="ot">&lt;-</span> forecast_table_Lichtenstein_n <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values.Date,Forecast_Values..mean, Forecast_Values.<span class="fl">90.</span>)</span>
<span id="cb94-6"><a href="#cb94-6" tabindex="-1"></a>forecast_table_Lichtenstein_n<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="st">&quot;Lichtenstein&quot;</span></span>
<span id="cb94-7"><a href="#cb94-7" tabindex="-1"></a></span>
<span id="cb94-8"><a href="#cb94-8" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_Lichtenstein_n)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span></span>
<span id="cb94-9"><a href="#cb94-9" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_Lichtenstein_n)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PF&quot;</span></span>
<span id="cb94-10"><a href="#cb94-10" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_Lichtenstein_n)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CI&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-4" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<p>The resulting forecast table for Lichtenstein is shown below.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co">#forecast_table_Lichtenstein_n</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a><span class="fu">kbl</span>(forecast_table_Lichtenstein_n) <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">fixed_thead =</span> T)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Month
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
PF
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
CI
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Country
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2022 Dec
</td>
<td style="text-align:right;">
2.079442
</td>
<td style="text-align:left;">
[0.7999965, 3.358887]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jan
</td>
<td style="text-align:right;">
1.945910
</td>
<td style="text-align:left;">
[0.6664651, 3.225355]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Feb
</td>
<td style="text-align:right;">
1.945910
</td>
<td style="text-align:left;">
[0.6664651, 3.225355]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Mar
</td>
<td style="text-align:right;">
1.386294
</td>
<td style="text-align:left;">
[0.1068493, 2.665739]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Apr
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:left;">
[-1.2794450, 1.279445]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 May
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:left;">
[-1.2794450, 1.279445]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jun
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:left;">
[-1.2794450, 1.279445]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jul
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:left;">
[-1.2794450, 1.279445]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Aug
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:left;">
[-1.2794450, 1.279445]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Sep
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:left;">
[-1.2794450, 1.279445]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Oct
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:left;">
[-1.2794450, 1.279445]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Nov
</td>
<td style="text-align:right;">
1.386294
</td>
<td style="text-align:left;">
[0.1068493, 2.665739]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Dec
</td>
<td style="text-align:right;">
2.079442
</td>
<td style="text-align:left;">
[0.2700330, 3.888850]90
</td>
<td style="text-align:left;">
Lichtenstein
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="total-3" class="section level2 tabset">
<h2 class="tabset">5.6 Total</h2>
<p>We fit Total electricity demand data using the ARIMA model.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="co"># Modelling ETS automatically</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>arima_total <span class="ot">&lt;-</span> data_elec <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>  <span class="fu">select</span>(Total) <span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Total))</span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a><span class="co"># Forecasting using the models</span></span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a>forecast_arima_total <span class="ot">&lt;-</span> arima_total <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">hilo</span>(<span class="dv">90</span>)</span></code></pre></div>
<div id="checking-residuals-5" class="section level3">
<h3><strong>Checking Residuals</strong></h3>
<p>The output below suggests that the ARIMA model did well in capturing
all the dynamics in data, as the residuals seem to be white noise.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>arima_total <span class="sc">%&gt;%</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">36</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA residuals analysis for all countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-75-1.png" width="768" /></p>
</div>
<div id="graphing-the-forecast-5" class="section level3">
<h3><strong>Graphing the forecast</strong></h3>
<p>For better visualization, we plot our forecast results starting from
2015.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>arima_total <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Total_since_2015) <span class="sc">+</span></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ARIMA Forecast for All Countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-76-1.png" width="768" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="co">#Extracting the forecasted values</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>forecast_table_total_a<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;ARIMA&quot;</span>),</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>                          <span class="at">Forecast_Values =</span> <span class="fu">c</span>(forecast_arima_total))</span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>forecast_table_total_a <span class="ot">&lt;-</span> forecast_table_total_a <span class="sc">%&gt;%</span> <span class="fu">select</span>(Forecast_Values.Date,Forecast_Values..mean, Forecast_Values.<span class="fl">90.</span>)</span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>forecast_table_total_a<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="st">&quot;Total&quot;</span></span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a></span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_total_a)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span></span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_total_a)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PF&quot;</span></span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a><span class="fu">colnames</span>(forecast_table_total_a)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CI&quot;</span></span></code></pre></div>
</div>
<div id="forecast-table-5" class="section level3">
<h3><strong>Forecast Table</strong></h3>
<p>The resulting forecast table for Total is shown below.</p>
<div class="sourceCode" id="cb100"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="co">#forecast_table_total_a</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a><span class="fu">kbl</span>(forecast_table_total_a) <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">fixed_thead =</span> T)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Month
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
PF
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
CI
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Country
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2022 Dec
</td>
<td style="text-align:right;">
2336.515
</td>
<td style="text-align:left;">
[1867.508, 2805.521]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jan
</td>
<td style="text-align:right;">
2507.818
</td>
<td style="text-align:left;">
[1979.592, 3036.043]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Feb
</td>
<td style="text-align:right;">
2489.217
</td>
<td style="text-align:left;">
[1932.451, 3045.983]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Mar
</td>
<td style="text-align:right;">
2580.353
</td>
<td style="text-align:left;">
[2009.191, 3151.514]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Apr
</td>
<td style="text-align:right;">
2302.442
</td>
<td style="text-align:left;">
[1723.875, 2881.008]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 May
</td>
<td style="text-align:right;">
2411.328
</td>
<td style="text-align:left;">
[1828.916, 2993.740]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jun
</td>
<td style="text-align:right;">
2591.927
</td>
<td style="text-align:left;">
[2007.509, 3176.345]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Jul
</td>
<td style="text-align:right;">
3070.838
</td>
<td style="text-align:left;">
[2485.371, 3656.306]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Aug
</td>
<td style="text-align:right;">
2798.490
</td>
<td style="text-align:left;">
[2212.473, 3384.507]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Sep
</td>
<td style="text-align:right;">
2469.884
</td>
<td style="text-align:left;">
[1883.579, 3056.189]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Oct
</td>
<td style="text-align:right;">
2412.024
</td>
<td style="text-align:left;">
[1825.569, 2998.480]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Nov
</td>
<td style="text-align:right;">
2300.391
</td>
<td style="text-align:left;">
[1713.856, 2886.926]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
<tr>
<td style="text-align:left;">
2023 Dec
</td>
<td style="text-align:right;">
2299.457
</td>
<td style="text-align:left;">
[1694.028, 2904.886]90
</td>
<td style="text-align:left;">
Total
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="combining-all-forecasts-into-one-table" class="section level2">
<h2>Combining all forecasts into one table:</h2>
<p>Below is the final table containing <code>Month,</code> point
forecast <code>PF,</code> 90% lower and upper confidence levels interval
forecast <code>CI,</code> and <code>Country.</code></p>
<div class="sourceCode" id="cb101"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>final_fc <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(forecast_table_germany_e, forecast_table_italy_a, forecast_table_france_e, forecast_table_austria_e,forecast_table_Lichtenstein_n, forecast_table_total_a)</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a><span class="co">#Rounding all values to 0 significant figures because at the moment they have 4 decimals each...</span></span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>final_fc<span class="sc">$</span>PF <span class="ot">&lt;-</span> <span class="fu">round</span>(final_fc<span class="sc">$</span>PF)</span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>final_fc<span class="sc">$</span>CI <span class="ot">&lt;-</span> <span class="fu">round</span>(final_fc<span class="sc">$</span>CI)</span>
<span id="cb101-6"><a href="#cb101-6" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" tabindex="-1"></a><span class="co">#Removing all non-negative values from the CI column and replacing them by 0 - With string manipulation bc i can&#39;t find another way</span></span>
<span id="cb101-8"><a href="#cb101-8" tabindex="-1"></a>final_fc<span class="sc">$</span>CI <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(final_fc<span class="sc">$</span>CI, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">[(-</span><span class="sc">\\</span><span class="st">d+),&quot;</span>, <span class="st">&quot;[0,&quot;</span>)</span>
<span id="cb101-9"><a href="#cb101-9" tabindex="-1"></a></span>
<span id="cb101-10"><a href="#cb101-10" tabindex="-1"></a></span>
<span id="cb101-11"><a href="#cb101-11" tabindex="-1"></a><span class="co"># creating lower and upper bound</span></span>
<span id="cb101-12"><a href="#cb101-12" tabindex="-1"></a>lower_str_fc <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">[(.*),.*</span><span class="sc">\\</span><span class="st">]90&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>, final_fc<span class="sc">$</span>CI)</span>
<span id="cb101-13"><a href="#cb101-13" tabindex="-1"></a>upper_str_fc <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">[.*, (.*)</span><span class="sc">\\</span><span class="st">]90&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>, final_fc<span class="sc">$</span>CI)</span>
<span id="cb101-14"><a href="#cb101-14" tabindex="-1"></a></span>
<span id="cb101-15"><a href="#cb101-15" tabindex="-1"></a><span class="co"># Converting to numeric values</span></span>
<span id="cb101-16"><a href="#cb101-16" tabindex="-1"></a>lower_bound <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(lower_str_fc)</span>
<span id="cb101-17"><a href="#cb101-17" tabindex="-1"></a>upper_bound <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(upper_str_fc)</span>
<span id="cb101-18"><a href="#cb101-18" tabindex="-1"></a></span>
<span id="cb101-19"><a href="#cb101-19" tabindex="-1"></a><span class="co"># Creating the data frame</span></span>
<span id="cb101-20"><a href="#cb101-20" tabindex="-1"></a>Correct_final_fc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Coutry&quot;</span> <span class="ot">=</span> final_fc<span class="sc">$</span>Country,</span>
<span id="cb101-21"><a href="#cb101-21" tabindex="-1"></a>                             <span class="st">&quot;Month&quot;</span> <span class="ot">=</span> final_fc<span class="sc">$</span>Month,</span>
<span id="cb101-22"><a href="#cb101-22" tabindex="-1"></a>                             <span class="st">&quot;Point Forecast&quot;</span> <span class="ot">=</span> final_fc<span class="sc">$</span>PF,</span>
<span id="cb101-23"><a href="#cb101-23" tabindex="-1"></a>                             <span class="st">&quot;Lower Interval&quot;</span> <span class="ot">=</span> lower_bound,</span>
<span id="cb101-24"><a href="#cb101-24" tabindex="-1"></a>                             <span class="st">&quot;Upper Interval&quot;</span> <span class="ot">=</span> upper_bound)</span>
<span id="cb101-25"><a href="#cb101-25" tabindex="-1"></a></span>
<span id="cb101-26"><a href="#cb101-26" tabindex="-1"></a><span class="co"># Printing the adjusted output</span></span>
<span id="cb101-27"><a href="#cb101-27" tabindex="-1"></a><span class="co">#print(Correct_final_fc)</span></span>
<span id="cb101-28"><a href="#cb101-28" tabindex="-1"></a></span>
<span id="cb101-29"><a href="#cb101-29" tabindex="-1"></a><span class="fu">kbl</span>(<span class="fu">cbind</span>(Correct_final_fc)) <span class="sc">%&gt;%</span></span>
<span id="cb101-30"><a href="#cb101-30" tabindex="-1"></a>  <span class="fu">kable_paper</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-31"><a href="#cb101-31" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>, <span class="at">height =</span> <span class="st">&quot;500px&quot;</span>)</span></code></pre></div>
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Coutry
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Month
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Point.Forecast
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Lower.Interval
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Upper.Interval
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2022 Dec
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
245
</td>
</tr>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2023 Jan
</td>
<td style="text-align:right;">
134
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
230
</td>
</tr>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2023 Feb
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
194
</td>
</tr>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2023 Mar
</td>
<td style="text-align:right;">
133
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
263
</td>
</tr>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2023 Apr
</td>
<td style="text-align:right;">
273
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
569
</td>
</tr>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2023 May
</td>
<td style="text-align:right;">
490
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1077
</td>
</tr>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2023 Jun
</td>
<td style="text-align:right;">
429
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
991
</td>
</tr>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2023 Jul
</td>
<td style="text-align:right;">
429
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1036
</td>
</tr>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2023 Aug
</td>
<td style="text-align:right;">
398
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1004
</td>
</tr>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2023 Sep
</td>
<td style="text-align:right;">
282
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
741
</td>
</tr>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2023 Oct
</td>
<td style="text-align:right;">
218
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
596
</td>
</tr>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2023 Nov
</td>
<td style="text-align:right;">
177
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
501
</td>
</tr>
<tr>
<td style="text-align:left;">
Germany
</td>
<td style="text-align:left;">
2023 Dec
</td>
<td style="text-align:right;">
156
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
460
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2022 Dec
</td>
<td style="text-align:right;">
1827
</td>
<td style="text-align:right;">
1290
</td>
<td style="text-align:right;">
2363
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2023 Jan
</td>
<td style="text-align:right;">
1831
</td>
<td style="text-align:right;">
1164
</td>
<td style="text-align:right;">
2497
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2023 Feb
</td>
<td style="text-align:right;">
2084
</td>
<td style="text-align:right;">
1310
</td>
<td style="text-align:right;">
2859
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2023 Mar
</td>
<td style="text-align:right;">
2065
</td>
<td style="text-align:right;">
1195
</td>
<td style="text-align:right;">
2935
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2023 Apr
</td>
<td style="text-align:right;">
1763
</td>
<td style="text-align:right;">
808
</td>
<td style="text-align:right;">
2718
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2023 May
</td>
<td style="text-align:right;">
1826
</td>
<td style="text-align:right;">
792
</td>
<td style="text-align:right;">
2860
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2023 Jun
</td>
<td style="text-align:right;">
1931
</td>
<td style="text-align:right;">
824
</td>
<td style="text-align:right;">
3037
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2023 Jul
</td>
<td style="text-align:right;">
2272
</td>
<td style="text-align:right;">
1097
</td>
<td style="text-align:right;">
3447
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2023 Aug
</td>
<td style="text-align:right;">
1979
</td>
<td style="text-align:right;">
739
</td>
<td style="text-align:right;">
3219
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2023 Sep
</td>
<td style="text-align:right;">
1936
</td>
<td style="text-align:right;">
635
</td>
<td style="text-align:right;">
3237
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2023 Oct
</td>
<td style="text-align:right;">
1939
</td>
<td style="text-align:right;">
579
</td>
<td style="text-align:right;">
3299
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2023 Nov
</td>
<td style="text-align:right;">
1907
</td>
<td style="text-align:right;">
491
</td>
<td style="text-align:right;">
3323
</td>
</tr>
<tr>
<td style="text-align:left;">
Italy
</td>
<td style="text-align:left;">
2023 Dec
</td>
<td style="text-align:right;">
1816
</td>
<td style="text-align:right;">
288
</td>
<td style="text-align:right;">
3344
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2022 Dec
</td>
<td style="text-align:right;">
453
</td>
<td style="text-align:right;">
86
</td>
<td style="text-align:right;">
819
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2023 Jan
</td>
<td style="text-align:right;">
426
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
775
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2023 Feb
</td>
<td style="text-align:right;">
356
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
650
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2023 Mar
</td>
<td style="text-align:right;">
268
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
492
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2023 Apr
</td>
<td style="text-align:right;">
233
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
429
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2023 May
</td>
<td style="text-align:right;">
217
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
401
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2023 Jun
</td>
<td style="text-align:right;">
337
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
626
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2023 Jul
</td>
<td style="text-align:right;">
454
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
848
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2023 Aug
</td>
<td style="text-align:right;">
412
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
772
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2023 Sep
</td>
<td style="text-align:right;">
390
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
734
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2023 Oct
</td>
<td style="text-align:right;">
351
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
664
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2023 Nov
</td>
<td style="text-align:right;">
372
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
706
</td>
</tr>
<tr>
<td style="text-align:left;">
France
</td>
<td style="text-align:left;">
2023 Dec
</td>
<td style="text-align:right;">
453
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
863
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2022 Dec
</td>
<td style="text-align:right;">
109
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
173
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2023 Jan
</td>
<td style="text-align:right;">
106
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
176
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2023 Feb
</td>
<td style="text-align:right;">
103
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
178
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2023 Mar
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
183
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2023 Apr
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
198
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2023 May
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
213
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2023 Jun
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
220
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2023 Jul
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
247
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2023 Aug
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
251
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2023 Sep
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
219
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2023 Oct
</td>
<td style="text-align:right;">
111
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
222
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2023 Nov
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
222
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:left;">
2023 Dec
</td>
<td style="text-align:right;">
109
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
227
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2022 Dec
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2023 Jan
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2023 Feb
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2023 Mar
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2023 Apr
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2023 May
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2023 Jun
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2023 Jul
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2023 Aug
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2023 Sep
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2023 Oct
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2023 Nov
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Lichtenstein
</td>
<td style="text-align:left;">
2023 Dec
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2022 Dec
</td>
<td style="text-align:right;">
2337
</td>
<td style="text-align:right;">
1868
</td>
<td style="text-align:right;">
2806
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2023 Jan
</td>
<td style="text-align:right;">
2508
</td>
<td style="text-align:right;">
1980
</td>
<td style="text-align:right;">
3036
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2023 Feb
</td>
<td style="text-align:right;">
2489
</td>
<td style="text-align:right;">
1932
</td>
<td style="text-align:right;">
3046
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2023 Mar
</td>
<td style="text-align:right;">
2580
</td>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;">
3152
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2023 Apr
</td>
<td style="text-align:right;">
2302
</td>
<td style="text-align:right;">
1724
</td>
<td style="text-align:right;">
2881
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2023 May
</td>
<td style="text-align:right;">
2411
</td>
<td style="text-align:right;">
1829
</td>
<td style="text-align:right;">
2994
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2023 Jun
</td>
<td style="text-align:right;">
2592
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
3176
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2023 Jul
</td>
<td style="text-align:right;">
3071
</td>
<td style="text-align:right;">
2485
</td>
<td style="text-align:right;">
3656
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2023 Aug
</td>
<td style="text-align:right;">
2798
</td>
<td style="text-align:right;">
2212
</td>
<td style="text-align:right;">
3385
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2023 Sep
</td>
<td style="text-align:right;">
2470
</td>
<td style="text-align:right;">
1884
</td>
<td style="text-align:right;">
3056
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2023 Oct
</td>
<td style="text-align:right;">
2412
</td>
<td style="text-align:right;">
1826
</td>
<td style="text-align:right;">
2998
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2023 Nov
</td>
<td style="text-align:right;">
2300
</td>
<td style="text-align:right;">
1714
</td>
<td style="text-align:right;">
2887
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
2023 Dec
</td>
<td style="text-align:right;">
2299
</td>
<td style="text-align:right;">
1694
</td>
<td style="text-align:right;">
2905
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb102"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="co">#str(Correct_final_fc)</span></span></code></pre></div>
</div>
</div>
<div id="challenges-and-further-analysis" class="section level1">
<h1>6. Challenges and Further Analysis</h1>
<p>In this section we will comment on things didn’t go so well in our
analysis, and things that could be improved.</p>
<p>Firstly, in the confidence bounds, some of Germany’s, Lichtenstein’s
and Austria’s lower bound values were negative at the 90% confidence
intervals, which you can actually see in the graphs of the forecasts for
each country. This was a problem because electricity exports can’t
physically be negative, and the lowest value they can take is zero. This
happened because when fitting the models, we didn’t specify that the
forecasts shouldn’t take negative values, and obviously the models can’t
know that themselves. To solve this issue, we decided to manually set
the lower bounds of these confidence intervals to 0 as it wouldn’t make
any sense for them to be negative, however we do have to mention that by
doing so, the confidence intervals we show are not 90% intervals.</p>
<p>Secondly, we decided not to add any covariates to our models, and
only use the historical data we were given. Covariates could potentially
help our forecasts be more accurate, as they can capture patterns and
the effects of external factors which have an impact on electricity
demand. An example of such a factor could be monthly average temperature
values, because temperature probably plays a big role in energy
consumption at the national level. Another example of a factor we could
have included in our analysis would be the average hours of sunlight,
because people tend to use more energy to light up their house in the
winter compared to the summer. Another factor could be the
implementation and use of different forms of energy, such as wind
energy/nuclear energy to supply power inside a country, rather than
simply importing it from Switzerland.</p>
</div>
<div id="appendix" class="section level1 tabset">
<h1 class="tabset">Appendix</h1>
<div id="appendix-1.-decomposition-comparison" class="section level2">
<h2><em>Appendix 1. Decomposition Comparison</em></h2>
<ul>
<li>Classical Decomposition assumes seasonal component repeats from year
to year, which usually is not the case in reality, over smoothes rapid
rises (is not recommended to use, but still…).</li>
<li>STL Decomposition is a versatile and robust method that handles any
seasonality; seasonal components can change, and smoothness can be
controlled.</li>
<li>X-11 method originated in the US Census Bureau and was further
developed by Statistics Canada, based on classical decomposition, a
slightly improved version of classical decomposition; the seasonal
component varies slowly over time, highly robust to outliers and level
shifts in the time series.</li>
</ul>
</div>
<div id="appendix-2.-accuracy-metrics-comparison"
class="section level2">
<h2><em>Appendix 2. Accuracy metrics comparison</em></h2>
<p><em>AIC</em> criteria are used to assess the goodness of fit of a
model, with lower values indicating a better fit. <em>RMSE</em> and MAE
are used to measure the difference between predicted values and actual
values. Comparatively lower numbers of these metrics assume a better
model’s forecast quality potential.</p>
</div>
<div id="appendix-3.-plots-of-all-countries-historical-data"
class="section level2">
<h2><em>Appendix 3. Plots of all countries’ historical data</em></h2>
<div id="germany-4" class="section level3">
<h3><strong>Germany</strong></h3>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Germany) <span class="sc">+</span> </span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Exports from Switzerland to Germany&quot;</span>) <span class="sc">+</span></span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-79-1.png" width="768" /></p>
</div>
<div id="france-4" class="section level3">
<h3><strong>France</strong></h3>
<div class="sourceCode" id="cb104"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(France) <span class="sc">+</span> </span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Exports from Switzerland to France&quot;</span>) <span class="sc">+</span></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-80-1.png" width="768" /></p>
</div>
<div id="italy-4" class="section level3">
<h3><strong>Italy</strong></h3>
<div class="sourceCode" id="cb105"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Italy) <span class="sc">+</span> </span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Exports from Switzerland to Italy&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-81-1.png" width="768" /></p>
</div>
<div id="austria-4" class="section level3">
<h3><strong>Austria</strong></h3>
<div class="sourceCode" id="cb106"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Austria) <span class="sc">+</span> </span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Exports from Switzerland to Austria&quot;</span>) <span class="sc">+</span></span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-82-1.png" width="768" /></p>
</div>
<div id="lichtenstein-4" class="section level3">
<h3><strong>Lichtenstein</strong></h3>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Lichtenstein) <span class="sc">+</span> </span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Exports from Switzerland to Lichtenstein&quot;</span>) <span class="sc">+</span></span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-83-1.png" width="768" /></p>
</div>
<div id="total-4" class="section level3">
<h3><strong>Total</strong></h3>
<div class="sourceCode" id="cb108"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>(Total) <span class="sc">+</span> </span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Exports from Switzerland to All countries&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-84-1.png" width="768" /></p>
</div>
</div>
<div id="appendix-4.-plots-of-seasonal-subseries"
class="section level2">
<h2><em>Appendix 4. Plots of Seasonal Subseries</em></h2>
<div id="germany-5" class="section level3">
<h3><strong>Germany</strong></h3>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(Germany) <span class="sc">+</span></span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to Germany&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-85-1.png" width="768" /></p>
</div>
<div id="france-5" class="section level3">
<h3><strong>France</strong></h3>
<div class="sourceCode" id="cb110"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(France) <span class="sc">+</span></span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to France&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-86-1.png" width="768" /></p>
</div>
<div id="italy-5" class="section level3">
<h3><strong>Italy</strong></h3>
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(Italy) <span class="sc">+</span></span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to Italy&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-87-1.png" width="768" /></p>
</div>
<div id="austria-5" class="section level3">
<h3><strong>Austria</strong></h3>
<div class="sourceCode" id="cb112"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(Austria) <span class="sc">+</span></span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to Austria&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-88-1.png" width="768" /></p>
</div>
<div id="lichtenstein-5" class="section level3">
<h3><strong>Lichtenstein</strong></h3>
<div class="sourceCode" id="cb113"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(Lichtenstein) <span class="sc">+</span></span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to Lichtenstein&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-89-1.png" width="768" /></p>
</div>
<div id="total-5" class="section level3">
<h3><strong>Total</strong></h3>
<div class="sourceCode" id="cb114"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a>data_elec <span class="sc">%&gt;%</span> <span class="fu">gg_subseries</span>(Total) <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;GWt&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span></span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Seasonal subseries plot: Swiss electricity exported to All countries&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-90-1.png" width="768" /></p>
</div>
</div>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
