## France

- Looks like piecewise should be used again around 2010 and 2016 because there's a bit downward trend since 2016
Visualizing France

```{r}
data_elec %>% autoplot(France) + 
  ggtitle("Exports from Switzerland to France") +
  ylab("GWt") + xlab("Month")
```

Looks like piecewise should be used again around 2010

#Investigating Total closely since 2015
```{r}
France_since_2015 <- data_elec %>% select(Date,France) %>% filter(Date >= as.Date("2015-01-01"))
autoplot(France_since_2015)
```

### S-Naive Model

```{r}
# Modelling SNaive automatically
snaive_france <- data_elec %>%
  select(France) %>%
  model(snaive = SNAIVE(France, h = 13))

# Getting the accuracy scores for models
report(snaive_france)

# Forecasting using the model
forecast_snaive_france <- snaive_france %>% forecast(h = 13)

# Graphing the forecast
snaive_france %>% forecast(h = 13) %>% autoplot(France_since_2015) +
  labs(title = "Seasonal Naive Forecast for France")

# Extracting the forecasted values
forecast_table_france <- data.frame(Model = c("SNaive"),
                                    Forecast_Values = c(forecast_snaive_france))

forecast_table_france <- forecast_table_france %>% select(Forecast_Values..mean)

colnames(forecast_table_france)[1] <- "France_snaive"

forecast_table_france


```







### ETS Model 



```{r}

#Modelling ets automatically
ets_france <- data_elec %>%
  select(France) %>%
  model(ETS(France))

#Getting the Accuracy scores for models
report(ets_france)

#Forecasting using the models
forecast_ets_france<- ets_france %>% forecast(h = 13)

#Graphing the forecast
ets_france %>% forecast(h = 13) %>% autoplot(France_since_2015)+
  labs(title = "ETS MNM Forecast for France")

#Extracting the forecasted values
forecast_table_france_ets <- data.frame(Model = c("ETS (MNM)"),
                              Forecast_Values = c(forecast_ets_france))

forecast_table_france_ets <- forecast_table_france_ets %>% select(Forecast_Values..mean)

colnames(forecast_table_france_ets)[1] <- "France_ets_MNM"

forecast_table_france_ets

#components(ets_france) %>% autoplot()
```

Looks like it expects a jump upwards on the following month. Might be a bit wrong, let's compare with other models.




### ARIMA

```{r}
# Modelling ARIMA automatically
arima_france <- data_elec %>%
  select(France) %>%
  model(arima = ARIMA(France))

# Getting the Accuracy scores for models
report(arima_france)

# Forecasting using the models
forecast_arima_france <- arima_france %>% forecast(h = 13)

# Graphing the forecast
arima_france %>% forecast(h = 13) %>% autoplot(France_since_2015) +
  labs(title = "ARIMA Forecast for France")

#Extracting the forecasted values
forecast_table_france_a <- data.frame(Model = c("ARIMA"),
                              Forecast_Values = c(forecast_arima_france))

forecast_table_france_a <- forecast_table_france_a %>% select(Forecast_Values..mean)

colnames(forecast_table_france_a)[1] <- "France_arima"

forecast_table_france_a
```

### S-ARIMA

```{r}
# Modelling SARIMA automatically
sarima_france <- data_elec %>%
  select(Date, France) %>%
  as.data.frame() %>%
  { auto.arima(ts(.$France, frequency = 12), seasonal = TRUE) }

# Forecasting using the models
forecast_sarima_france <- forecast(sarima_france, h = 13)


# Graphing the forecast
autoplot(forecast_sarima_france, include = 50) +
  labs(title = "SARIMA Forecast for France") +
  xlab("Year") + ylab("Electricity Consumption") 
  

# Extracting the forecasted values
forecast_table_france_sa <- data.frame(Model = c("SARIMA"),
                                     France_sarima = forecast_sarima_france$mean)


# Get the accuracy scores
accuracy_sarima_france <- accuracy(sarima_france)

forecast_table_france_sa
accuracy_sarima_france


```