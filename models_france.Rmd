## France

- Looks like piecewise should be used again around 2010 and 2016 because there's a bit downward trend since 2016
Visualizing France

```{r}
data_elec %>% autoplot(France) + 
  ggtitle("Exports from Switzerland to France") +
  ylab("GWt") + xlab("Month")
```

Looks like piecewise should be used again around 2010

#Investigating France closely since 2015
```{r}
France_since_2015 <- data_elec %>% select(Date,France) %>% filter(Date >= as.Date("2015-01-01"))
autoplot(France_since_2015)
```

### S-Naive Model

```{r}
# Modelling SNaive automatically
snaive_france <- data_elec %>%
  select(France) %>%
  model(snaive = SNAIVE(France, h = 13))

# Getting the accuracy scores for models
report(snaive_france)

# Forecasting using the model
forecast_snaive_france <- snaive_france %>% forecast(h = 13)

#Checking the residuals before forecasting
snaive_france %>% gg_tsresiduals(lag_max = 36) + labs(title = "ETS France residuals analysis")

# Graphing the forecast
snaive_france %>% forecast(h = 13) %>% autoplot(France_since_2015) +
  labs(title = "Seasonal Naive Forecast for France")

# Extracting the forecasted values
forecast_table_france <- data.frame(Model = c("SNaive"),
                                    Forecast_Values = c(forecast_snaive_france))

forecast_table_france <- forecast_table_france %>% select(Forecast_Values..mean)

colnames(forecast_table_france)[1] <- "France_snaive"

forecast_table_france


```



### ETS Model 



```{r}

#Modelling ets automatically
ets_france <- data_elec %>%
  select(France) %>%
  model(ETS(France))

#Getting the Accuracy scores for models
report(ets_france)

#Forecasting using the models
forecast_ets_france<- ets_france %>% forecast(h = 13)

#Checking the residuals before forecasting
ets_france %>% gg_tsresiduals(lag_max = 36) + labs(title = "ETS France residuals analysis")

#Graphing the forecast
ets_france %>% forecast(h = 13) %>% autoplot(France_since_2015)+
  labs(title = "ETS MNM Forecast for France")

#Extracting the forecasted values
forecast_table_france_ets <- data.frame(Model = c("ETS (MNM)"),
                              Forecast_Values = c(forecast_ets_france))

forecast_table_france_ets <- forecast_table_france_ets %>% select(Forecast_Values..mean)

colnames(forecast_table_france_ets)[1] <- "France_ets_MNM"

forecast_table_france_ets

#components(ets_france) %>% autoplot()
```

Looks like it expects a jump upwards on the following month. Might be a bit wrong, let's compare with other models.


### ARIMA


```{r}
# Modelling ARIMA automatically
arima_france <- data_elec %>%
  select(France) %>%
  model(arima = ARIMA(France))

# Getting the Accuracy scores for models
report(arima_france)


# Forecasting using the models
forecast_arima_france <- arima_france %>% forecast(h = 13)

#Checking the residuals before forecasting
arima_france %>% gg_tsresiduals(lag_max = 36) + labs(title = "SARIMA France residuals analysis")

# Graphing the forecast
arima_france %>% forecast(h = 13) %>% autoplot(France_since_2015) +
  labs(title = "ARIMA Forecast for France")

#Extracting the forecasted values
forecast_table_france_a <- data.frame(Model = c("ARIMA"),
                              Forecast_Values = c(forecast_arima_france))

forecast_table_france_a <- forecast_table_france_a %>% select(Forecast_Values..mean)

colnames(forecast_table_france_a)[1] <- "France_arima"

forecast_table_france_a



```
## Model Comparison
The ETS(M,N,M) model has an AIC of 4244.319, AICc of 4246.172, and BIC of 4298.570.
The ARIMA(2,1,1)(0,0,2)[12] model has an AIC of 3531.14, AICc of 3531.46, and BIC of 3552.82.The lower parameters are preferred, as they are a good trade-off between the complexity and goodness of fit. 

Based on the AIC, AICc, and BIC values, the ARIMA(2,1,1)(0,0,2)[12] model appears to be the better model, as it has lower values for all three criteria.

The time series residuals plot also shows that the ARIMA model best fits the data. The residuals don't follow any pattern and are random and stationary. Autocorrelation indicates that residuals in the ARIMA model are not correlated with their past and future values. We can't observe the same pattern in SNAIVE and ETS models. These models captured all the information in data not that well, as ARIMA did.
